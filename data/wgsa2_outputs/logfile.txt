[2023-10-24 17:18:18,732 - INFO] Nephele, developed by BCBB/OCICB/NIAID/NIH version: 2.29.2, tag: Nephele_2023_Oct_16, commit: 442d27c
[2023-10-24 17:18:18,732 - INFO] Python version: 3.7.3
[2023-10-24 17:18:18,732 - INFO] Current time: 2023-10-24 17:18
[2023-10-24 17:18:18,732 - INFO] Pipeline name: WGSA
[2023-10-24 17:18:18,810 - INFO] Job Description: WGSA2 - CAMI samples for training
[2023-10-24 17:18:18,810 - INFO] Job parameters
job_id: f924ba509da1
inputs_dir: None
outputs_dir: None
map_file: <_io.TextIOWrapper name='/nephele_data/inputs/wgsa_example_mapping_corrected.txt' mode='r' encoding='UTF-8'>
decontaminate: human_mouse
classification_db: plusPFV
amrfind: True
annotations_type: ko
tax_genes: True
tax_scaffolds: True
mag: True
trim_filter: False
average_read_quality: None
min_read_length: None
trim_of_5: None
trim_of_3: None
include_ted_files: False
data_type: WGSA_PE
stdout_redirect: file
stderr_redirect: file
[2023-10-24 17:18:18,845 - INFO] Results manager initialized. Results registry path: /mnt/EFS/user_uploads/f924ba509da1/outputs/f924ba509da1_results_registry.json
[2023-10-24 17:18:18,854 - INFO] Skipping FASTQ file validation
[2023-10-24 17:18:18,862 - INFO] Starting WGSA pipeline...
[2023-10-24 17:18:18,863 - INFO] Namespace(amrfind=True, annotations_type='ko', average_read_quality=None, classification_db='plusPFV', data_type='WGSA_PE', decontaminate='human_mouse', include_ted_files=False, inputs_dir=None, job_id='f924ba509da1', mag=True, map_file=<_io.TextIOWrapper name='/nephele_data/inputs/wgsa_example_mapping_corrected.txt' mode='r' encoding='UTF-8'>, min_read_length=None, outputs_dir=None, stderr_redirect='file', stdout_redirect='file', tax_genes=True, tax_scaffolds=True, trim_filter=False, trim_of_3=None, trim_of_5=None)
[2023-10-24 17:18:18,863 - INFO] snakemake -s /usr/local/src/nephele2/pipelines/wgsa/Snakefile -p --cores --keep-going --nocolor --resources mem_gb=186 --directory /nephele_data/tmp/ --config num_cpus=48 map_file=/nephele_data/inputs/wgsa_example_mapping_corrected.txt input_dir=/nephele_data/inputs/ output_dir=/nephele_data/outputs/ total_mem_gb=186 tmp_dir=/nephele_data/tmp/ trim_filter=False include_ted_files=False ted_file_name=TED.tar.gz biom_file_name=for_analyze_with_microbiomedb.biom decontaminate=/mnt/EFS/dbs/wgsa2/decontam_db/decontam_human+mouse_db classification_db=/mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 amrfind=True eggnog_db=/mnt/EFS/dbs/wgsa2/eggnog_data annotations_type=ko annotations_map=/mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-ko2map-092022.txt annotations_hrr=/mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-HRCHY-092022.txt tax_genes=True krona_tax_db=/mnt/EFS/dbs/wgsa2/KronaTools_taxonomy/ tax_scaffolds=True mag=True
Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 48
Rules claiming more threads will be scaled down.
Provided resources: mem_gb=186
Job counts:
	count	jobs
	1	PWY_collation
	1	PWY_collation_biom
	1	PWY_diversity_plots
	1	TAX_collation
	1	TAX_collation_biom
	1	TAX_diversity_plots
	3	add_de_replication_stats
	1	all
	3	bowtie2_build
	3	bowtie2_run
	3	checkm_coverage
	3	checkm_lineage_wf
	3	checkm_plots
	3	checkm_profile
	3	checkm_qa
	3	compress_kraken2_decontaminate
	3	copy_annotation_file
	1	cp_geneTPM_files
	3	create_pathways_report
	3	gene_annot_geneTPMs
	3	gene_annot_iTPMs
	3	gene_annot_seqExtract
	3	gene_annotation
	3	gene_annotation_grep
	3	gene_prediction
	3	generate_scafftax
	3	gff_to_gtf
	3	join_profiles_tax
	1	kreport2krona_import_text
	3	kreport2krona_per_sample
	1	krona_import_text
	1	kt_tax_html
	1	make_biom
	3	metabat2_run
	3	pwy_biom_per_sample
	3	rename_verse_summary
	3	run_amrfinder
	3	run_bbtools_stats
	3	run_fastp
	3	run_genes2krona
	3	run_kraken2_classification
	3	run_kraken2_decontaminate
	3	run_metaspades
	3	run_min_path
	3	run_verse
	3	samtools_to_bam
	3	scaffold_and_read_counts
	3	tax_biom_per_sample
	3	tax_classification_genes
	3	tax_classification_scaffolds
	3	tax_genes_4krona
	3	tax_genes_ABUNtabtax
	1	taxbin_krona_html
	3	taxbin_krona_txt
	3	tpm_normalization
	139

    set +o pipefail
    echo "Dependencies:"
    fastp --version
    python3 /usr/local/src/SPAdes/bin/metaspades.py --version
    bowtie2 --version | awk '{print "bowtie2 version", $3}' | head -n1
    samtools --version | head -n1
    metabat2 2>&1 >/dev/null | grep version
    prodigal -v 2>&1 >/dev/null | head -n2 | tail -n1
    checkm | head -n2 | tail -n1 | sed 's/^ *//g'
    ktImportText | head -n2 | tail -n1 | sed 's/[^a-zA-Z0-9. ]//g' | sed 's/^ *//g'
    metaprokka --version
    cat /usr/local/src/MinPath/MinPath.py | grep version | head -n1
    verse -v | head -n2 | tail -n1
    kraken2 --version | head -n1
    amrfinder --version | awk '{print "AMRFinder version", $1}'
    emapper.py --version | tail -n1 | awk '{print $1}'
    R --version | head -n1
    snakemake --version | awk '{print "Snakemake version", $1}'
    
Dependencies:
fastp 0.23.2
SPAdes genome assembler v3.15.2 [metaSPAdes mode]
bowtie2 version 2.4.2
samtools 1.13
MetaBAT: Metagenome Binning based on Abundance and Tetranucleotide frequency (version 2:v2.15-6-g8b5702b; 2022-01-10T22:14:13)
Prodigal V2.6.3: February, 2016
...::: CheckM v1.1.3 :::...
KronaTools 2.7.1  ktImportText 
metaprokka 1.14.6_1
# MinPath (current version: 1.5)
VERSE v0.1.5
Kraken version 2.1.2
AMRFinder version 3.10.18
emapper-2.1.6
R version 4.1.0 (2021-05-18) -- "Camp Pontanezen"
Snakemake version 6.1.2

[Tue Oct 24 17:18:39 2023]
rule run_fastp:
    input: /nephele_data/inputs/S6_Oral_camiHiSeq_sub1M_R1.fastq.gz, /nephele_data/inputs/S6_Oral_camiHiSeq_sub1M_R2.fastq.gz
    output: /nephele_data/outputs/TEDreads/S6_R1_te.fastq.gz, /nephele_data/outputs/TEDreads/S6_R2_te.fastq.gz, /nephele_data/outputs/TEDreads/S6_fastplog.html, /nephele_data/outputs/TEDreads/S6_fastp.json, /nephele_data/outputs/TEDreads/S6_fastplog.txt
    jobid: 11
    wildcards: sample=S6
    threads: 16

[Tue Oct 24 17:18:39 2023]
rule run_fastp:
    input: /nephele_data/inputs/S28_Skin_camiHiSeq_sub1M_R1.fastq.gz, /nephele_data/inputs/S28_Skin_camiHiSeq_sub1M_R2.fastq.gz
    output: /nephele_data/outputs/TEDreads/S28_R1_te.fastq.gz, /nephele_data/outputs/TEDreads/S28_R2_te.fastq.gz, /nephele_data/outputs/TEDreads/S28_fastplog.html, /nephele_data/outputs/TEDreads/S28_fastp.json, /nephele_data/outputs/TEDreads/S28_fastplog.txt
    jobid: 16
    wildcards: sample=S28
    threads: 16

[Tue Oct 24 17:18:39 2023]
rule run_fastp:
    input: /nephele_data/inputs/S1_GItract_camiHiSeq_sub1M_R1.fastq.gz, /nephele_data/inputs/S1_GItract_camiHiSeq_sub1M_R2.fastq.gz
    output: /nephele_data/outputs/TEDreads/S1_R1_te.fastq.gz, /nephele_data/outputs/TEDreads/S1_R2_te.fastq.gz, /nephele_data/outputs/TEDreads/S1_fastplog.html, /nephele_data/outputs/TEDreads/S1_fastp.json, /nephele_data/outputs/TEDreads/S1_fastplog.txt
    jobid: 6
    wildcards: sample=S1
    threads: 16

[33mJob counts:
	count	jobs
	1	run_fastp
	1[0m
[33mfastp -i /nephele_data/inputs/S6_Oral_camiHiSeq_sub1M_R1.fastq.gz -I /nephele_data/inputs/S6_Oral_camiHiSeq_sub1M_R2.fastq.gz -o /nephele_data/outputs/TEDreads/S6_R1_te.fastq.gz -O /nephele_data/outputs/TEDreads/S6_R2_te.fastq.gz -h /nephele_data/outputs/TEDreads/S6_fastplog.html -j /nephele_data/outputs/TEDreads/S6_fastp.json --trim_poly_x --cut_window_size 4 --thread 16 --low_complexity_filter --correction --average_qual 10 --length_required 60 --cut_front --cut_front_mean_quality 20 --cut_tail  --cut_tail_mean_quality 15 2>> /nephele_data/outputs/TEDreads/S6_fastplog.txt[0m
[33mJob counts:
	count	jobs
	1	run_fastp
	1[0m
[33mfastp -i /nephele_data/inputs/S1_GItract_camiHiSeq_sub1M_R1.fastq.gz -I /nephele_data/inputs/S1_GItract_camiHiSeq_sub1M_R2.fastq.gz -o /nephele_data/outputs/TEDreads/S1_R1_te.fastq.gz -O /nephele_data/outputs/TEDreads/S1_R2_te.fastq.gz -h /nephele_data/outputs/TEDreads/S1_fastplog.html -j /nephele_data/outputs/TEDreads/S1_fastp.json --trim_poly_x --cut_window_size 4 --thread 16 --low_complexity_filter --correction --average_qual 10 --length_required 60 --cut_front --cut_front_mean_quality 20 --cut_tail  --cut_tail_mean_quality 15 2>> /nephele_data/outputs/TEDreads/S1_fastplog.txt[0m
[33mJob counts:
	count	jobs
	1	run_fastp
	1[0m
[33mfastp -i /nephele_data/inputs/S28_Skin_camiHiSeq_sub1M_R1.fastq.gz -I /nephele_data/inputs/S28_Skin_camiHiSeq_sub1M_R2.fastq.gz -o /nephele_data/outputs/TEDreads/S28_R1_te.fastq.gz -O /nephele_data/outputs/TEDreads/S28_R2_te.fastq.gz -h /nephele_data/outputs/TEDreads/S28_fastplog.html -j /nephele_data/outputs/TEDreads/S28_fastp.json --trim_poly_x --cut_window_size 4 --thread 16 --low_complexity_filter --correction --average_qual 10 --length_required 60 --cut_front --cut_front_mean_quality 20 --cut_tail  --cut_tail_mean_quality 15 2>> /nephele_data/outputs/TEDreads/S28_fastplog.txt[0m
Removing temporary output file /nephele_data/outputs/TEDreads/S1_fastp.json.
[Tue Oct 24 17:18:47 2023]
Finished job 6.
1 of 139 steps (0.72%) done

[Tue Oct 24 17:18:47 2023]
rule run_kraken2_decontaminate:
    input: /nephele_data/outputs/TEDreads/S1_R1_te.fastq.gz, /nephele_data/outputs/TEDreads/S1_R2_te.fastq.gz
    output: /nephele_data/outputs/TEDreads/S1_R_1_ted.fastq, /nephele_data/outputs/TEDreads/S1_R_2_ted.fastq, /nephele_data/outputs/TEDreads/S1_kr2outLOG.txt, /nephele_data/outputs/TEDreads/S1_kr2_decontamREPORT.txt, /nephele_data/outputs/TEDreads/S1_kr2_decontamLOG.txt
    jobid: 5
    wildcards: sample=S1
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --gzip-compressed --threads 16 --confidence 0.05 --db /mnt/EFS/dbs/wgsa2/decontam_db/decontam_human+mouse_db --paired /nephele_data/outputs/TEDreads/S1_R1_te.fastq.gz /nephele_data/outputs/TEDreads/S1_R2_te.fastq.gz --unclassified-out /nephele_data/outputs/TEDreads/S1_R#_ted.fastq --output /nephele_data/outputs/TEDreads/S1_kr2outLOG.txt --report /nephele_data/outputs/TEDreads/S1_kr2_decontamREPORT.txt 2>> /nephele_data/outputs/TEDreads/S1_kr2_decontamLOG.txt
Removing temporary output file /nephele_data/outputs/TEDreads/S28_fastp.json.
[Tue Oct 24 17:18:47 2023]
Finished job 16.
2 of 139 steps (1%) done
Removing temporary output file /nephele_data/outputs/TEDreads/S6_fastp.json.
[Tue Oct 24 17:18:47 2023]
Finished job 11.
3 of 139 steps (2%) done
Removing temporary output file /nephele_data/outputs/TEDreads/S1_R2_te.fastq.gz.
Removing temporary output file /nephele_data/outputs/TEDreads/S1_R1_te.fastq.gz.
Removing temporary output file /nephele_data/outputs/TEDreads/S1_kr2outLOG.txt.
[Tue Oct 24 17:19:21 2023]
Finished job 5.
4 of 139 steps (3%) done

[Tue Oct 24 17:19:21 2023]
rule run_kraken2_decontaminate:
    input: /nephele_data/outputs/TEDreads/S28_R1_te.fastq.gz, /nephele_data/outputs/TEDreads/S28_R2_te.fastq.gz
    output: /nephele_data/outputs/TEDreads/S28_R_1_ted.fastq, /nephele_data/outputs/TEDreads/S28_R_2_ted.fastq, /nephele_data/outputs/TEDreads/S28_kr2outLOG.txt, /nephele_data/outputs/TEDreads/S28_kr2_decontamREPORT.txt, /nephele_data/outputs/TEDreads/S28_kr2_decontamLOG.txt
    jobid: 15
    wildcards: sample=S28
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --gzip-compressed --threads 16 --confidence 0.05 --db /mnt/EFS/dbs/wgsa2/decontam_db/decontam_human+mouse_db --paired /nephele_data/outputs/TEDreads/S28_R1_te.fastq.gz /nephele_data/outputs/TEDreads/S28_R2_te.fastq.gz --unclassified-out /nephele_data/outputs/TEDreads/S28_R#_ted.fastq --output /nephele_data/outputs/TEDreads/S28_kr2outLOG.txt --report /nephele_data/outputs/TEDreads/S28_kr2_decontamREPORT.txt 2>> /nephele_data/outputs/TEDreads/S28_kr2_decontamLOG.txt

[Tue Oct 24 17:19:21 2023]
rule compress_kraken2_decontaminate:
    input: /nephele_data/outputs/TEDreads/S1_R_1_ted.fastq, /nephele_data/outputs/TEDreads/S1_R_2_ted.fastq
    output: /nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz
    jobid: 4
    wildcards: sample=S1

pigz -c /nephele_data/outputs/TEDreads/S1_R_1_ted.fastq > /nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz &&pigz -c /nephele_data/outputs/TEDreads/S1_R_2_ted.fastq > /nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz
Removing temporary output file /nephele_data/outputs/TEDreads/S1_R_1_ted.fastq.
Removing temporary output file /nephele_data/outputs/TEDreads/S1_R_2_ted.fastq.
[Tue Oct 24 17:19:23 2023]
Finished job 4.
5 of 139 steps (4%) done

[Tue Oct 24 17:19:23 2023]
rule run_metaspades:
    input: /nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffolds.fasta
    jobid: 19
    wildcards: sample=S1
    threads: 16

python3 /usr/local/src/SPAdes/bin/metaspades.py -1 /nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz -2 /nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz --memory 550 --tmp-dir /nephele_data/tmp/ -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/ -t 16 --only-assembler
Command line: /usr/local/src/SPAdes/bin/metaspades.py	-1	/nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz	-2	/nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz	--memory	550	--tmp-dir	/nephele_data/tmp	-o	/nephele_data/outputs/asmbMetaSpades/S1_asmb	-t	16	--only-assembler	

System information:
  SPAdes version: 3.15.2
  Python version: 3.7.3
  OS: Linux-4.19.0-20-cloud-amd64-x86_64-with-debian-10.12

Output dir: /nephele_data/outputs/asmbMetaSpades/S1_asmb
Mode: ONLY assembling (without read error correction)
Debug mode is turned OFF

Dataset parameters:
  Metagenomic mode
  Reads:
    Library number: 1, library type: paired-end
      orientation: fr
      left reads: ['/nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz']
      right reads: ['/nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz']
      interlaced reads: not specified
      single reads: not specified
      merged reads: not specified
Assembly parameters:
  k: [21, 33, 55]
  Repeat resolution is enabled
  Mismatch careful mode is turned OFF
  MismatchCorrector will be SKIPPED
  Coverage cutoff is turned OFF
Other parameters:
  Dir for temp files: /nephele_data/tmp
  Threads: 16
  Memory limit (in Gb): 550


======= SPAdes pipeline started. Log can be found here: /nephele_data/outputs/asmbMetaSpades/S1_asmb/spades.log

/nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz: max reads length: 150
/nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz: max reads length: 150

Reads length: 150


===== Before start started. 


===== Assembling started. 


===== K21 started. 


== Running: /usr/local/src/SPAdes/bin/spades-core /nephele_data/outputs/asmbMetaSpades/S1_asmb/K21/configs/config.info /nephele_data/outputs/asmbMetaSpades/S1_asmb/K21/configs/mda_mode.info /nephele_data/outputs/asmbMetaSpades/S1_asmb/K21/configs/meta_mode.info

  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K21/configs/config.info
  0:00:00.042     1M / 12M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K21/configs/mda_mode.info
  0:00:00.042     1M / 12M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K21/configs/meta_mode.info
  0:00:00.042     1M / 12M   INFO    General                 (memory_limit.cpp          :  48)   Memory limit set to 550 Gb
  0:00:00.042     1M / 12M   INFO    General                 (main.cpp                  : 107)   Starting SPAdes, built from refs/heads/spades_3.15.2, git revision aab988a9b4986906b38396da7233bb1ee02982f2
  0:00:00.042     1M / 12M   INFO    General                 (main.cpp                  : 108)   Maximum k-mer length: 128
  0:00:00.042     1M / 12M   INFO    General                 (main.cpp                  : 109)   Assembling dataset (/nephele_data/outputs/asmbMetaSpades/S1_asmb/dataset.info) with K=21
  0:00:00.042     1M / 12M   INFO    General                 (main.cpp                  : 110)   Maximum # of threads to use (adjusted due to OMP capabilities): 16
  0:00:00.042     1M / 12M   INFO    General                 (pipeline.cpp              : 212)   SPAdes started
  0:00:00.042     1M / 12M   INFO    General                 (pipeline.cpp              : 225)   Starting from stage: read_conversion
  0:00:00.042     1M / 12M   INFO    General                 (pipeline.cpp              : 231)   Two-step repeat resolution disabled
  0:00:00.074     1M / 12M   INFO   GraphCore                (graph_core.hpp            : 672)   Graph created, vertex min_id: 3, edge min_id: 3
  0:00:00.075     1M / 12M   INFO   GraphCore                (graph_core.hpp            : 673)   Vertex size: 48, edge size: 40
  0:00:00.078     1M / 12M   INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:00:00.087     1M / 12M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == Binary Read Conversion (id: read_conversion)
  0:00:00.087     1M / 12M   INFO    General                 (read_converter.cpp        :  72)   Converting reads to binary format for library #0 (takes a while)
  0:00:00.087     1M / 12M   INFO    General                 (read_converter.cpp        :  73)   Converting paired reads
  0:00:00.683    21M / 85M   INFO    General                 (binary_converter.cpp      :  96)   16384 reads processed
  0:00:00.701    21M / 88M   INFO    General                 (binary_converter.cpp      :  96)   32768 reads processed
  0:00:00.735    21M / 92M   INFO    General                 (binary_converter.cpp      :  96)   65536 reads processed
  0:00:01.043    12M / 128M  INFO    General                 (binary_converter.cpp      :  96)   131072 reads processed
  0:00:01.498    12M / 147M  INFO    General                 (binary_converter.cpp      :  96)   262144 reads processed
  0:00:02.498     3M / 212M  INFO    General                 (binary_converter.cpp      :  96)   524288 reads processed
Removing temporary output file /nephele_data/outputs/TEDreads/S28_R2_te.fastq.gz.
Removing temporary output file /nephele_data/outputs/TEDreads/S28_R1_te.fastq.gz.
Removing temporary output file /nephele_data/outputs/TEDreads/S28_kr2outLOG.txt.
[Tue Oct 24 17:19:30 2023]
Finished job 15.
6 of 139 steps (4%) done

[Tue Oct 24 17:19:30 2023]
rule compress_kraken2_decontaminate:
    input: /nephele_data/outputs/TEDreads/S28_R_1_ted.fastq, /nephele_data/outputs/TEDreads/S28_R_2_ted.fastq
    output: /nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz
    jobid: 14
    wildcards: sample=S28

pigz -c /nephele_data/outputs/TEDreads/S28_R_1_ted.fastq > /nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz &&pigz -c /nephele_data/outputs/TEDreads/S28_R_2_ted.fastq > /nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz

[Tue Oct 24 17:19:30 2023]
rule run_kraken2_decontaminate:
    input: /nephele_data/outputs/TEDreads/S6_R1_te.fastq.gz, /nephele_data/outputs/TEDreads/S6_R2_te.fastq.gz
    output: /nephele_data/outputs/TEDreads/S6_R_1_ted.fastq, /nephele_data/outputs/TEDreads/S6_R_2_ted.fastq, /nephele_data/outputs/TEDreads/S6_kr2outLOG.txt, /nephele_data/outputs/TEDreads/S6_kr2_decontamREPORT.txt, /nephele_data/outputs/TEDreads/S6_kr2_decontamLOG.txt
    jobid: 10
    wildcards: sample=S6
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --gzip-compressed --threads 16 --confidence 0.05 --db /mnt/EFS/dbs/wgsa2/decontam_db/decontam_human+mouse_db --paired /nephele_data/outputs/TEDreads/S6_R1_te.fastq.gz /nephele_data/outputs/TEDreads/S6_R2_te.fastq.gz --unclassified-out /nephele_data/outputs/TEDreads/S6_R#_ted.fastq --output /nephele_data/outputs/TEDreads/S6_kr2outLOG.txt --report /nephele_data/outputs/TEDreads/S6_kr2_decontamREPORT.txt 2>> /nephele_data/outputs/TEDreads/S6_kr2_decontamLOG.txt
  0:00:04.106     0M / 250M  INFO    General                 (binary_converter.cpp      : 111)   999821 reads written
  0:00:04.117     0M / 250M  INFO    General                 (read_converter.cpp        :  81)   Converting single reads
  0:00:04.137     0M / 250M  INFO    General                 (binary_converter.cpp      : 111)   0 reads written
  0:00:04.168     0M / 250M  INFO    General                 (read_converter.cpp        :  87)   Converting merged reads
  0:00:04.209     0M / 250M  INFO    General                 (binary_converter.cpp      : 111)   0 reads written
  0:00:04.270     1M / 250M  INFO   StageManager             (stage.cpp                 : 185)   STAGE == de Bruijn graph construction (id: construction)
  0:00:04.306     1M / 250M  INFO    General                 (construction.cpp          : 153)   Max read length 150
  0:00:04.318     1M / 250M  INFO    General                 (construction.cpp          : 159)   Average read length 149.628
  0:00:04.319     1M / 250M  INFO    General                 (stage.cpp                 : 117)   PROCEDURE == k+1-mer counting (id: construction:kpomer_counting)
  0:00:04.319     1M / 250M  INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:04.330     1M / 250M  INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:04.360     1M / 250M  INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:04.384     1M / 250M  INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 419430
Removing temporary output file /nephele_data/outputs/TEDreads/S28_R_2_ted.fastq.
Removing temporary output file /nephele_data/outputs/TEDreads/S28_R_1_ted.fastq.
[Tue Oct 24 17:19:32 2023]
Finished job 14.
7 of 139 steps (5%) done

[Tue Oct 24 17:19:32 2023]
rule run_metaspades:
    input: /nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffolds.fasta
    jobid: 31
    wildcards: sample=S28
    threads: 16

python3 /usr/local/src/SPAdes/bin/metaspades.py -1 /nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz -2 /nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz --memory 550 --tmp-dir /nephele_data/tmp/ -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/ -t 16 --only-assembler
Command line: /usr/local/src/SPAdes/bin/metaspades.py	-1	/nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz	-2	/nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz	--memory	550	--tmp-dir	/nephele_data/tmp	-o	/nephele_data/outputs/asmbMetaSpades/S28_asmb	-t	16	--only-assembler	

System information:
  SPAdes version: 3.15.2
  Python version: 3.7.3
  OS: Linux-4.19.0-20-cloud-amd64-x86_64-with-debian-10.12

Output dir: /nephele_data/outputs/asmbMetaSpades/S28_asmb
Mode: ONLY assembling (without read error correction)
Debug mode is turned OFF

Dataset parameters:
  Metagenomic mode
  Reads:
    Library number: 1, library type: paired-end
      orientation: fr
      left reads: ['/nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz']
      right reads: ['/nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz']
      interlaced reads: not specified
      single reads: not specified
      merged reads: not specified
Assembly parameters:
  k: [21, 33, 55]
  Repeat resolution is enabled
  Mismatch careful mode is turned OFF
  MismatchCorrector will be SKIPPED
  Coverage cutoff is turned OFF
Other parameters:
  Dir for temp files: /nephele_data/tmp
  Threads: 16
  Memory limit (in Gb): 550


======= SPAdes pipeline started. Log can be found here: /nephele_data/outputs/asmbMetaSpades/S28_asmb/spades.log

/nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz: max reads length: 150
/nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz: max reads length: 150

Reads length: 150


===== Before start started. 


===== Assembling started. 


===== K21 started. 


== Running: /usr/local/src/SPAdes/bin/spades-core /nephele_data/outputs/asmbMetaSpades/S28_asmb/K21/configs/config.info /nephele_data/outputs/asmbMetaSpades/S28_asmb/K21/configs/mda_mode.info /nephele_data/outputs/asmbMetaSpades/S28_asmb/K21/configs/meta_mode.info

  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K21/configs/config.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K21/configs/mda_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K21/configs/meta_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (memory_limit.cpp          :  48)   Memory limit set to 550 Gb
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 107)   Starting SPAdes, built from refs/heads/spades_3.15.2, git revision aab988a9b4986906b38396da7233bb1ee02982f2
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 108)   Maximum k-mer length: 128
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 109)   Assembling dataset (/nephele_data/outputs/asmbMetaSpades/S28_asmb/dataset.info) with K=21
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 110)   Maximum # of threads to use (adjusted due to OMP capabilities): 16
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 212)   SPAdes started
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 225)   Starting from stage: read_conversion
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 231)   Two-step repeat resolution disabled
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 672)   Graph created, vertex min_id: 3, edge min_id: 3
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 673)   Vertex size: 48, edge size: 40
  0:00:00.000     1M / 11M   INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:00:00.000     1M / 11M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == Binary Read Conversion (id: read_conversion)
  0:00:00.001     1M / 11M   INFO    General                 (read_converter.cpp        :  72)   Converting reads to binary format for library #0 (takes a while)
  0:00:00.001     1M / 11M   INFO    General                 (read_converter.cpp        :  73)   Converting paired reads
  0:00:00.789    21M / 86M   INFO    General                 (binary_converter.cpp      :  96)   16384 reads processed
  0:00:00.822    21M / 90M   INFO    General                 (binary_converter.cpp      :  96)   32768 reads processed
  0:00:00.881    21M / 93M   INFO    General                 (binary_converter.cpp      :  96)   65536 reads processed
  0:00:01.203    12M / 131M  INFO    General                 (binary_converter.cpp      :  96)   131072 reads processed
  0:00:02.187     3M / 188M  INFO    General                 (binary_converter.cpp      :  96)   262144 reads processed
  0:00:10.061  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 125)   Processed 3999284 reads
  0:00:10.077     1M / 5520M INFO    General                 (kmer_splitters.hpp        : 131)   Used 3999284 reads
  0:00:10.088     1M / 5520M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:03.094     0M / 264M  INFO    General                 (binary_converter.cpp      :  96)   524288 reads processed
  0:00:10.346     1M / 5520M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 159572298 kmers in total.
  0:00:10.346     1M / 5520M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Extension index construction (id: construction:extension_index_construction)
  0:00:10.347     1M / 5520M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 438)   Building kmer index
  0:00:10.347     1M / 5520M INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:10.347     1M / 5520M INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:10.347     1M / 5520M INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:10.347     1M / 5520M INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 419430
  0:00:04.686     0M / 309M  INFO    General                 (binary_converter.cpp      : 111)   999835 reads written
  0:00:04.687     0M / 309M  INFO    General                 (read_converter.cpp        :  81)   Converting single reads
  0:00:04.687     0M / 309M  INFO    General                 (binary_converter.cpp      : 111)   0 reads written
  0:00:04.687     0M / 309M  INFO    General                 (read_converter.cpp        :  87)   Converting merged reads
  0:00:04.687     0M / 309M  INFO    General                 (binary_converter.cpp      : 111)   0 reads written
  0:00:04.703     1M / 309M  INFO   StageManager             (stage.cpp                 : 185)   STAGE == de Bruijn graph construction (id: construction)
  0:00:04.704     1M / 309M  INFO    General                 (construction.cpp          : 153)   Max read length 150
  0:00:04.704     1M / 309M  INFO    General                 (construction.cpp          : 159)   Average read length 149.623
  0:00:04.704     1M / 309M  INFO    General                 (stage.cpp                 : 117)   PROCEDURE == k+1-mer counting (id: construction:kpomer_counting)
  0:00:04.704     1M / 309M  INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:04.704     1M / 309M  INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:04.704     1M / 309M  INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:04.704     1M / 309M  INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 419430
Removing temporary output file /nephele_data/outputs/TEDreads/S6_R2_te.fastq.gz.
Removing temporary output file /nephele_data/outputs/TEDreads/S6_R1_te.fastq.gz.
Removing temporary output file /nephele_data/outputs/TEDreads/S6_kr2outLOG.txt.
[Tue Oct 24 17:19:38 2023]
Finished job 10.
8 of 139 steps (6%) done

[Tue Oct 24 17:19:38 2023]
rule compress_kraken2_decontaminate:
    input: /nephele_data/outputs/TEDreads/S6_R_1_ted.fastq, /nephele_data/outputs/TEDreads/S6_R_2_ted.fastq
    output: /nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz
    jobid: 9
    wildcards: sample=S6

pigz -c /nephele_data/outputs/TEDreads/S6_R_1_ted.fastq > /nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz &&pigz -c /nephele_data/outputs/TEDreads/S6_R_2_ted.fastq > /nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz
Removing temporary output file /nephele_data/outputs/TEDreads/S6_R_1_ted.fastq.
Removing temporary output file /nephele_data/outputs/TEDreads/S6_R_2_ted.fastq.
[Tue Oct 24 17:19:43 2023]
Finished job 9.
9 of 139 steps (6%) done

[Tue Oct 24 17:19:43 2023]
rule run_kraken2_classification:
    input: /nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S28_klog.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S28_taxREPORT.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S28_classLOG.txt
    jobid: 13
    wildcards: sample=S28
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --gzip-compressed --threads 16 --confidence 0.05 --db /mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 --memory-mapping --paired /nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz /nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz --output /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S28_klog.txt --report /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S28_taxREPORT.txt 2>> /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S28_classLOG.txt
  0:00:18.232  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 159572298 kmers
  0:00:18.233  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 199)   Used 159572298 kmers.
  0:00:18.238     1M / 7190M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:18.530     1M / 7190M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 157915942 kmers in total.
  0:00:18.530     1M / 7190M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:11.408  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 125)   Processed 3999340 reads
  0:00:11.412     1M / 5502M INFO    General                 (kmer_splitters.hpp        : 131)   Used 3999340 reads
  0:00:11.423     1M / 5502M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:11.650     1M / 5502M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 135189836 kmers in total.
  0:00:11.650     1M / 5502M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Extension index construction (id: construction:extension_index_construction)
  0:00:11.651     1M / 5502M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 438)   Building kmer index
  0:00:11.651     1M / 5502M INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:11.651     1M / 5502M INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:11.651     1M / 5502M INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:11.651     1M / 5502M INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 419430
  0:00:19.584   117M / 7190M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 157915942 kmers, 114176104 bytes occupied (5.78415 bits per kmer).
  0:00:19.584   117M / 7190M INFO    General                 (kmer_index_builder.hpp    : 169)   Merging final buckets.
  0:00:21.191   269M / 7190M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 100)   Building k-mer extensions from k+1-mers
  0:00:17.618  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 135189836 kmers
  0:00:17.618  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 199)   Used 135189836 kmers.
  0:00:17.623     1M / 6919M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:17.869     1M / 6919M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 132961383 kmers in total.
  0:00:17.869     1M / 6919M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:19.176   102M / 6919M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 132961383 kmers, 96152144 bytes occupied (5.78527 bits per kmer).
  0:00:19.176   102M / 6919M INFO    General                 (kmer_index_builder.hpp    : 169)   Merging final buckets.
  0:00:20.539   230M / 6919M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 100)   Building k-mer extensions from k+1-mers
  0:00:28.178   269M / 7190M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 105)   Building k-mer extensions from k+1-mers finished.
  0:00:28.229   269M / 7190M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Early tip clipping (id: construction:early_tip_clipper)
  0:00:28.229   269M / 7190M INFO    General                 (construction.cpp          : 301)   Early tip clipper length bound set as (RL - K)
  0:00:28.229   269M / 7190M INFO   Early tip clipping       (early_simplification.hpp  :  47)   Early tip clipping
  0:00:26.313   230M / 6919M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 105)   Building k-mer extensions from k+1-mers finished.
  0:00:26.358   230M / 6919M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Early tip clipping (id: construction:early_tip_clipper)
  0:00:26.358   230M / 6919M INFO    General                 (construction.cpp          : 301)   Early tip clipper length bound set as (RL - K)
  0:00:26.358   230M / 6919M INFO   Early tip clipping       (early_simplification.hpp  :  47)   Early tip clipping
  0:00:36.319   429M / 7190M INFO   Early tip clipping       (early_simplification.hpp  :  82)   #tipped junctions: 1509071
  0:00:36.399   429M / 7190M INFO   Early tip clipping       (early_simplification.hpp  :  93)   Clipped tips: 1520983
  0:00:36.422   269M / 7190M INFO   Early tip clipping       (early_simplification.hpp  :  49)   38216597 22-mers were removed by early tip clipper
  0:00:36.423   269M / 7190M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Condensing graph (id: construction:graph_condensing)
  0:00:36.424   269M / 7190M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 354)   Extracting unbranching paths
  0:00:33.808   390M / 6919M INFO   Early tip clipping       (early_simplification.hpp  :  82)   #tipped junctions: 1573892
  0:00:33.893   390M / 6919M INFO   Early tip clipping       (early_simplification.hpp  :  93)   Clipped tips: 1595661
  0:00:33.912   230M / 6919M INFO   Early tip clipping       (early_simplification.hpp  :  49)   37341741 22-mers were removed by early tip clipper
  0:00:33.913   230M / 6919M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Condensing graph (id: construction:graph_condensing)
  0:00:33.914   230M / 6919M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 354)   Extracting unbranching paths
  0:00:44.845   493M / 7190M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 373)   Extracting unbranching paths finished. 5625718 sequences extracted
  0:00:40.761   469M / 6919M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 373)   Extracting unbranching paths finished. 6213304 sequences extracted
  0:00:48.300   493M / 7190M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 309)   Collecting perfect loops
  0:00:49.577   494M / 7190M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 342)   Collecting perfect loops finished. 83 loops collected
  0:00:49.847   493M / 7190M INFO    General                 (debruijn_graph_constructor: 487)   Total 11251602 edges to create
  0:00:49.847   927M / 7190M INFO    General                 (debruijn_graph_constructor: 489)   Collecting link records
  0:00:43.504   469M / 6919M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 309)   Collecting perfect loops
  0:00:44.382   469M / 6919M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 342)   Collecting perfect loops finished. 3 loops collected
  0:00:44.665   469M / 6919M INFO    General                 (debruijn_graph_constructor: 487)   Total 12426614 edges to create
  0:00:44.666   951M / 6919M INFO    General                 (debruijn_graph_constructor: 489)   Collecting link records
  0:00:56.274  1099M / 7190M INFO    General                 (debruijn_graph_constructor: 491)   Ordering link records
  0:00:56.367  1099M / 7190M INFO    General                 (debruijn_graph_constructor: 493)   Sorting done
  0:00:56.407  1131M / 7190M INFO    General                 (debruijn_graph_constructor: 503)   Total 3969445 vertices to create
  0:00:56.407  1501M / 7190M INFO    General                 (debruijn_graph_constructor: 506)   Connecting the graph
  0:00:51.448  1143M / 6919M INFO    General                 (debruijn_graph_constructor: 491)   Ordering link records
  0:00:51.577  1143M / 6919M INFO    General                 (debruijn_graph_constructor: 493)   Sorting done
  0:00:51.619  1175M / 6919M INFO    General                 (debruijn_graph_constructor: 503)   Total 3984854 vertices to create
  0:00:51.619  1544M / 6919M INFO    General                 (debruijn_graph_constructor: 506)   Connecting the graph
  0:01:01.361  1208M / 7190M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Filling coverage indices (PHM) (id: construction:coverage_filling_phm)
  0:01:01.361  1208M / 7190M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:01:02.596  1324M / 7190M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 159572298 kmers, 115372616 bytes occupied (5.78409 bits per kmer).
  0:01:02.767  1936M / 7190M INFO    General                 (coverage_hash_map_builder.:  47)   Collecting k-mer coverage information from reads, this takes a while.
  0:00:56.089  1224M / 6919M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Filling coverage indices (PHM) (id: construction:coverage_filling_phm)
  0:00:56.089  1224M / 6919M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:57.226  1325M / 6919M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 135189836 kmers, 97760312 bytes occupied (5.78507 bits per kmer).
  0:00:57.374  1842M / 6919M INFO    General                 (coverage_hash_map_builder.:  47)   Collecting k-mer coverage information from reads, this takes a while.
  0:01:08.394  1936M / 7190M INFO    General                 (construction.cpp          : 430)   Filling coverage and flanking coverage from PHM
  0:01:02.916  1842M / 6919M INFO    General                 (construction.cpp          : 430)   Filling coverage and flanking coverage from PHM
  0:01:13.464  1936M / 7190M INFO    General                 (coverage_filling.hpp      :  82)   Processed 11250931 edges
  0:01:13.938   940M / 7190M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Raw Simplification (id: raw_simplification)
  0:01:14.054   940M / 7190M INFO    General                 (simplification.cpp        : 127)   PROCEDURE == Initial cleaning
  0:01:07.012  1842M / 6919M INFO    General                 (coverage_filling.hpp      :  82)   Processed 12426310 edges
  0:01:14.330   940M / 7190M INFO    General                 (graph_simplification.hpp  : 662)   Flanking coverage based disconnection disabled
  0:01:14.330   940M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Self conjugate edge remover
  0:01:14.471   940M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Self conjugate edge remover triggered 0 times
  0:01:14.471   940M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial tip clipper
  0:01:07.409   995M / 6919M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Raw Simplification (id: raw_simplification)
  0:01:07.409   995M / 6919M INFO    General                 (simplification.cpp        : 127)   PROCEDURE == Initial cleaning
  0:01:07.409   995M / 6919M INFO    General                 (graph_simplification.hpp  : 662)   Flanking coverage based disconnection disabled
  0:01:07.409   995M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Self conjugate edge remover
  0:01:07.554   995M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Self conjugate edge remover triggered 0 times
  0:01:07.554   995M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial tip clipper
  0:01:14.801   940M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial tip clipper triggered 18926 times
  0:01:14.801   940M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial ec remover
  0:01:07.890   995M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial tip clipper triggered 17870 times
  0:01:07.891   995M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial ec remover
  0:01:26.665  1062M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial ec remover triggered 1360049 times
  0:01:26.677  1062M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial isolated edge remover
  0:01:26.968  1057M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial isolated edge remover triggered 140334 times
  0:01:26.969   854M / 7190M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification (id: simplification)
  0:01:26.969   854M / 7190M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:01:26.969   854M / 7190M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:26.969   854M / 7190M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:01:26.970   854M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:27.176   853M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 23452 times
  0:01:27.179   853M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:21.195  1119M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial ec remover triggered 1613968 times
  0:01:21.207  1119M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial isolated edge remover
  0:01:21.297  1119M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial isolated edge remover triggered 6854 times
  0:01:21.297   903M / 6919M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification (id: simplification)
  0:01:21.297   903M / 6919M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:01:21.298   903M / 6919M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:21.298   903M / 6919M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:01:21.298   903M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:21.477   902M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 20004 times
  0:01:21.479   902M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.213   836M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 465088 times
  0:01:36.217   836M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.249   837M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:36.250   837M / 7190M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:01:36.250   837M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.392   827M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 6128 times
  0:01:36.393   827M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.400   822M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 102 times
  0:01:36.400   822M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.523   824M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 12438 times
  0:01:36.527   824M / 7190M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:01:36.527   824M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.539   823M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 398 times
  0:01:36.539   823M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.644   822M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 2026 times
  0:01:36.645   822M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.690   823M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 5009 times
  0:01:36.691   823M / 7190M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:01:36.691   823M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.717   822M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 104 times
  0:01:36.717   822M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.910   822M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 1847 times
  0:01:36.910   822M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.934   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:36.934   820M / 7190M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:01:36.934   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.935   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:36.935   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.935   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:36.935   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.935   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:36.970   819M / 7190M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification Cleanup (id: simplification_cleanup)
  0:01:36.971   819M / 7190M INFO    General                 (simplification.cpp        : 176)   PROCEDURE == Post simplification
  0:01:36.971   819M / 7190M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:36.971   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:37.166   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 4926 times
  0:01:37.167   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:37.216   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 412 times
  0:01:37.217   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:37.248   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 70 times
  0:01:37.248   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:37.889   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 149 times
  0:01:37.890   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:37.914   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 327 times
  0:01:37.914   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:37.945   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 1342 times
  0:01:37.946   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:37.996   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 379 times
  0:01:37.996   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:38.030   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:38.030   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:38.117   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 39 times
  0:01:38.117   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:38.146   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 39 times
  0:01:38.146   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:38.174   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:38.174   820M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:38.795   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 4 times
  0:01:38.795   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:38.817   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 46 times
  0:01:38.817   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:38.839   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 10 times
  0:01:38.839   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:38.880   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 4 times
  0:01:38.881   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:38.915   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:38.915   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:39.004   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 2 times
  0:01:39.005   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:39.005   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 1 times
  0:01:39.005   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:39.033   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 1 times
  0:01:39.033   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:39.653   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:01:39.653   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:39.653   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:39.653   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:39.653   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:39.653   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:39.654   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:39.654   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:39.654   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:39.654   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:39.752   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:01:39.752   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:39.752   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:01:39.752   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:39.780   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:39.780   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:40.399   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:01:40.399   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:40.399   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:40.399   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:40.399   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:40.399   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:40.399   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:40.399   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:40.400   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:40.400   819M / 7190M INFO    General                 (simplification.cpp        : 323)   Running Hidden EC remover (meta)
  0:01:40.436   819M / 7190M INFO    General                 (simplification.cpp        : 327)   Disrupting self-conjugate edges
  0:01:40.536   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Removing isolated edges
  0:01:40.562   819M / 7190M INFO   Simplification           (parallel_processing.hpp   : 170)   Removing isolated edges triggered 2788 times
  0:01:40.562   819M / 7190M INFO    General                 (simplification.cpp        : 491)   Counting average coverage
  0:01:40.611   819M / 7190M INFO    General                 (simplification.cpp        : 497)   Average coverage = 3.48461
  0:01:40.611   819M / 7190M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:01:40.611   819M / 7190M INFO    General                 (read_converter.cpp        : 102)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K21/simplified_contigs
  0:01:40.615   821M / 7190M INFO    General                 (binary_converter.cpp      :  96)   16384 reads processed
  0:01:40.621   821M / 7190M INFO    General                 (binary_converter.cpp      :  96)   32768 reads processed
  0:01:40.631   821M / 7190M INFO    General                 (binary_converter.cpp      :  96)   65536 reads processed
  0:01:40.651   821M / 7190M INFO    General                 (binary_converter.cpp      :  96)   131072 reads processed
  0:01:40.683   821M / 7190M INFO    General                 (binary_converter.cpp      : 111)   178228 reads written
  0:01:40.684   819M / 7190M INFO    General                 (pipeline.cpp              : 287)   SPAdes finished
  0:01:40.809     1M / 7190M INFO    General                 (main.cpp                  : 136)   Assembling time: 0 hours 1 minutes 41 seconds

===== K21 finished. 


===== K33 started. 


== Running: /usr/local/src/SPAdes/bin/spades-core /nephele_data/outputs/asmbMetaSpades/S1_asmb/K33/configs/config.info /nephele_data/outputs/asmbMetaSpades/S1_asmb/K33/configs/mda_mode.info /nephele_data/outputs/asmbMetaSpades/S1_asmb/K33/configs/meta_mode.info

  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K33/configs/config.info
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K33/configs/mda_mode.info
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K33/configs/meta_mode.info
  0:00:00.000     1M / 12M   INFO    General                 (memory_limit.cpp          :  48)   Memory limit set to 550 Gb
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  : 107)   Starting SPAdes, built from refs/heads/spades_3.15.2, git revision aab988a9b4986906b38396da7233bb1ee02982f2
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  : 108)   Maximum k-mer length: 128
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  : 109)   Assembling dataset (/nephele_data/outputs/asmbMetaSpades/S1_asmb/dataset.info) with K=33
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  : 110)   Maximum # of threads to use (adjusted due to OMP capabilities): 16
  0:00:00.000     1M / 12M   INFO    General                 (pipeline.cpp              : 212)   SPAdes started
  0:00:00.000     1M / 12M   INFO    General                 (pipeline.cpp              : 225)   Starting from stage: read_conversion
  0:00:00.000     1M / 12M   INFO    General                 (pipeline.cpp              : 231)   Two-step repeat resolution disabled
  0:00:00.000     1M / 12M   INFO   GraphCore                (graph_core.hpp            : 672)   Graph created, vertex min_id: 3, edge min_id: 3
  0:00:00.000     1M / 12M   INFO   GraphCore                (graph_core.hpp            : 673)   Vertex size: 48, edge size: 40
  0:00:00.000     1M / 12M   INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:00:00.000     1M / 12M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == Binary Read Conversion (id: read_conversion)
  0:00:00.001     1M / 12M   INFO    General                 (read_converter.cpp        :  53)   Binary reads detected
  0:00:00.002     1M / 12M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == de Bruijn graph construction (id: construction)
  0:00:00.002     1M / 12M   INFO    General                 (construction.cpp          : 118)   Contigs from previous K will be used: /nephele_data/outputs/asmbMetaSpades/S1_asmb/K21/simplified_contigs
  0:00:00.032     1M / 12M   INFO    General                 (construction.cpp          : 153)   Max read length 150
  0:00:00.033     1M / 12M   INFO    General                 (construction.cpp          : 159)   Average read length 149.628
  0:00:00.033     1M / 12M   INFO    General                 (stage.cpp                 : 117)   PROCEDURE == k+1-mer counting (id: construction:kpomer_counting)
  0:00:00.033     1M / 12M   INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:00.033     1M / 12M   INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:00.033     1M / 12M   INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:00.033     1M / 12M   INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:01:35.903   885M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 606654 times
  0:01:35.907   885M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:35.927   886M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:35.927   886M / 6919M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:01:35.927   886M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.039   869M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 5762 times
  0:01:36.040   869M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.047   865M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 118 times
  0:01:36.048   865M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.145   865M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 8000 times
  0:01:36.148   865M / 6919M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:01:36.148   865M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.157   865M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 317 times
  0:01:36.157   865M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.242   864M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 1826 times
  0:01:36.243   864M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.288   864M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 3860 times
  0:01:36.290   864M / 6919M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:01:36.290   864M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.305   864M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 73 times
  0:01:36.305   864M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.384   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 708 times
  0:01:36.385   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.400   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:36.400   863M / 6919M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:01:36.400   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.400   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 2 times
  0:01:36.400   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.400   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:36.400   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.400   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:36.401   863M / 6919M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 6
  0:01:36.401   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.401   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:36.401   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.401   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:36.401   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:36.401   863M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:36.422   862M / 6919M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification Cleanup (id: simplification_cleanup)
  0:01:36.422   862M / 6919M INFO    General                 (simplification.cpp        : 176)   PROCEDURE == Post simplification
  0:01:36.422   862M / 6919M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:36.422   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:36.566   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 3951 times
  0:01:36.567   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:36.661   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 2368 times
  0:01:36.661   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:36.679   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 53 times
  0:01:36.679   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:36.938   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 208 times
  0:01:36.939   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.967   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 1598 times
  0:01:36.967   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:36.989   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 987 times
  0:01:36.989   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:37.029   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 214 times
  0:01:37.030   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:37.051   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 2 times
  0:01:37.051   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:37.098   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 69 times
  0:01:37.099   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:37.124   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 221 times
  0:01:37.124   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:37.140   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 1 times
  0:01:37.140   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:37.368   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 7 times
  0:01:37.369   862M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:37.383   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 102 times
  0:01:37.383   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:37.398   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 12 times
  0:01:37.398   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:37.432   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 9 times
  0:01:37.432   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:37.453   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:37.453   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:37.500   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 8 times
  0:01:37.500   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:37.501   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 5 times
  0:01:37.501   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:37.516   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:37.517   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:37.745   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 1 times
  0:01:37.746   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:37.746   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 4 times
  0:01:37.746   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:37.746   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:37.746   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:37.746   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:37.746   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:37.746   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:37.746   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:37.798   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:01:37.798   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:37.798   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:01:37.798   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:37.814   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:37.814   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:38.041   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:01:38.042   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:38.042   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:38.042   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:38.042   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:38.042   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:38.042   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:38.042   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:38.042   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:38.042   861M / 6919M INFO    General                 (simplification.cpp        : 323)   Running Hidden EC remover (meta)
  0:01:38.066   861M / 6919M INFO    General                 (simplification.cpp        : 327)   Disrupting self-conjugate edges
  0:01:38.112   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Removing isolated edges
  0:01:38.127   861M / 6919M INFO   Simplification           (parallel_processing.hpp   : 170)   Removing isolated edges triggered 545 times
  0:01:38.127   861M / 6919M INFO    General                 (simplification.cpp        : 491)   Counting average coverage
  0:01:38.154   861M / 6919M INFO    General                 (simplification.cpp        : 497)   Average coverage = 5.57323
  0:01:38.154   861M / 6919M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:01:38.154   861M / 6919M INFO    General                 (read_converter.cpp        : 102)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K21/simplified_contigs
  0:01:38.161   864M / 6919M INFO    General                 (binary_converter.cpp      :  96)   16384 reads processed
  0:01:38.168   864M / 6919M INFO    General                 (binary_converter.cpp      :  96)   32768 reads processed
  0:01:38.183   864M / 6919M INFO    General                 (binary_converter.cpp      :  96)   65536 reads processed
  0:01:38.206   864M / 6919M INFO    General                 (binary_converter.cpp      : 111)   74787 reads written
  0:01:38.208   861M / 6919M INFO    General                 (pipeline.cpp              : 287)   SPAdes finished
  0:01:38.293     1M / 6919M INFO    General                 (main.cpp                  : 136)   Assembling time: 0 hours 1 minutes 38 seconds

===== K21 finished. 


===== K33 started. 


== Running: /usr/local/src/SPAdes/bin/spades-core /nephele_data/outputs/asmbMetaSpades/S28_asmb/K33/configs/config.info /nephele_data/outputs/asmbMetaSpades/S28_asmb/K33/configs/mda_mode.info /nephele_data/outputs/asmbMetaSpades/S28_asmb/K33/configs/meta_mode.info

  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K33/configs/config.info
  0:00:00.001     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K33/configs/mda_mode.info
  0:00:00.001     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K33/configs/meta_mode.info
  0:00:00.001     1M / 11M   INFO    General                 (memory_limit.cpp          :  48)   Memory limit set to 550 Gb
  0:00:00.001     1M / 11M   INFO    General                 (main.cpp                  : 107)   Starting SPAdes, built from refs/heads/spades_3.15.2, git revision aab988a9b4986906b38396da7233bb1ee02982f2
  0:00:00.001     1M / 11M   INFO    General                 (main.cpp                  : 108)   Maximum k-mer length: 128
  0:00:00.001     1M / 11M   INFO    General                 (main.cpp                  : 109)   Assembling dataset (/nephele_data/outputs/asmbMetaSpades/S28_asmb/dataset.info) with K=33
  0:00:00.001     1M / 11M   INFO    General                 (main.cpp                  : 110)   Maximum # of threads to use (adjusted due to OMP capabilities): 16
  0:00:00.001     1M / 11M   INFO    General                 (pipeline.cpp              : 212)   SPAdes started
  0:00:00.001     1M / 11M   INFO    General                 (pipeline.cpp              : 225)   Starting from stage: read_conversion
  0:00:00.001     1M / 11M   INFO    General                 (pipeline.cpp              : 231)   Two-step repeat resolution disabled
  0:00:00.001     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 672)   Graph created, vertex min_id: 3, edge min_id: 3
  0:00:00.001     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 673)   Vertex size: 48, edge size: 40
  0:00:00.001     1M / 11M   INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:00:00.001     1M / 11M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == Binary Read Conversion (id: read_conversion)
  0:00:00.002     1M / 11M   INFO    General                 (read_converter.cpp        :  53)   Binary reads detected
  0:00:00.003     1M / 12M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == de Bruijn graph construction (id: construction)
  0:00:00.003     1M / 12M   INFO    General                 (construction.cpp          : 118)   Contigs from previous K will be used: /nephele_data/outputs/asmbMetaSpades/S28_asmb/K21/simplified_contigs
  0:00:00.042     1M / 12M   INFO    General                 (construction.cpp          : 153)   Max read length 150
  0:00:00.042     1M / 12M   INFO    General                 (construction.cpp          : 159)   Average read length 149.623
  0:00:00.042     1M / 12M   INFO    General                 (stage.cpp                 : 117)   PROCEDURE == k+1-mer counting (id: construction:kpomer_counting)
  0:00:00.042     1M / 12M   INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:00.043     1M / 12M   INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:00.043     1M / 12M   INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:00.043     1M / 12M   INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:06.085  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 125)   Processed 4355740 reads
  0:00:06.091     1M / 5830M INFO    General                 (kmer_splitters.hpp        : 131)   Used 4355740 reads
  0:00:06.104     1M / 5830M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:06.569     1M / 5830M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 171066254 kmers in total.
  0:00:06.569     1M / 5830M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Extension index construction (id: construction:extension_index_construction)
  0:00:06.571     1M / 5830M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 438)   Building kmer index
  0:00:06.571     1M / 5830M INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:06.571     1M / 5830M INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:06.571     1M / 5830M INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:06.571     1M / 5830M INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:08.089  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 11658288 kmers
  0:00:09.006  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 28524824 kmers
  0:00:09.894  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 45642896 kmers
  0:00:05.992  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 125)   Processed 4148914 reads
  0:00:05.998     1M / 5786M INFO    General                 (kmer_splitters.hpp        : 131)   Used 4148914 reads
  0:00:06.009     1M / 5786M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:10.732  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 62754534 kmers
  0:00:06.380     1M / 5786M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 152933783 kmers in total.
  0:00:06.380     1M / 5786M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Extension index construction (id: construction:extension_index_construction)
  0:00:06.382     1M / 5786M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 438)   Building kmer index
  0:00:06.382     1M / 5786M INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:06.382     1M / 5786M INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:06.382     1M / 5786M INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:06.382     1M / 5786M INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:11.539  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 79870776 kmers
  0:00:12.281  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 96978307 kmers
  0:00:07.776  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 9998096 kmers
  0:00:13.172  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 114100475 kmers
  0:00:08.600  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 25051041 kmers
  0:00:14.079  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 131182855 kmers
  0:00:09.422  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 40362136 kmers
  0:00:10.230  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 55654378 kmers
  0:00:14.971  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 148285455 kmers
  0:00:11.050  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 70954829 kmers
  0:00:15.885  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 165374565 kmers
  0:00:16.195  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 171067134 kmers
  0:00:16.195  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 199)   Used 171067134 kmers.
  0:00:16.200     2M / 8364M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:11.844  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 86246902 kmers
  0:00:12.663  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 101530754 kmers
  0:00:17.496     2M / 8364M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 170532318 kmers in total.
  0:00:17.496     2M / 8364M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:13.439  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 116808484 kmers
  0:00:14.217  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 132100879 kmers
  0:00:19.199   143M / 8364M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 170532318 kmers, 123288728 bytes occupied (5.78371 bits per kmer).
  0:00:19.199   143M / 8364M INFO    General                 (kmer_index_builder.hpp    : 169)   Merging final buckets.
  0:00:14.947  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 147382973 kmers
  0:00:15.188  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 152934663 kmers
  0:00:15.188  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 199)   Used 152934663 kmers.
  0:00:15.192     2M / 8079M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:16.336     2M / 8079M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 151951829 kmers in total.
  0:00:16.336     2M / 8079M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:17.446   117M / 8079M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 151951829 kmers, 109867064 bytes occupied (5.78431 bits per kmer).
  0:00:17.446   117M / 8079M INFO    General                 (kmer_index_builder.hpp    : 169)   Merging final buckets.
  0:00:22.829   307M / 8364M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 100)   Building k-mer extensions from k+1-mers
  0:00:20.408   265M / 8079M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 100)   Building k-mer extensions from k+1-mers
  0:00:30.364   307M / 8364M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 105)   Building k-mer extensions from k+1-mers finished.
  0:00:30.471   307M / 8364M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Early tip clipping (id: construction:early_tip_clipper)
  0:00:30.471   307M / 8364M INFO    General                 (construction.cpp          : 301)   Early tip clipper length bound set as (RL - K)
  0:00:30.471   307M / 8364M INFO   Early tip clipping       (early_simplification.hpp  :  47)   Early tip clipping
  0:00:27.014   265M / 8079M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 105)   Building k-mer extensions from k+1-mers finished.
  0:00:27.112   265M / 8079M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Early tip clipping (id: construction:early_tip_clipper)
  0:00:27.112   265M / 8079M INFO    General                 (construction.cpp          : 301)   Early tip clipper length bound set as (RL - K)
  0:00:27.112   265M / 8079M INFO   Early tip clipping       (early_simplification.hpp  :  47)   Early tip clipping
  0:00:37.655   467M / 8364M INFO   Early tip clipping       (early_simplification.hpp  :  82)   #tipped junctions: 1647386
  0:00:37.733   467M / 8364M INFO   Early tip clipping       (early_simplification.hpp  :  93)   Clipped tips: 1663138
  0:00:37.787   307M / 8364M INFO   Early tip clipping       (early_simplification.hpp  :  49)   60522792 34-mers were removed by early tip clipper
  0:00:37.788   307M / 8364M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Condensing graph (id: construction:graph_condensing)
  0:00:37.788   307M / 8364M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 354)   Extracting unbranching paths
  0:00:35.483   425M / 8079M INFO   Early tip clipping       (early_simplification.hpp  :  82)   #tipped junctions: 1805743
  0:00:35.579   425M / 8079M INFO   Early tip clipping       (early_simplification.hpp  :  93)   Clipped tips: 1838844
  0:00:35.637   265M / 8079M INFO   Early tip clipping       (early_simplification.hpp  :  49)   67044470 34-mers were removed by early tip clipper
  0:00:35.637   265M / 8079M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Condensing graph (id: construction:graph_condensing)
  0:00:35.639   265M / 8079M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 354)   Extracting unbranching paths
  0:00:45.359   447M / 8364M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 373)   Extracting unbranching paths finished. 2816111 sequences extracted
  0:00:42.184   419M / 8079M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 373)   Extracting unbranching paths finished. 3155644 sequences extracted
  0:00:48.266   447M / 8364M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 309)   Collecting perfect loops
  0:00:44.890   419M / 8079M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 309)   Collecting perfect loops
  0:00:49.704   448M / 8364M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 342)   Collecting perfect loops finished. 64 loops collected
  0:00:49.886   447M / 8364M INFO    General                 (debruijn_graph_constructor: 487)   Total 5632350 edges to create
  0:00:49.887   664M / 8364M INFO    General                 (debruijn_graph_constructor: 489)   Collecting link records
  0:00:45.922   419M / 8079M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 342)   Collecting perfect loops finished. 3 loops collected
  0:00:46.105   419M / 8079M INFO    General                 (debruijn_graph_constructor: 487)   Total 6311294 edges to create
  0:00:46.105   664M / 8079M INFO    General                 (debruijn_graph_constructor: 489)   Collecting link records
  0:00:53.018   753M / 8364M INFO    General                 (debruijn_graph_constructor: 491)   Ordering link records
  0:00:53.063   753M / 8364M INFO    General                 (debruijn_graph_constructor: 493)   Sorting done
  0:00:53.088   785M / 8364M INFO    General                 (debruijn_graph_constructor: 503)   Total 2282239 vertices to create
  0:00:53.089   998M / 8364M INFO    General                 (debruijn_graph_constructor: 506)   Connecting the graph
  0:00:49.642   764M / 8079M INFO    General                 (debruijn_graph_constructor: 491)   Ordering link records
  0:00:49.706   764M / 8079M INFO    General                 (debruijn_graph_constructor: 493)   Sorting done
  0:00:49.729   796M / 8079M INFO    General                 (debruijn_graph_constructor: 503)   Total 2173693 vertices to create
  0:00:49.730  1001M / 8079M INFO    General                 (debruijn_graph_constructor: 506)   Connecting the graph
  0:00:55.905   833M / 8364M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Filling coverage indices (PHM) (id: construction:coverage_filling_phm)
  0:00:55.905   833M / 8364M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:52.310   817M / 8079M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Filling coverage indices (PHM) (id: construction:coverage_filling_phm)
  0:00:52.310   817M / 8079M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:57.557   975M / 8364M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 171066254 kmers, 123673648 bytes occupied (5.78366 bits per kmer).
  0:00:57.742  1631M / 8364M INFO    General                 (coverage_hash_map_builder.:  47)   Collecting k-mer coverage information from reads, this takes a while.
  0:00:53.578   932M / 8079M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 152933783 kmers, 110575928 bytes occupied (5.78425 bits per kmer).
  0:00:53.741  1517M / 8079M INFO    General                 (coverage_hash_map_builder.:  47)   Collecting k-mer coverage information from reads, this takes a while.
  0:01:02.966  1631M / 8364M INFO    General                 (construction.cpp          : 430)   Filling coverage and flanking coverage from PHM
  0:00:58.958  1517M / 8079M INFO    General                 (construction.cpp          : 430)   Filling coverage and flanking coverage from PHM
  0:01:07.377  1631M / 8364M INFO    General                 (coverage_filling.hpp      :  82)   Processed 5632168 edges
  0:01:02.732  1517M / 8079M INFO    General                 (coverage_filling.hpp      :  82)   Processed 6311176 edges
  0:01:03.456   552M / 8079M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Raw Simplification (id: raw_simplification)
  0:01:03.456   552M / 8079M INFO    General                 (simplification.cpp        : 127)   PROCEDURE == Initial cleaning
  0:01:03.456   552M / 8079M INFO    General                 (graph_simplification.hpp  : 662)   Flanking coverage based disconnection disabled
  0:01:03.456   552M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Self conjugate edge remover
  0:01:03.535   552M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Self conjugate edge remover triggered 37 times
  0:01:03.535   552M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial tip clipper
  0:01:08.218   527M / 8364M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Raw Simplification (id: raw_simplification)
  0:01:08.219   527M / 8364M INFO    General                 (simplification.cpp        : 127)   PROCEDURE == Initial cleaning
  0:01:08.219   527M / 8364M INFO    General                 (graph_simplification.hpp  : 662)   Flanking coverage based disconnection disabled
  0:01:08.219   527M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Self conjugate edge remover
  0:01:08.312   527M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Self conjugate edge remover triggered 47 times
  0:01:08.312   527M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial tip clipper
  0:01:03.803   551M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial tip clipper triggered 30322 times
  0:01:03.804   551M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial ec remover
  0:01:08.540   527M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial tip clipper triggered 21008 times
  0:01:08.540   527M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial ec remover
  0:01:14.015   558M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial ec remover triggered 574105 times
  0:01:14.024   558M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial isolated edge remover
  0:01:14.356   551M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial isolated edge remover triggered 206756 times
  0:01:14.357   468M / 8364M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification (id: simplification)
  0:01:14.357   468M / 8364M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:01:14.357   468M / 8364M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:14.357   468M / 8364M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:01:14.357   468M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:14.482   467M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 12788 times
  0:01:14.483   467M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:10.008   601M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial ec remover triggered 703940 times
  0:01:10.017   601M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial isolated edge remover
  0:01:10.124   600M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial isolated edge remover triggered 39038 times
  0:01:10.124   492M / 8079M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification (id: simplification)
  0:01:10.124   492M / 8079M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:01:10.125   492M / 8079M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:10.125   492M / 8079M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:01:10.125   492M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:10.274   491M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 19284 times
  0:01:10.276   491M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:19.154   453M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 249697 times
  0:01:19.158   453M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:19.177   453M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 91 times
  0:01:19.177   453M / 8364M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:01:19.177   453M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:19.226   449M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 1896 times
  0:01:19.226   449M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:19.227   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 27 times
  0:01:19.227   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:19.245   447M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 1529 times
  0:01:19.245   447M / 8364M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:01:19.245   447M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:19.247   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 56 times
  0:01:19.247   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:19.344   447M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 736 times
  0:01:19.345   447M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:19.357   447M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 1175 times
  0:01:19.358   447M / 8364M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:01:19.358   447M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:19.376   447M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 24 times
  0:01:19.376   447M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:19.476   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 821 times
  0:01:19.476   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:19.491   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:19.492   446M / 8364M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 2 times
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:19.492   446M / 8364M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 6
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:19.492   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:19.520   446M / 8364M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification Cleanup (id: simplification_cleanup)
  0:01:19.520   446M / 8364M INFO    General                 (simplification.cpp        : 176)   PROCEDURE == Post simplification
  0:01:19.520   446M / 8364M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:19.520   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:19.572   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 882 times
  0:01:19.573   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:19.591   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 91 times
  0:01:19.592   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:19.618   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 33 times
  0:01:19.618   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:20.237   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 1551 times
  0:01:20.238   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:20.254   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 28 times
  0:01:20.254   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:20.276   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 623 times
  0:01:20.276   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:20.296   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 16 times
  0:01:20.296   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:20.328   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 1 times
  0:01:20.328   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:20.356   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 5 times
  0:01:20.356   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:20.372   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 1 times
  0:01:20.372   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:20.395   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:20.395   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:20.940   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 5 times
  0:01:20.940   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:20.956   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 2 times
  0:01:20.956   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:20.971   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 2 times
  0:01:20.971   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:20.991   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 1 times
  0:01:20.991   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:21.022   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:21.022   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:21.052   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:01:21.052   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:21.052   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:01:21.052   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:21.077   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:21.077   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:21.620   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:01:21.621   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:21.621   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:21.621   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:21.621   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:21.621   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:21.621   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:21.621   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:21.621   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:21.621   446M / 8364M INFO    General                 (simplification.cpp        : 323)   Running Hidden EC remover (meta)
  0:01:21.650   446M / 8364M INFO    General                 (simplification.cpp        : 327)   Disrupting self-conjugate edges
  0:01:21.720   446M / 8364M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Removing isolated edges
  0:01:21.738   445M / 8364M INFO   Simplification           (parallel_processing.hpp   : 170)   Removing isolated edges triggered 1784 times
  0:01:21.738   445M / 8364M INFO    General                 (simplification.cpp        : 491)   Counting average coverage
  0:01:21.772   445M / 8364M INFO    General                 (simplification.cpp        : 497)   Average coverage = 2.58679
  0:01:21.772   445M / 8364M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:01:21.772   445M / 8364M INFO    General                 (read_converter.cpp        : 102)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K33/simplified_contigs
  0:01:21.776   448M / 8364M INFO    General                 (binary_converter.cpp      :  96)   16384 reads processed
  0:01:21.781   448M / 8364M INFO    General                 (binary_converter.cpp      :  96)   32768 reads processed
  0:01:21.790   448M / 8364M INFO    General                 (binary_converter.cpp      :  96)   65536 reads processed
  0:01:21.827   448M / 8364M INFO    General                 (binary_converter.cpp      : 111)   120392 reads written
  0:01:21.828   445M / 8364M INFO    General                 (pipeline.cpp              : 287)   SPAdes finished
  0:01:21.917     1M / 8364M INFO    General                 (main.cpp                  : 136)   Assembling time: 0 hours 1 minutes 21 seconds

===== K33 finished. 


===== K55 started. 


== Running: /usr/local/src/SPAdes/bin/spades-core /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/configs/config.info /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/configs/mda_mode.info /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/configs/meta_mode.info

  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/configs/config.info
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/configs/mda_mode.info
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/configs/meta_mode.info
  0:00:00.000     1M / 12M   INFO    General                 (memory_limit.cpp          :  48)   Memory limit set to 550 Gb
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  : 107)   Starting SPAdes, built from refs/heads/spades_3.15.2, git revision aab988a9b4986906b38396da7233bb1ee02982f2
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  : 108)   Maximum k-mer length: 128
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  : 109)   Assembling dataset (/nephele_data/outputs/asmbMetaSpades/S1_asmb/dataset.info) with K=55
  0:00:00.000     1M / 12M   INFO    General                 (main.cpp                  : 110)   Maximum # of threads to use (adjusted due to OMP capabilities): 16
  0:00:00.000     1M / 12M   INFO    General                 (pipeline.cpp              : 212)   SPAdes started
  0:00:00.000     1M / 12M   INFO    General                 (pipeline.cpp              : 225)   Starting from stage: read_conversion
  0:00:00.000     1M / 12M   INFO    General                 (pipeline.cpp              : 231)   Two-step repeat resolution enabled
  0:00:00.000     1M / 12M   INFO   GraphCore                (graph_core.hpp            : 672)   Graph created, vertex min_id: 3, edge min_id: 3
  0:00:00.000     1M / 12M   INFO   GraphCore                (graph_core.hpp            : 673)   Vertex size: 48, edge size: 40
  0:00:00.000     1M / 12M   INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:00:00.000     1M / 12M   INFO    General                 (pipeline.cpp              : 242)   Will need read mapping, kmer mapper will be attached
  0:00:00.000     1M / 12M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == Binary Read Conversion (id: read_conversion)
  0:00:00.001     1M / 12M   INFO    General                 (read_converter.cpp        :  53)   Binary reads detected
  0:00:00.002     1M / 12M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == de Bruijn graph construction (id: construction)
  0:00:00.002     1M / 12M   INFO    General                 (construction.cpp          : 118)   Contigs from previous K will be used: /nephele_data/outputs/asmbMetaSpades/S1_asmb/K33/simplified_contigs
  0:00:00.038     1M / 12M   INFO    General                 (construction.cpp          : 153)   Max read length 150
  0:00:00.038     1M / 12M   INFO    General                 (construction.cpp          : 159)   Average read length 149.628
  0:00:00.038     1M / 12M   INFO    General                 (stage.cpp                 : 117)   PROCEDURE == k+1-mer counting (id: construction:kpomer_counting)
  0:00:00.038     1M / 12M   INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:00.038     1M / 12M   INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:00.038     1M / 12M   INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:00.038     1M / 12M   INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:01:17.719   472M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 336904 times
  0:01:17.722   472M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:17.733   472M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 61 times
  0:01:17.733   472M / 8079M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:01:17.733   472M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:17.791   463M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 2531 times
  0:01:17.792   463M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:17.794   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 36 times
  0:01:17.794   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:17.810   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 1389 times
  0:01:17.810   461M / 8079M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:01:17.810   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:17.812   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 78 times
  0:01:17.812   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:17.839   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 661 times
  0:01:17.840   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:17.849   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 776 times
  0:01:17.850   461M / 8079M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:01:17.850   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:17.859   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 16 times
  0:01:17.859   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:17.888   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 220 times
  0:01:17.889   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:17.898   461M / 8079M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 2 times
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:17.898   461M / 8079M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 6
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:17.898   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:17.912   461M / 8079M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification Cleanup (id: simplification_cleanup)
  0:01:17.912   461M / 8079M INFO    General                 (simplification.cpp        : 176)   PROCEDURE == Post simplification
  0:01:17.912   461M / 8079M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:17.912   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:17.970   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 1719 times
  0:01:17.970   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:17.992   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 378 times
  0:01:17.992   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:18.004   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 10 times
  0:01:18.004   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:18.304   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 2064 times
  0:01:18.305   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:18.316   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 207 times
  0:01:18.316   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:18.329   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 346 times
  0:01:18.329   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:18.349   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 71 times
  0:01:18.349   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:18.363   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 1 times
  0:01:18.363   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:18.380   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 7 times
  0:01:18.380   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:18.391   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 37 times
  0:01:18.391   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:18.402   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:18.402   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:18.604   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 3 times
  0:01:18.604   461M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:18.613   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 8 times
  0:01:18.613   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:18.621   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 1 times
  0:01:18.621   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:18.638   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 3 times
  0:01:18.638   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:18.650   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:18.650   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:18.667   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:01:18.668   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:18.668   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:01:18.668   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:18.678   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:18.678   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:18.880   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:01:18.880   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:18.880   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:18.880   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:18.880   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:18.880   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:18.880   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:18.880   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:18.880   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:18.880   460M / 8079M INFO    General                 (simplification.cpp        : 323)   Running Hidden EC remover (meta)
  0:01:18.888   460M / 8079M INFO    General                 (simplification.cpp        : 327)   Disrupting self-conjugate edges
  0:01:18.911   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Removing isolated edges
  0:01:18.920   460M / 8079M INFO   Simplification           (parallel_processing.hpp   : 170)   Removing isolated edges triggered 450 times
  0:01:18.920   460M / 8079M INFO    General                 (simplification.cpp        : 491)   Counting average coverage
  0:01:18.931   460M / 8079M INFO    General                 (simplification.cpp        : 497)   Average coverage = 3.97853
  0:01:18.931   460M / 8079M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:01:18.931   460M / 8079M INFO    General                 (read_converter.cpp        : 102)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K33/simplified_contigs
  0:01:18.936   463M / 8079M INFO    General                 (binary_converter.cpp      :  96)   16384 reads processed
  0:01:18.941   463M / 8079M INFO    General                 (binary_converter.cpp      :  96)   32768 reads processed
  0:01:18.970   463M / 8079M INFO    General                 (binary_converter.cpp      : 111)   47928 reads written
  0:01:18.972   460M / 8079M INFO    General                 (pipeline.cpp              : 287)   SPAdes finished
  0:01:19.005     1M / 8079M INFO    General                 (main.cpp                  : 136)   Assembling time: 0 hours 1 minutes 19 seconds

===== K33 finished. 


===== K55 started. 


== Running: /usr/local/src/SPAdes/bin/spades-core /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/configs/config.info /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/configs/mda_mode.info /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/configs/meta_mode.info

  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/configs/config.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/configs/mda_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/configs/meta_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (memory_limit.cpp          :  48)   Memory limit set to 550 Gb
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 107)   Starting SPAdes, built from refs/heads/spades_3.15.2, git revision aab988a9b4986906b38396da7233bb1ee02982f2
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 108)   Maximum k-mer length: 128
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 109)   Assembling dataset (/nephele_data/outputs/asmbMetaSpades/S28_asmb/dataset.info) with K=55
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 110)   Maximum # of threads to use (adjusted due to OMP capabilities): 16
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 212)   SPAdes started
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 225)   Starting from stage: read_conversion
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 231)   Two-step repeat resolution enabled
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 672)   Graph created, vertex min_id: 3, edge min_id: 3
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 673)   Vertex size: 48, edge size: 40
  0:00:00.000     1M / 11M   INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 242)   Will need read mapping, kmer mapper will be attached
  0:00:00.000     1M / 11M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == Binary Read Conversion (id: read_conversion)
  0:00:00.001     1M / 11M   INFO    General                 (read_converter.cpp        :  53)   Binary reads detected
  0:00:00.002     1M / 11M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == de Bruijn graph construction (id: construction)
  0:00:00.002     1M / 11M   INFO    General                 (construction.cpp          : 118)   Contigs from previous K will be used: /nephele_data/outputs/asmbMetaSpades/S28_asmb/K33/simplified_contigs
  0:00:00.035     1M / 11M   INFO    General                 (construction.cpp          : 153)   Max read length 150
  0:00:00.035     1M / 11M   INFO    General                 (construction.cpp          : 159)   Average read length 149.623
  0:00:00.035     1M / 11M   INFO    General                 (stage.cpp                 : 117)   PROCEDURE == k+1-mer counting (id: construction:kpomer_counting)
  0:00:00.035     1M / 11M   INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:00.036     1M / 11M   INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:00.036     1M / 11M   INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:00.036     1M / 11M   INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:06.324  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 125)   Processed 4240068 reads
  0:00:06.331     1M / 5734M INFO    General                 (kmer_splitters.hpp        : 131)   Used 4240068 reads
  0:00:06.344     1M / 5734M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:06.825     1M / 5734M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 168523904 kmers in total.
  0:00:06.825     1M / 5734M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Extension index construction (id: construction:extension_index_construction)
  0:00:06.827     1M / 5734M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 438)   Building kmer index
  0:00:06.827     1M / 5734M INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:06.827     1M / 5734M INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:06.827     1M / 5734M INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:06.827     1M / 5734M INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:05.867  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 125)   Processed 4095196 reads
  0:00:05.873     1M / 5686M INFO    General                 (kmer_splitters.hpp        : 131)   Used 4095196 reads
  0:00:05.883     1M / 5686M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:06.303     1M / 5686M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 157562582 kmers in total.
  0:00:06.304     1M / 5686M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Extension index construction (id: construction:extension_index_construction)
  0:00:06.305     1M / 5686M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 438)   Building kmer index
  0:00:06.305     1M / 5686M INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:06.305     1M / 5686M INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:06.305     1M / 5686M INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:06.305     1M / 5686M INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:08.405  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 13039716 kmers
  0:00:09.196  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 29793565 kmers
  0:00:07.736  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 10846012 kmers
  0:00:10.134  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 46649075 kmers
  0:00:08.608  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 26429420 kmers
  0:00:11.075  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 63515683 kmers
  0:00:09.456  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 42186469 kmers
  0:00:11.992  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 80375213 kmers
  0:00:10.316  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 57958601 kmers
  0:00:12.939  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 97224981 kmers
  0:00:11.197  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 73711008 kmers
  0:00:12.066  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 89457569 kmers
  0:00:13.891  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 114059758 kmers
  0:00:12.937  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 105221621 kmers
  0:00:14.839  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 130910381 kmers
  0:00:13.790  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 120989474 kmers
  0:00:15.776  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 147752744 kmers
  0:00:14.645  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 136730073 kmers
  0:00:16.699  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 164587139 kmers
  0:00:16.929  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 168524784 kmers
  0:00:16.929  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 199)   Used 168524784 kmers.
  0:00:16.934     2M / 8314M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:15.477  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 152453368 kmers
  0:00:15.760  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 157563462 kmers
  0:00:15.760  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 199)   Used 157563462 kmers.
  0:00:15.765     2M / 8144M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:18.232     2M / 8314M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 169025638 kmers in total.
  0:00:18.232     2M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:17.055     2M / 8144M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 157843574 kmers in total.
  0:00:17.055     2M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:20.003   143M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 169025638 kmers, 122198800 bytes occupied (5.78368 bits per kmer).
  0:00:20.003   143M / 8314M INFO    General                 (kmer_index_builder.hpp    : 169)   Merging final buckets.
  0:00:18.559   117M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 157843574 kmers, 114124072 bytes occupied (5.78416 bits per kmer).
  0:00:18.559   117M / 8144M INFO    General                 (kmer_index_builder.hpp    : 169)   Merging final buckets.
  0:00:24.547   307M / 8314M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 100)   Building k-mer extensions from k+1-mers
  0:00:22.971   269M / 8144M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 100)   Building k-mer extensions from k+1-mers
  0:00:29.986   269M / 8144M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 105)   Building k-mer extensions from k+1-mers finished.
  0:00:30.085   269M / 8144M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Condensing graph (id: construction:graph_condensing)
  0:00:30.086   269M / 8144M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 354)   Extracting unbranching paths
  0:00:32.086   307M / 8314M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 105)   Building k-mer extensions from k+1-mers finished.
  0:00:32.194   307M / 8314M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Condensing graph (id: construction:graph_condensing)
  0:00:32.195   307M / 8314M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 354)   Extracting unbranching paths
  0:00:39.285   487M / 8144M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 373)   Extracting unbranching paths finished. 4175714 sequences extracted
  0:00:43.304   515M / 8314M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 373)   Extracting unbranching paths finished. 3926177 sequences extracted
  0:00:43.477   487M / 8144M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 309)   Collecting perfect loops
  0:00:44.822   487M / 8144M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 342)   Collecting perfect loops finished. 0 loops collected
  0:00:45.032   487M / 8144M INFO    General                 (debruijn_graph_constructor: 487)   Total 8351428 edges to create
  0:00:45.032   813M / 8144M INFO    General                 (debruijn_graph_constructor: 489)   Collecting link records
  0:00:47.880   515M / 8314M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 309)   Collecting perfect loops
  0:00:49.096   515M / 8314M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 342)   Collecting perfect loops finished. 0 loops collected
  0:00:49.290   515M / 8314M INFO    General                 (debruijn_graph_constructor: 487)   Total 7852354 edges to create
  0:00:49.290   820M / 8314M INFO    General                 (debruijn_graph_constructor: 489)   Collecting link records
  0:00:49.668   941M / 8144M INFO    General                 (debruijn_graph_constructor: 491)   Ordering link records
  0:00:49.736   941M / 8144M INFO    General                 (debruijn_graph_constructor: 493)   Sorting done
  0:00:49.791  1005M / 8144M INFO    General                 (debruijn_graph_constructor: 503)   Total 4456706 vertices to create
  0:00:49.792  1419M / 8144M INFO    General                 (debruijn_graph_constructor: 506)   Connecting the graph
  0:00:53.376   941M / 8314M INFO    General                 (debruijn_graph_constructor: 491)   Ordering link records
  0:00:53.456   941M / 8314M INFO    General                 (debruijn_graph_constructor: 493)   Sorting done
  0:00:53.508  1005M / 8314M INFO    General                 (debruijn_graph_constructor: 503)   Total 4427911 vertices to create
  0:00:53.508  1414M / 8314M INFO    General                 (debruijn_graph_constructor: 506)   Connecting the graph
  0:00:55.377  1162M / 8144M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Filling coverage indices (PHM) (id: construction:coverage_filling_phm)
  0:00:55.377  1162M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:58.297  1170M / 8314M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Filling coverage indices (PHM) (id: construction:coverage_filling_phm)
  0:00:58.297  1170M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:56.838  1278M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 157562582 kmers, 113921680 bytes occupied (5.7842 bits per kmer).
  0:00:57.042  1882M / 8144M INFO    General                 (coverage_hash_map_builder.:  47)   Collecting k-mer coverage information from reads, this takes a while.
  0:00:59.880  1312M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 168523904 kmers, 121836600 bytes occupied (5.78371 bits per kmer).
  0:01:00.060  1956M / 8314M INFO    General                 (coverage_hash_map_builder.:  47)   Collecting k-mer coverage information from reads, this takes a while.
  0:01:01.230  1882M / 8144M INFO    General                 (construction.cpp          : 430)   Filling coverage and flanking coverage from PHM
  0:01:04.399  1956M / 8314M INFO    General                 (construction.cpp          : 430)   Filling coverage and flanking coverage from PHM
  0:01:07.815  1882M / 8144M INFO    General                 (coverage_filling.hpp      :  82)   Processed 8351411 edges
  0:01:08.619   894M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Gap Closer (id: early_gapcloser)
  0:01:08.624   903M / 8144M INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:01:09.193   971M / 8144M INFO    General                 (gap_closer.cpp            : 101)   Total edges in tip neighborhood: 2746835 out of 8351411, length: 163453264
  0:01:09.424  1007M / 8144M INFO    General                 (edge_index.hpp            : 167)   Using small index (max_id = 8393188)
  0:01:11.361  1956M / 8314M INFO    General                 (coverage_filling.hpp      :  82)   Processed 7852326 edges
  0:01:09.940  1007M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:01:12.200   863M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Gap Closer (id: early_gapcloser)
  0:01:12.204   872M / 8314M INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:01:12.833   940M / 8314M INFO    General                 (gap_closer.cpp            : 101)   Total edges in tip neighborhood: 3089488 out of 7852326, length: 196151427
  0:01:13.079   976M / 8314M INFO    General                 (edge_index.hpp            : 167)   Using small index (max_id = 7891618)
  0:01:13.797   976M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:01:15.855  1093M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 121627583 kmers, 87847976 bytes occupied (5.77816 bits per kmer).
  0:01:16.114  2021M / 8144M INFO    General                 (edge_index_builders.hpp   : 265)   Collecting edge information from graph, this takes a while.
  0:01:20.699  1075M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 135584057 kmers, 97928248 bytes occupied (5.77816 bits per kmer).
  0:01:20.987  2112M / 8314M INFO    General                 (edge_index_builders.hpp   : 265)   Collecting edge information from graph, this takes a while.
  0:01:20.850  2093M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999835 reads processed
  0:01:22.308  1085M / 8144M INFO    General                 (gap_closer.cpp            : 452)   Initializing gap closer
  0:01:22.316  1085M / 8144M INFO   GapCloser                (gap_closer.cpp            : 359)   Closing short gaps
  0:01:25.412  2186M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999821 reads processed
  0:01:26.714  1059M / 8314M INFO    General                 (gap_closer.cpp            : 452)   Initializing gap closer
  0:01:26.718  1059M / 8314M INFO   GapCloser                (gap_closer.cpp            : 359)   Closing short gaps
  0:01:29.112  1085M / 8144M INFO   GapCloser                (gap_closer.cpp            : 393)   Closing short gaps complete: filled 577 gaps after checking 47642 candidates
  0:01:29.240  1085M / 8144M INFO    General                 (gap_closer.cpp            : 456)   Gap closer done
  0:01:29.496   894M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Raw Simplification (id: raw_simplification)
  0:01:29.496   894M / 8144M INFO    General                 (simplification.cpp        : 127)   PROCEDURE == Initial cleaning
  0:01:29.496   894M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Self conjugate edge remover
  0:01:29.653   894M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Self conjugate edge remover triggered 16 times
  0:01:29.654   894M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial tip clipper
  0:01:32.934  1059M / 8314M INFO   GapCloser                (gap_closer.cpp            : 393)   Closing short gaps complete: filled 638 gaps after checking 89113 candidates
  0:01:33.059  1059M / 8314M INFO    General                 (gap_closer.cpp            : 456)   Gap closer done
  0:01:33.314   864M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Raw Simplification (id: raw_simplification)
  0:01:33.314   864M / 8314M INFO    General                 (simplification.cpp        : 127)   PROCEDURE == Initial cleaning
  0:01:33.314   864M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Self conjugate edge remover
  0:01:33.457   864M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Self conjugate edge remover triggered 22 times
  0:01:33.457   864M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial tip clipper
  0:01:33.681   887M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial tip clipper triggered 622953 times
  0:01:33.683   887M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial ec remover
  0:01:34.443   894M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial ec remover triggered 59045 times
  0:01:34.445   894M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with low flanking coverage
  0:01:35.478   912M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with low flanking coverage triggered 93617 times
  0:01:35.480   912M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial isolated edge remover
  0:01:37.460   858M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial tip clipper triggered 597863 times
  0:01:37.462   858M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial ec remover
  0:01:36.292   891M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial isolated edge remover triggered 445696 times
  0:01:36.296   830M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Simplification (id: simplification_preliminary)
  0:01:36.296   830M / 8144M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:01:36.296   830M / 8144M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:36.296   830M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:01:36.296   830M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:38.245   868M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial ec remover triggered 61043 times
  0:01:38.247   868M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with low flanking coverage
  0:01:39.411   884M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with low flanking coverage triggered 107367 times
  0:01:39.412   884M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial isolated edge remover
  0:01:40.449   843M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial isolated edge remover triggered 597682 times
  0:01:40.454   793M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Simplification (id: simplification_preliminary)
  0:01:40.454   793M / 8314M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:01:40.454   793M / 8314M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:40.454   793M / 8314M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:01:40.454   793M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:41.241   770M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 916549 times
  0:01:41.251   770M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:44.597   746M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 730034 times
  0:01:44.606   746M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:53.031  1064M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 56809 times
  0:01:53.031  1064M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:53.071  1066M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 20 times
  0:01:53.071  1066M / 8314M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:01:53.072  1066M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:53.102  1064M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 2128 times
  0:01:53.103  1064M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:53.106  1064M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 9 times
  0:01:53.106  1064M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:53.450  1062M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 30175 times
  0:01:53.452  1062M / 8314M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:01:53.452  1062M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:53.475  1061M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 1424 times
  0:01:53.475  1061M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:54.381  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 2506 times
  0:01:54.383  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:54.391  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 542 times
  0:01:54.392  1073M / 8314M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:01:54.392  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:54.420  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 36 times
  0:01:54.420  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:54.502  1074M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 241 times
  0:01:54.503  1074M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:54.529  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:54.529  1073M / 8314M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:01:54.529  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:54.530  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:54.530  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:54.530  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:54.530  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:54.531  1073M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:54.573  1073M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Gap Closer (id: prelim_gapcloser)
  0:01:54.577  1082M / 8314M INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:01:54.642  1092M / 8314M INFO    General                 (gap_closer.cpp            : 101)   Total edges in tip neighborhood: 337187 out of 346597, length: 94195742
  0:01:54.658  1095M / 8314M INFO    General                 (edge_index.hpp            : 167)   Using small index (max_id = 7891618)
  0:01:54.802  1095M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:01:56.026  1129M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 48453110 kmers, 34998378 bytes occupied (5.77852 bits per kmer).
  0:01:56.129  1502M / 8314M INFO    General                 (edge_index_builders.hpp   : 265)   Collecting edge information from graph, this takes a while.
  0:01:57.428  1325M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 97340 times
  0:01:57.429  1325M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:57.467  1327M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 30 times
  0:01:57.468  1327M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:01:57.469  1327M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:57.524  1324M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 3925 times
  0:01:57.526  1324M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:57.562  1324M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 129 times
  0:01:57.562  1324M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:57.846  1322M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 23595 times
  0:01:57.849  1322M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:01:57.849  1322M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:57.877  1321M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 2165 times
  0:01:57.879  1321M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:58.097  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 849 times
  0:01:58.102  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:58.113  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 702 times
  0:01:58.114  1326M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:01:58.114  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:58.139  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 36 times
  0:01:58.140  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:58.201  1327M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 100 times
  0:01:58.202  1327M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:58.226  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:58.227  1326M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:01:58.228  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:58.228  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:58.229  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:58.229  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:58.229  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:58.230  1326M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:58.268  1325M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Gap Closer (id: prelim_gapcloser)
  0:01:58.273  1334M / 8144M INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:01:58.335  1344M / 8144M INFO    General                 (gap_closer.cpp            : 101)   Total edges in tip neighborhood: 240691 out of 279067, length: 69067091
  0:01:58.353  1346M / 8144M INFO    General                 (edge_index.hpp            : 167)   Using small index (max_id = 8393188)
  0:01:58.524  1346M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:01:59.803  1371M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 35039922 kmers, 25311622 bytes occupied (5.77892 bits per kmer).
  0:01:59.879  1639M / 8144M INFO    General                 (edge_index_builders.hpp   : 265)   Collecting edge information from graph, this takes a while.
  0:02:03.298  1518M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999821 reads processed
  0:02:03.593  1114M / 8314M INFO    General                 (gap_closer.cpp            : 452)   Initializing gap closer
  0:02:03.596  1114M / 8314M INFO   GapCloser                (gap_closer.cpp            : 359)   Closing short gaps
  0:02:04.039  1114M / 8314M INFO   GapCloser                (gap_closer.cpp            : 393)   Closing short gaps complete: filled 104 gaps after checking 64533 candidates
  0:02:04.095  1114M / 8314M INFO    General                 (gap_closer.cpp            : 456)   Gap closer done
  0:02:04.142  1073M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Paired Information Counting (id: late_pair_info_count_preliminary)
  0:02:05.461  1201M / 8314M INFO    General                 (graph_pack.cpp            :  67)   Index refill
  0:02:05.462  1201M / 8314M INFO    General                 (edge_index.hpp            : 156)   Using small index (max_id = 7891618)
  0:02:05.703  1201M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:02:07.668  1236M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 48830929 kmers, 35302882 bytes occupied (5.78369 bits per kmer).
  0:02:07.772  1612M / 8314M INFO    General                 (edge_index_builders.hpp   : 252)   Collecting edge information from graph, this takes a while.
  0:02:08.694  1612M / 8314M INFO    General                 (graph_pack.cpp            :  77)   Normalizing k-mer map. Total 7125818 kmers to process
  0:02:07.979  1649M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999835 reads processed
  0:02:08.209  1356M / 8144M INFO    General                 (gap_closer.cpp            : 452)   Initializing gap closer
  0:02:08.212  1356M / 8144M INFO   GapCloser                (gap_closer.cpp            : 359)   Closing short gaps
  0:02:09.984  1612M / 8314M INFO    General                 (graph_pack.cpp            :  79)   Normalizing done
  0:02:09.985  1612M / 8314M INFO    General                 (pair_info_count.cpp       : 339)   Min edge length for estimation: 900
  0:02:09.985  1612M / 8314M INFO    General                 (pair_info_count.cpp       : 350)   Estimating insert size for library #0
  0:02:09.985  1612M / 8314M INFO    General                 (pair_info_count.cpp       : 202)   Estimating insert size (takes a while)
  0:02:10.062  1885M / 8314M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:02:08.588  1356M / 8144M INFO   GapCloser                (gap_closer.cpp            : 393)   Closing short gaps complete: filled 140 gaps after checking 61995 candidates
  0:02:08.629  1356M / 8144M INFO    General                 (gap_closer.cpp            : 456)   Gap closer done
  0:02:08.664  1325M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Paired Information Counting (id: late_pair_info_count_preliminary)
  0:02:09.694  1428M / 8144M INFO    General                 (graph_pack.cpp            :  67)   Index refill
  0:02:09.696  1428M / 8144M INFO    General                 (edge_index.hpp            : 156)   Using small index (max_id = 8393188)
  0:02:09.884  1428M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:02:11.257  1456M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 38309220 kmers, 27728996 bytes occupied (5.79056 bits per kmer).
  0:02:11.341  1752M / 8144M INFO    General                 (edge_index_builders.hpp   : 252)   Collecting edge information from graph, this takes a while.
  0:02:11.995  1752M / 8144M INFO    General                 (graph_pack.cpp            :  77)   Normalizing k-mer map. Total 11984772 kmers to process
  0:02:14.249  1752M / 8144M INFO    General                 (graph_pack.cpp            :  79)   Normalizing done
  0:02:14.250  1752M / 8144M INFO    General                 (pair_info_count.cpp       : 339)   Min edge length for estimation: 900
  0:02:14.250  1752M / 8144M INFO    General                 (pair_info_count.cpp       : 350)   Estimating insert size for library #0
  0:02:14.251  1752M / 8144M INFO    General                 (pair_info_count.cpp       : 202)   Estimating insert size (takes a while)
  0:02:14.337  2025M / 8144M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:02:16.871  1885M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999821 reads processed
  0:02:18.399  1885M / 8314M INFO    General                 (pair_info_count.cpp       : 220)   Edge pairs: 280691
  0:02:18.400  1885M / 8314M INFO    General                 (pair_info_count.cpp       : 224)   131437 paired reads (13.1461% of all) aligned to long edges
  0:02:18.400  1612M / 8314M INFO    General                 (pair_info_count.cpp       : 373)     Insert size = 265.842, deviation = 28.0523, left quantile = 230, right quantile = 302, read length = 150
  0:02:18.401  1613M / 8314M INFO    General                 (pair_info_count.cpp       : 390)   Filtering data for library #0
  0:02:18.402  1613M / 8314M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:02:22.226  2025M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999835 reads processed
  0:02:25.098  1613M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999821 reads processed
  0:02:25.098  1613M / 8314M INFO    General                 (pair_info_count.cpp       : 402)   Mapping library #0
  0:02:25.099  1613M / 8314M INFO    General                 (pair_info_count.cpp       : 404)   Mapping paired reads (takes a while)
  0:02:25.099  1613M / 8314M INFO    General                 (pair_info_count.cpp       : 302)   Left insert size quantile 230, right insert size quantile 302, filtering threshold 1, rounding threshold 0
  0:02:25.103  1622M / 8314M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:02:23.754  2025M / 8144M INFO    General                 (pair_info_count.cpp       : 220)   Edge pairs: 288752
  0:02:23.755  2025M / 8144M INFO    General                 (pair_info_count.cpp       : 224)   117815 paired reads (11.7834% of all) aligned to long edges
  0:02:23.756  1752M / 8144M INFO    General                 (pair_info_count.cpp       : 373)     Insert size = 266.09, deviation = 27.9113, left quantile = 230, right quantile = 302, read length = 150
  0:02:23.757  1753M / 8144M INFO    General                 (pair_info_count.cpp       : 390)   Filtering data for library #0
  0:02:23.758  1754M / 8144M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:02:32.228  1634M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999821 reads processed
  0:02:32.251  1627M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Distance Estimation (id: distance_estimation_preliminary)
  0:02:32.252  1627M / 8314M INFO    General                 (distance_estimation.cpp   : 179)   Processing library #0
  0:02:32.253  1627M / 8314M INFO    General                 (distance_estimation.cpp   : 150)   Weight Filter Done
  0:02:32.255  1627M / 8314M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SIMPLE distance estimator
  0:02:32.436  1629M / 8314M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:02:32.437  1629M / 8314M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 401159
  0:02:32.718  1610M / 8314M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 92249
  0:02:32.724  1602M / 8314M INFO    General                 (distance_estimation.cpp   : 156)   Refining clustered pair information
  0:02:32.756  1602M / 8314M INFO    General                 (distance_estimation.cpp   : 158)   The refining of clustered pair information has been finished
  0:02:32.756  1602M / 8314M INFO    General                 (distance_estimation.cpp   : 160)   Improving paired information
  0:02:31.009  1754M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999835 reads processed
  0:02:31.010  1753M / 8144M INFO    General                 (pair_info_count.cpp       : 402)   Mapping library #0
  0:02:31.011  1753M / 8144M INFO    General                 (pair_info_count.cpp       : 404)   Mapping paired reads (takes a while)
  0:02:31.011  1753M / 8144M INFO    General                 (pair_info_count.cpp       : 302)   Left insert size quantile 230, right insert size quantile 302, filtering threshold 1, rounding threshold 0
  0:02:31.015  1763M / 8144M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:02:33.294  1603M / 8314M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 13382; contradictional = 0
  0:02:33.801  1604M / 8314M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 1203; contradictional = 0
  0:02:33.802  1604M / 8314M INFO    General                 (distance_estimation.cpp   : 104)   Filling scaffolding index
  0:02:33.803  1604M / 8314M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SMOOTHING distance estimator
  0:02:33.996  1605M / 8314M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:02:33.997  1605M / 8314M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 371853
  0:02:34.156  1613M / 8314M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 371853
  0:02:34.156  1605M / 8314M INFO    General                 (distance_estimation.cpp   : 186)   Clearing raw paired index
  0:02:34.189  1590M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Repeat Resolving (id: repeat_resolving_preliminary)
  0:02:34.191  1590M / 8314M INFO    General                 (repeat_resolving.cpp      :  74)   Setting up preliminary path extend settings
  0:02:34.192  1590M / 8314M INFO    General                 (repeat_resolving.cpp      :  87)   Using Path-Extend repeat resolving
  0:02:34.194  1590M / 8314M INFO    General                 (launcher.cpp              : 600)   ExSPAnder repeat resolving tool started
  0:02:34.779  2291M / 8314M INFO    General                 (launcher.cpp              : 418)   Creating main extenders, unique edge length = 2000
  0:02:34.782  2291M / 8314M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 121419
  0:02:34.787  2311M / 8314M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 121419
  0:02:34.863  2363M / 8314M INFO    General                 (extenders_logic.cpp       : 543)   Using 1 paired-end library
  0:02:34.864  2363M / 8314M INFO    General                 (extenders_logic.cpp       : 544)   Using 1 paired-end scaffolding library
  0:02:34.865  2363M / 8314M INFO    General                 (extenders_logic.cpp       : 545)   Using 0 single read libraries
  0:02:34.866  2363M / 8314M INFO    General                 (launcher.cpp              : 447)   Total number of extenders is 3
  0:02:34.867  2363M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 0 paths from 173104 (0%)
  0:02:34.881  2364M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 128 paths from 173104 (0%)
  0:02:34.898  2364M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 256 paths from 173104 (0%)
  0:02:34.921  2366M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 512 paths from 173104 (0%)
  0:02:34.966  2369M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 1024 paths from 173104 (0%)
  0:02:35.031  2373M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 2048 paths from 173104 (1%)
  0:02:35.123  2383M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 4096 paths from 173104 (2%)
  0:02:35.264  2400M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 8192 paths from 173104 (4%)
  0:02:35.463  2432M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 16384 paths from 173104 (9%)
  0:02:35.487  2436M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 17311 paths from 173104 (10%)
  0:02:35.768  2496M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 32768 paths from 173104 (18%)
  0:02:35.804  2503M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 34622 paths from 173104 (20%)
  0:02:36.020  2570M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 51933 paths from 173104 (30%)
  0:02:36.118  2622M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 65536 paths from 173104 (37%)
  0:02:36.145  2637M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 69244 paths from 173104 (40%)
  0:02:36.248  2704M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 86555 paths from 173104 (50%)
  0:02:36.344  2771M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 103866 paths from 173104 (60%)
  0:02:36.438  2838M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 121177 paths from 173104 (70%)
  0:02:36.491  2876M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 131072 paths from 173104 (75%)
  0:02:36.532  2907M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 138488 paths from 173104 (80%)
  0:02:36.631  2973M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 155799 paths from 173104 (90%)
  0:02:36.889  3043M / 8314M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:02:36.890  3043M / 8314M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:02:37.048  3034M / 8314M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:02:37.050  3034M / 8314M INFO    General                 (launcher.cpp              : 263)   Overlaps will not be removed
  0:02:37.297  3034M / 8314M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:02:37.299  3034M / 8314M INFO    General                 (launcher.cpp              : 454)   Closing gaps in paths
  0:02:37.919  3680M / 8314M INFO    General                 (launcher.cpp              : 484)   Gap closing completed
  0:02:38.010  3706M / 8314M INFO    General                 (launcher.cpp              : 302)   Traversing tandem repeats
  0:02:37.169  1776M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999835 reads processed
  0:02:37.197  1768M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Distance Estimation (id: distance_estimation_preliminary)
  0:02:37.198  1768M / 8144M INFO    General                 (distance_estimation.cpp   : 179)   Processing library #0
  0:02:37.198  1768M / 8144M INFO    General                 (distance_estimation.cpp   : 150)   Weight Filter Done
  0:02:37.199  1768M / 8144M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SIMPLE distance estimator
  0:02:37.371  1772M / 8144M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:02:37.372  1772M / 8144M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 373433
  0:02:39.155  3706M / 8314M INFO    General                 (launcher.cpp              : 312)   Traversed 13 loops
  0:02:39.157  3706M / 8314M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:02:39.159  3706M / 8314M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:02:39.302  3706M / 8314M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:02:39.304  3706M / 8314M INFO    General                 (launcher.cpp              : 263)   Overlaps will not be removed
  0:02:37.604  1761M / 8144M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 124776
  0:02:37.609  1753M / 8144M INFO    General                 (distance_estimation.cpp   : 156)   Refining clustered pair information
  0:02:37.654  1753M / 8144M INFO    General                 (distance_estimation.cpp   : 158)   The refining of clustered pair information has been finished
  0:02:37.655  1753M / 8144M INFO    General                 (distance_estimation.cpp   : 160)   Improving paired information
  0:02:39.520  3706M / 8314M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:02:39.522  3706M / 8314M INFO    General                 (launcher.cpp              : 664)   ExSPAnder repeat resolving tool finished
  0:02:37.928  1754M / 8144M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 9980; contradictional = 0
  0:02:39.932  2236M / 8314M INFO    General                 (repeat_resolving.cpp      :  93)   Restoring initial path extend settings
  0:02:39.935  2236M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:02:39.936  2236M / 8314M INFO    General                 (contig_output_stage.cpp   : 151)   Writing GFA graph to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/strain_graph.gfa
  0:02:38.243  1754M / 8144M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 887; contradictional = 0
  0:02:38.244  1754M / 8144M INFO    General                 (distance_estimation.cpp   : 104)   Filling scaffolding index
  0:02:38.245  1754M / 8144M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SMOOTHING distance estimator
  0:02:38.357  1754M / 8144M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:02:38.358  1754M / 8144M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 296879
  0:02:38.466  1762M / 8144M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 296879
  0:02:38.467  1754M / 8144M INFO    General                 (distance_estimation.cpp   : 186)   Clearing raw paired index
  0:02:38.500  1739M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Repeat Resolving (id: repeat_resolving_preliminary)
  0:02:38.501  1739M / 8144M INFO    General                 (repeat_resolving.cpp      :  74)   Setting up preliminary path extend settings
  0:02:38.502  1739M / 8144M INFO    General                 (repeat_resolving.cpp      :  87)   Using Path-Extend repeat resolving
  0:02:38.502  1739M / 8144M INFO    General                 (launcher.cpp              : 600)   ExSPAnder repeat resolving tool started
  0:02:40.373  2236M / 8314M INFO    General                 (contig_output_stage.cpp   : 196)   Breaking scaffolds
  0:02:38.933  2307M / 8144M INFO    General                 (launcher.cpp              : 418)   Creating main extenders, unique edge length = 2000
  0:02:38.934  2307M / 8144M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 146510
  0:02:38.939  2327M / 8144M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 146510
  0:02:38.998  2373M / 8144M INFO    General                 (extenders_logic.cpp       : 543)   Using 1 paired-end library
  0:02:38.999  2373M / 8144M INFO    General                 (extenders_logic.cpp       : 544)   Using 1 paired-end scaffolding library
  0:02:39.000  2373M / 8144M INFO    General                 (extenders_logic.cpp       : 545)   Using 0 single read libraries
  0:02:39.001  2373M / 8144M INFO    General                 (launcher.cpp              : 447)   Total number of extenders is 3
  0:02:39.001  2373M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 0 paths from 139296 (0%)
  0:02:39.010  2374M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 128 paths from 139296 (0%)
  0:02:39.016  2374M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 256 paths from 139296 (0%)
  0:02:39.024  2376M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 512 paths from 139296 (0%)
  0:02:39.037  2378M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 1024 paths from 139296 (0%)
  0:02:39.065  2382M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 2048 paths from 139296 (1%)
  0:02:39.112  2391M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 4096 paths from 139296 (2%)
  0:02:39.199  2408M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 8192 paths from 139296 (5%)
  0:02:39.315  2431M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 13930 paths from 139296 (10%)
  0:02:39.365  2441M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 16384 paths from 139296 (11%)
  0:02:39.581  2488M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 27860 paths from 139296 (20%)
  0:02:39.669  2507M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 32768 paths from 139296 (23%)
  0:02:39.822  2543M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 41790 paths from 139296 (30%)
  0:02:39.958  2597M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 55720 paths from 139296 (40%)
  0:02:40.040  2634M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 65536 paths from 139296 (47%)
  0:02:40.072  2651M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 69650 paths from 139296 (50%)
  0:02:40.165  2704M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 83580 paths from 139296 (60%)
  0:02:41.955  3010M / 8314M INFO    General                 (contig_output_stage.cpp   :  98)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/final_contigs.fasta
  0:02:40.252  2757M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 97510 paths from 139296 (70%)
  0:02:40.352  2811M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 111440 paths from 139296 (80%)
  0:02:40.512  2868M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 125370 paths from 139296 (90%)
  0:02:42.396  2236M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Second Phase Setup (id: second_phase_setup)
  0:02:42.397  2236M / 8314M INFO    General                 (second_phase_setup.cpp    :  18)   Preparing second phase
  0:02:40.699  2895M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 131072 paths from 139296 (94%)
  0:02:40.942  2923M / 8144M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:02:40.944  2923M / 8144M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:02:42.719  1488M / 8314M INFO    General                 (second_phase_setup.cpp    :  26)   Moving preliminary contigs from /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/final_contigs.fasta to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/first_pe_contigs.fasta
  0:02:42.724  1488M / 8314M INFO    General                 (second_phase_setup.cpp    :  38)   Ready to run second phase
  0:02:42.724  1488M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification (id: simplification)
  0:02:42.725  1077M / 8314M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:02:42.726  1077M / 8314M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:02:42.727  1077M / 8314M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:02:42.727  1077M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:42.755  1077M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:42.755  1077M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:41.033  2904M / 8144M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:02:41.035  2904M / 8144M INFO    General                 (launcher.cpp              : 263)   Overlaps will not be removed
  0:02:41.201  2904M / 8144M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:02:41.203  2904M / 8144M INFO    General                 (launcher.cpp              : 454)   Closing gaps in paths
  0:02:43.323  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 1793 times
  0:02:43.323  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:43.349  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:43.349  1094M / 8314M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:02:43.350  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:43.351  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 12 times
  0:02:43.351  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:43.351  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:43.352  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:43.352  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:43.352  1094M / 8314M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:02:43.353  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:43.353  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:43.353  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:43.353  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:43.354  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:43.354  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:43.354  1094M / 8314M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:02:43.354  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:43.381  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:43.382  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:43.408  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:43.409  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:41.660  3390M / 8144M INFO    General                 (launcher.cpp              : 484)   Gap closing completed
  0:02:43.434  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:43.476  1094M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Gap Closer (id: late_gapcloser)
  0:02:43.481  1103M / 8314M INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:02:41.728  3415M / 8144M INFO    General                 (launcher.cpp              : 302)   Traversing tandem repeats
  0:02:43.548  1113M / 8314M INFO    General                 (gap_closer.cpp            : 101)   Total edges in tip neighborhood: 331002 out of 335589, length: 95475449
  0:02:43.564  1116M / 8314M INFO    General                 (edge_index.hpp            : 167)   Using small index (max_id = 7891618)
  0:02:43.707  1116M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:02:42.544  3415M / 8144M INFO    General                 (launcher.cpp              : 312)   Traversed 0 loops
  0:02:42.548  3415M / 8144M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:02:42.550  3415M / 8144M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:02:42.632  3415M / 8144M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:02:42.635  3415M / 8144M INFO    General                 (launcher.cpp              : 263)   Overlaps will not be removed
  0:02:42.818  3415M / 8144M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:02:42.821  3415M / 8144M INFO    General                 (launcher.cpp              : 664)   ExSPAnder repeat resolving tool finished
  0:02:43.159  2224M / 8144M INFO    General                 (repeat_resolving.cpp      :  93)   Restoring initial path extend settings
  0:02:43.161  2224M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:02:43.163  2224M / 8144M INFO    General                 (contig_output_stage.cpp   : 151)   Writing GFA graph to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/strain_graph.gfa
  0:02:44.946  1150M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 48444337 kmers, 35020912 bytes occupied (5.78328 bits per kmer).
  0:02:45.051  1523M / 8314M INFO    General                 (edge_index_builders.hpp   : 265)   Collecting edge information from graph, this takes a while.
  0:02:43.529  2224M / 8144M INFO    General                 (contig_output_stage.cpp   : 196)   Breaking scaffolds
  0:02:44.836  2831M / 8144M INFO    General                 (contig_output_stage.cpp   :  98)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/final_contigs.fasta
  0:02:45.212  2224M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Second Phase Setup (id: second_phase_setup)
  0:02:45.214  2224M / 8144M INFO    General                 (second_phase_setup.cpp    :  18)   Preparing second phase
  0:02:45.475  1651M / 8144M INFO    General                 (second_phase_setup.cpp    :  26)   Moving preliminary contigs from /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/final_contigs.fasta to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/first_pe_contigs.fasta
  0:02:45.482  1651M / 8144M INFO    General                 (second_phase_setup.cpp    :  38)   Ready to run second phase
  0:02:45.483  1651M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification (id: simplification)
  0:02:45.484  1327M / 8144M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:02:45.485  1327M / 8144M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:02:45.486  1327M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:02:45.486  1327M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:45.511  1327M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:45.512  1327M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:46.934  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 5909 times
  0:02:46.935  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:46.957  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:46.958  1369M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:02:46.958  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:46.960  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 18 times
  0:02:46.961  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:46.961  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:46.962  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:46.962  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:46.963  1369M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:02:46.963  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:46.964  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:46.964  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:46.964  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:46.965  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:46.965  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:46.966  1369M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:02:46.966  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:46.990  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 1 times
  0:02:46.991  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:47.015  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:47.016  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:47.039  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:47.040  1369M / 8144M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:02:47.040  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:47.040  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:47.041  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:47.041  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:47.042  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:47.042  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:47.079  1369M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Gap Closer (id: late_gapcloser)
  0:02:47.084  1378M / 8144M INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:02:47.139  1388M / 8144M INFO    General                 (gap_closer.cpp            : 101)   Total edges in tip neighborhood: 235594 out of 243329, length: 69517333
  0:02:47.156  1390M / 8144M INFO    General                 (edge_index.hpp            : 167)   Using small index (max_id = 8393188)
  0:02:47.317  1390M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:02:48.608  1415M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 35017240 kmers, 25349216 bytes occupied (5.79125 bits per kmer).
  0:02:48.690  1683M / 8144M INFO    General                 (edge_index_builders.hpp   : 265)   Collecting edge information from graph, this takes a while.
  0:02:52.408  1539M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999821 reads processed
  0:02:52.666  1135M / 8314M INFO    General                 (gap_closer.cpp            : 452)   Initializing gap closer
  0:02:52.669  1135M / 8314M INFO   GapCloser                (gap_closer.cpp            : 359)   Closing short gaps
  0:02:53.103  1135M / 8314M INFO   GapCloser                (gap_closer.cpp            : 393)   Closing short gaps complete: filled 0 gaps after checking 63976 candidates
  0:02:53.149  1135M / 8314M INFO    General                 (gap_closer.cpp            : 456)   Gap closer done
  0:02:53.195  1094M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification Cleanup (id: simplification_cleanup)
  0:02:53.195  1094M / 8314M INFO    General                 (simplification.cpp        : 176)   PROCEDURE == Post simplification
  0:02:53.196  1094M / 8314M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:02:53.196  1094M / 8314M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:02:53.196  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:02:53.228  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 127 times
  0:02:53.228  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:02:53.259  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 53 times
  0:02:53.260  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:02:53.315  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 3 times
  0:02:53.316  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:02:54.119  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 45 times
  0:02:54.120  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:54.150  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 12 times
  0:02:54.150  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:02:54.184  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 321 times
  0:02:54.185  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:54.214  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 2 times
  0:02:54.214  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final bulge remover
  0:02:54.261  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Final bulge remover triggered 9 times
  0:02:54.262  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:02:54.288  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:02:54.289  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:02:54.318  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:02:54.318  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:02:54.349  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 2 times
  0:02:54.350  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:02:54.405  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 1 times
  0:02:54.405  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:02:55.178  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 2 times
  0:02:55.179  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:55.209  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 3 times
  0:02:55.209  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:02:55.239  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 1 times
  0:02:55.239  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:55.268  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:55.268  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final bulge remover
  0:02:55.298  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Final bulge remover triggered 0 times
  0:02:55.299  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:02:55.325  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:02:55.326  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:02:55.355  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:02:55.355  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:02:55.355  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:02:55.356  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:02:55.410  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:02:55.411  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:02:56.183  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:02:56.184  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:56.184  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:56.184  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:02:56.184  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:02:56.185  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:56.185  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:56.185  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final bulge remover
  0:02:56.186  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Final bulge remover triggered 0 times
  0:02:56.186  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:02:56.186  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:02:56.186  1095M / 8314M INFO    General                 (simplification.cpp        : 323)   Running Hidden EC remover (meta)
  0:02:56.211  1095M / 8314M INFO    General                 (simplification.cpp        : 327)   Disrupting self-conjugate edges
  0:02:56.327  1095M / 8314M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Removing isolated edges
  0:02:56.382  1094M / 8314M INFO   Simplification           (parallel_processing.hpp   : 170)   Removing isolated edges triggered 16364 times
  0:02:56.383  1094M / 8314M INFO    General                 (simplification.cpp        : 491)   Counting average coverage
  0:02:56.448  1094M / 8314M INFO    General                 (simplification.cpp        : 497)   Average coverage = 1.53849
  0:02:56.448  1094M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Mismatch Correction (id: mismatch_correction)
  0:02:56.449  1094M / 8314M INFO    General                 (graph_pack.cpp            :  67)   Index refill
  0:02:56.449  1094M / 8314M INFO    General                 (edge_index.hpp            : 156)   Using small index (max_id = 7891618)
  0:02:56.677  1094M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:02:58.413  1127M / 8314M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 46514460 kmers, 33623966 bytes occupied (5.78297 bits per kmer).
  0:02:58.514  1483M / 8314M INFO    General                 (edge_index_builders.hpp   : 252)   Collecting edge information from graph, this takes a while.
  0:02:57.105  1693M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999835 reads processed
  0:02:57.310  1400M / 8144M INFO    General                 (gap_closer.cpp            : 452)   Initializing gap closer
  0:02:57.312  1400M / 8144M INFO   GapCloser                (gap_closer.cpp            : 359)   Closing short gaps
  0:02:59.226  1483M / 8314M INFO    General                 (graph_pack.cpp            :  77)   Normalizing k-mer map. Total 7507288 kmers to process
  0:02:57.669  1400M / 8144M INFO   GapCloser                (gap_closer.cpp            : 393)   Closing short gaps complete: filled 0 gaps after checking 61236 candidates
  0:02:57.705  1400M / 8144M INFO    General                 (gap_closer.cpp            : 456)   Gap closer done
  0:02:57.737  1369M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification Cleanup (id: simplification_cleanup)
  0:02:57.738  1369M / 8144M INFO    General                 (simplification.cpp        : 176)   PROCEDURE == Post simplification
  0:02:57.739  1369M / 8144M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:02:57.739  1369M / 8144M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:02:57.739  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:02:57.773  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 260 times
  0:02:57.774  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:02:57.798  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 4 times
  0:02:57.799  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:02:57.836  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:02:57.837  1369M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:02:58.607  1374M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 242 times
  0:02:58.607  1374M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:58.631  1374M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 3 times
  0:02:58.632  1374M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:02:58.664  1374M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 357 times
  0:02:58.665  1374M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:58.691  1374M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 6 times
  0:02:58.692  1374M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final bulge remover
  0:03:00.526  1483M / 8314M INFO    General                 (graph_pack.cpp            :  79)   Normalizing done
  0:03:00.527  1483M / 8314M INFO    General                 (mismatch_correction.cpp   : 400)   Collect potential mismatches
  0:02:58.837  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Final bulge remover triggered 73 times
  0:02:58.837  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:02:58.858  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:02:58.859  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:02:58.881  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 2 times
  0:02:58.882  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:02:58.904  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:02:58.905  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:02:58.941  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:02:58.942  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:02:59.536  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 10 times
  0:02:59.537  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:59.561  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 6 times
  0:02:59.562  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:02:59.585  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 7 times
  0:02:59.586  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:59.610  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:59.611  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final bulge remover
  0:02:59.648  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Final bulge remover triggered 2 times
  0:02:59.649  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:02:59.670  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:02:59.671  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:02:59.694  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:02:59.695  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:02:59.696  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:02:59.696  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:02:59.735  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:02:59.736  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:03:01.609  1486M / 8314M INFO    General                 (mismatch_correction.cpp   : 193)   Total 27082 edges (out of 300434) with 174006 potential mismatch positions (6.42515 positions per edge)
  0:03:01.610  1486M / 8314M INFO    General                 (mismatch_correction.cpp   : 402)   Potential mismatches collected
  0:03:00.339  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:03:00.340  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:03:00.340  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:03:00.341  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:03:00.341  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:03:00.342  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:03:00.342  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:03:00.342  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final bulge remover
  0:03:00.343  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Final bulge remover triggered 0 times
  0:03:00.343  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:03:00.344  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:03:00.344  1376M / 8144M INFO    General                 (simplification.cpp        : 323)   Running Hidden EC remover (meta)
  0:03:00.364  1376M / 8144M INFO    General                 (simplification.cpp        : 327)   Disrupting self-conjugate edges
  0:03:00.451  1376M / 8144M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Removing isolated edges
  0:03:00.496  1375M / 8144M INFO   Simplification           (parallel_processing.hpp   : 170)   Removing isolated edges triggered 14288 times
  0:03:00.497  1375M / 8144M INFO    General                 (simplification.cpp        : 491)   Counting average coverage
  0:03:00.545  1375M / 8144M INFO    General                 (simplification.cpp        : 497)   Average coverage = 2.06473
  0:03:00.546  1375M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Mismatch Correction (id: mismatch_correction)
  0:03:00.547  1375M / 8144M INFO    General                 (graph_pack.cpp            :  67)   Index refill
  0:03:00.547  1375M / 8144M INFO    General                 (edge_index.hpp            : 156)   Using small index (max_id = 8393188)
  0:03:00.718  1375M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:03:02.026  1401M / 8144M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 35853239 kmers, 25942298 bytes occupied (5.78855 bits per kmer).
  0:03:02.105  1678M / 8144M INFO    General                 (edge_index_builders.hpp   : 252)   Collecting edge information from graph, this takes a while.
  0:03:02.728  1678M / 8144M INFO    General                 (graph_pack.cpp            :  77)   Normalizing k-mer map. Total 13033498 kmers to process
  0:03:05.190  1678M / 8144M INFO    General                 (graph_pack.cpp            :  79)   Normalizing done
  0:03:05.191  1678M / 8144M INFO    General                 (mismatch_correction.cpp   : 400)   Collect potential mismatches
  0:03:07.500  1680M / 8144M INFO    General                 (mismatch_correction.cpp   : 193)   Total 18048 edges (out of 209992) with 329188 potential mismatch positions (18.2396 positions per edge)
  0:03:07.502  1680M / 8144M INFO    General                 (mismatch_correction.cpp   : 402)   Potential mismatches collected
  0:03:10.019  1491M / 8314M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 200000 reads
  0:03:10.078  1496M / 8314M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 400000 reads
  0:03:10.121  1501M / 8314M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 600000 reads
  0:03:10.136  1507M / 8314M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 800000 reads
  0:03:10.179  1512M / 8314M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 1000000 reads
  0:03:10.186  1517M / 8314M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 1200000 reads
  0:03:10.461  1522M / 8314M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 2200000 reads
  0:03:13.901  1600M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 3999284 reads processed
  0:03:15.741  1503M / 8314M INFO    General                 (mismatch_correction.cpp   : 395)   All edges processed
  0:03:15.752  1486M / 8314M INFO    General                 (mismatch_correction.cpp   : 450)   Corrected 622 nucleotides
  0:03:15.753  1486M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:03:15.753  1486M / 8314M INFO    General                 (contig_output.hpp         :  16)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/before_rr.fasta
  0:03:16.505  1486M / 8314M INFO    General                 (contig_output_stage.cpp   : 151)   Writing GFA graph to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/assembly_graph_after_simplification.gfa
  0:03:16.900  1486M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Paired Information Counting (id: late_pair_info_count)
  0:03:16.249  1696M / 8144M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 200000 reads
  0:03:18.070  1597M / 8314M INFO    General                 (graph_pack.cpp            :  77)   Normalizing k-mer map. Total 7542058 kmers to process
  0:03:16.347  1713M / 8144M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 400000 reads
  0:03:16.381  1729M / 8144M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 600000 reads
  0:03:16.689  1745M / 8144M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 800000 reads
  0:03:16.713  1761M / 8144M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 1000000 reads
  0:03:16.749  1777M / 8144M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 1200000 reads
  0:03:16.848  1794M / 8144M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 2200000 reads
  0:03:19.500  1597M / 8314M INFO    General                 (graph_pack.cpp            :  79)   Normalizing done
  0:03:19.500  1597M / 8314M INFO    General                 (pair_info_count.cpp       : 339)   Min edge length for estimation: 900
  0:03:19.501  1597M / 8314M INFO    General                 (pair_info_count.cpp       : 350)   Estimating insert size for library #0
  0:03:19.501  1597M / 8314M INFO    General                 (pair_info_count.cpp       : 202)   Estimating insert size (takes a while)
  0:03:19.565  1870M / 8314M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:19.552  1984M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 3999340 reads processed
  0:03:22.478  1708M / 8144M INFO    General                 (mismatch_correction.cpp   : 395)   All edges processed
  0:03:22.485  1679M / 8144M INFO    General                 (mismatch_correction.cpp   : 450)   Corrected 275 nucleotides
  0:03:22.486  1679M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:03:22.487  1679M / 8144M INFO    General                 (contig_output.hpp         :  16)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/before_rr.fasta
  0:03:23.027  1679M / 8144M INFO    General                 (contig_output_stage.cpp   : 151)   Writing GFA graph to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/assembly_graph_after_simplification.gfa
  0:03:23.319  1679M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Paired Information Counting (id: late_pair_info_count)
  0:03:24.104  1757M / 8144M INFO    General                 (graph_pack.cpp            :  77)   Normalizing k-mer map. Total 13051094 kmers to process
  0:03:26.199  1870M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999821 reads processed
  0:03:27.728  1870M / 8314M INFO    General                 (pair_info_count.cpp       : 220)   Edge pairs: 209484
  0:03:27.728  1870M / 8314M INFO    General                 (pair_info_count.cpp       : 224)   146348 paired reads (14.6374% of all) aligned to long edges
  0:03:27.729  1597M / 8314M INFO    General                 (pair_info_count.cpp       : 373)     Insert size = 265.854, deviation = 28.0205, left quantile = 230, right quantile = 302, read length = 150
  0:03:27.729  1598M / 8314M INFO    General                 (pair_info_count.cpp       : 390)   Filtering data for library #0
  0:03:27.730  1598M / 8314M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:26.445  1757M / 8144M INFO    General                 (graph_pack.cpp            :  79)   Normalizing done
  0:03:26.446  1757M / 8144M INFO    General                 (pair_info_count.cpp       : 339)   Min edge length for estimation: 900
  0:03:26.447  1757M / 8144M INFO    General                 (pair_info_count.cpp       : 350)   Estimating insert size for library #0
  0:03:26.447  1757M / 8144M INFO    General                 (pair_info_count.cpp       : 202)   Estimating insert size (takes a while)
  0:03:26.490  2029M / 8144M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:35.332  1598M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999821 reads processed
  0:03:35.333  1598M / 8314M INFO    General                 (pair_info_count.cpp       : 402)   Mapping library #0
  0:03:35.334  1598M / 8314M INFO    General                 (pair_info_count.cpp       : 404)   Mapping paired reads (takes a while)
  0:03:35.334  1598M / 8314M INFO    General                 (pair_info_count.cpp       : 302)   Left insert size quantile 230, right insert size quantile 302, filtering threshold 1, rounding threshold 0
  0:03:35.338  1607M / 8314M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:34.722  2029M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999835 reads processed
  0:03:36.255  2029M / 8144M INFO    General                 (pair_info_count.cpp       : 220)   Edge pairs: 177742
  0:03:36.257  2029M / 8144M INFO    General                 (pair_info_count.cpp       : 224)   259667 paired reads (25.971% of all) aligned to long edges
  0:03:36.257  1757M / 8144M INFO    General                 (pair_info_count.cpp       : 373)     Insert size = 266.626, deviation = 27.9028, left quantile = 230, right quantile = 302, read length = 150
  0:03:36.258  1757M / 8144M INFO    General                 (pair_info_count.cpp       : 390)   Filtering data for library #0
  0:03:36.259  1757M / 8144M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
Removing temporary output file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S28_klog.txt.
[Tue Oct 24 17:26:07 2023]
Finished job 13.
10 of 139 steps (7%) done

[Tue Oct 24 17:26:07 2023]
rule run_kraken2_classification:
    input: /nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S6_klog.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S6_taxREPORT.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S6_classLOG.txt
    jobid: 8
    wildcards: sample=S6
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --gzip-compressed --threads 16 --confidence 0.05 --db /mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 --memory-mapping --paired /nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz /nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz --output /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S6_klog.txt --report /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S6_taxREPORT.txt 2>> /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S6_classLOG.txt
  0:03:42.557  1616M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999821 reads processed
  0:03:42.584  1608M / 8314M INFO    General                 (pair_info_count.cpp       : 346)   Mapping contigs library #1
  0:03:42.584  1608M / 8314M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:43.439  1757M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999835 reads processed
  0:03:43.440  1757M / 8144M INFO    General                 (pair_info_count.cpp       : 402)   Mapping library #0
  0:03:43.440  1757M / 8144M INFO    General                 (pair_info_count.cpp       : 404)   Mapping paired reads (takes a while)
  0:03:43.441  1757M / 8144M INFO    General                 (pair_info_count.cpp       : 302)   Left insert size quantile 230, right insert size quantile 302, filtering threshold 1, rounding threshold 0
  0:03:43.445  1766M / 8144M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:47.227  1632M / 8314M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 164231 reads processed
  0:03:47.227  1632M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Distance Estimation (id: distance_estimation)
  0:03:47.228  1632M / 8314M INFO    General                 (distance_estimation.cpp   : 179)   Processing library #0
  0:03:47.228  1632M / 8314M INFO    General                 (distance_estimation.cpp   : 150)   Weight Filter Done
  0:03:47.228  1632M / 8314M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SIMPLE distance estimator
  0:03:47.341  1632M / 8314M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:03:47.342  1632M / 8314M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 310154
  0:03:47.575  1617M / 8314M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 55736
  0:03:47.580  1609M / 8314M INFO    General                 (distance_estimation.cpp   : 156)   Refining clustered pair information
  0:03:47.603  1609M / 8314M INFO    General                 (distance_estimation.cpp   : 158)   The refining of clustered pair information has been finished
  0:03:47.604  1609M / 8314M INFO    General                 (distance_estimation.cpp   : 160)   Improving paired information
  0:03:47.968  1610M / 8314M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 3181; contradictional = 0
  0:03:48.343  1610M / 8314M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 176; contradictional = 0
  0:03:48.344  1610M / 8314M INFO    General                 (distance_estimation.cpp   : 104)   Filling scaffolding index
  0:03:48.344  1610M / 8314M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SMOOTHING distance estimator
  0:03:48.472  1611M / 8314M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:03:48.473  1611M / 8314M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 322782
  0:03:48.616  1619M / 8314M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 322782
  0:03:48.617  1611M / 8314M INFO    General                 (distance_estimation.cpp   : 186)   Clearing raw paired index
  0:03:48.643  1600M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Repeat Resolving (id: repeat_resolving)
  0:03:48.644  1600M / 8314M INFO    General                 (repeat_resolving.cpp      :  87)   Using Path-Extend repeat resolving
  0:03:48.645  1600M / 8314M INFO    General                 (launcher.cpp              : 600)   ExSPAnder repeat resolving tool started
  0:03:49.128  2211M / 8314M INFO    General                 (launcher.cpp              : 418)   Creating main extenders, unique edge length = 2000
  0:03:49.137  2251M / 8314M INFO    General                 (launcher.cpp              : 342)   filling path container
  0:03:49.157  2256M / 8314M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 62450
  0:03:49.160  2276M / 8314M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 62450
Removing temporary output file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S6_klog.txt.
  0:03:49.230  2328M / 8314M INFO    General                 (extenders_logic.cpp       :  47)   resolvable_repeat_length_bound set to 10000
[Tue Oct 24 17:26:18 2023]
Finished job 8.
11 of 139 steps (8%) done

[Tue Oct 24 17:26:18 2023]
rule run_metaspades:
    input: /nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffolds.fasta
    jobid: 25
    wildcards: sample=S6
    threads: 16

python3 /usr/local/src/SPAdes/bin/metaspades.py -1 /nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz -2 /nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz --memory 550 --tmp-dir /nephele_data/tmp/ -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/ -t 16 --only-assembler
  0:03:49.312  2362M / 8314M INFO    General                 (extenders_logic.cpp       : 543)   Using 1 paired-end library
  0:03:49.313  2362M / 8314M INFO    General                 (extenders_logic.cpp       : 544)   Using 1 paired-end scaffolding library
Command line: /usr/local/src/SPAdes/bin/metaspades.py	-1	/nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz	-2	/nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz	--memory	550	--tmp-dir	/nephele_data/tmp	-o	/nephele_data/outputs/asmbMetaSpades/S6_asmb	-t	16	--only-assembler	

System information:
  0:03:49.314  2362M / 8314M INFO    General                 (extenders_logic.cpp       : 545)   Using 1 single read library
  SPAdes version: 3.15.2
  Python version: 3.7.3
  OS: Linux-4.19.0-20-cloud-amd64-x86_64-with-debian-10.12

Output dir: /nephele_data/outputs/asmbMetaSpades/S6_asmb
Mode: ONLY assembling (without read error correction)
Debug mode is turned OFF

Dataset parameters:
  Metagenomic mode
  Reads:
    Library number: 1, library type: paired-end
      orientation: fr
      left reads: ['/nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz']
      right reads: ['/nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz']
      interlaced reads: not specified
      single reads: not specified
      merged reads: not specified
Assembly parameters:
  k: [21, 33, 55]
  Repeat resolution is enabled
  Mismatch careful mode is turned OFF
  MismatchCorrector will be SKIPPED
  Coverage cutoff is turned OFF
Other parameters:
  Dir for temp files: /nephele_data/tmp
  Threads: 16
  Memory limit (in Gb): 550


======= SPAdes pipeline started. Log can be found here: /nephele_data/outputs/asmbMetaSpades/S6_asmb/spades.log

  0:03:49.390  2362M / 8314M INFO    General                 (launcher.cpp              : 385)   Filling backbone edges for long reads scaffolding...
  0:03:49.391  2362M / 8314M INFO    General                 (launcher.cpp              : 387)    with long reads paths
  0:03:49.391  2362M / 8314M INFO    General                 (launcher.cpp              : 396)   Removing fake unique with paired-end libs
  0:03:49.392  2362M / 8314M INFO    General                 (launcher.cpp              : 407)   0 unique edges
  0:03:49.393  2362M / 8314M INFO    General                 (extenders_logic.cpp       : 446)   Using 0 long reads scaffolding libraries
  0:03:49.393  2362M / 8314M INFO    General                 (extenders_logic.cpp       : 456)   Using additional coordinated coverage extender
  0:03:49.398  2382M / 8314M INFO    General                 (launcher.cpp              : 447)   Total number of extenders is 5
  0:03:49.399  2382M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 0 paths from 150118 (0%)
  0:03:49.409  2382M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 128 paths from 150118 (0%)
  0:03:49.419  2383M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 256 paths from 150118 (0%)
  0:03:49.435  2384M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 512 paths from 150118 (0%)
  0:03:49.464  2387M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 1024 paths from 150118 (0%)
  0:03:49.513  2391M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 2048 paths from 150118 (1%)
/nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz: max reads length: 150
  0:03:49.588  2400M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 4096 paths from 150118 (2%)
  0:03:49.709  2417M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 8192 paths from 150118 (5%)
/nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz: max reads length: 150

Reads length: 150


===== Before start started. 


===== Assembling started. 


===== K21 started. 


== Running: /usr/local/src/SPAdes/bin/spades-core /nephele_data/outputs/asmbMetaSpades/S6_asmb/K21/configs/config.info /nephele_data/outputs/asmbMetaSpades/S6_asmb/K21/configs/mda_mode.info /nephele_data/outputs/asmbMetaSpades/S6_asmb/K21/configs/meta_mode.info

  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K21/configs/config.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K21/configs/mda_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K21/configs/meta_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (memory_limit.cpp          :  48)   Memory limit set to 550 Gb
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 107)   Starting SPAdes, built from refs/heads/spades_3.15.2, git revision aab988a9b4986906b38396da7233bb1ee02982f2
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 108)   Maximum k-mer length: 128
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 109)   Assembling dataset (/nephele_data/outputs/asmbMetaSpades/S6_asmb/dataset.info) with K=21
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 110)   Maximum # of threads to use (adjusted due to OMP capabilities): 16
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 212)   SPAdes started
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 225)   Starting from stage: read_conversion
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 231)   Two-step repeat resolution disabled
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 672)   Graph created, vertex min_id: 3, edge min_id: 3
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 673)   Vertex size: 48, edge size: 40
  0:00:00.000     1M / 11M   INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:00:00.000     1M / 11M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == Binary Read Conversion (id: read_conversion)
  0:00:00.001     1M / 11M   INFO    General                 (read_converter.cpp        :  72)   Converting reads to binary format for library #0 (takes a while)
  0:00:00.001     1M / 11M   INFO    General                 (read_converter.cpp        :  73)   Converting paired reads
  0:03:49.867  2443M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 15012 paths from 150118 (10%)
  0:03:49.896  2449M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 16384 paths from 150118 (10%)
  0:03:50.145  2501M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 30024 paths from 150118 (20%)
  0:03:50.195  2512M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 32768 paths from 150118 (21%)
  0:03:50.390  2559M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 45036 paths from 150118 (30%)
  0:00:00.656    21M / 86M   INFO    General                 (binary_converter.cpp      :  96)   16384 reads processed
  0:00:00.674    21M / 89M   INFO    General                 (binary_converter.cpp      :  96)   32768 reads processed
  0:00:00.708    21M / 93M   INFO    General                 (binary_converter.cpp      :  96)   65536 reads processed
  0:03:50.508  2616M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 60048 paths from 150118 (40%)
  0:03:50.551  2637M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 65536 paths from 150118 (43%)
  0:03:50.620  2674M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 75060 paths from 150118 (50%)
  0:03:50.716  2732M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 90072 paths from 150118 (60%)
  0:00:00.970    12M / 126M  INFO    General                 (binary_converter.cpp      :  96)   131072 reads processed
  0:03:50.821  2790M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 105084 paths from 150118 (70%)
  0:03:50.916  2848M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 120096 paths from 150118 (80%)
  0:03:50.985  2891M / 8314M INFO    General                 (path_extenders.cpp        :  34)   Processed 131072 paths from 150118 (87%)
  0:03:51.011  2906M / 8314M INFO    General                 (path_extenders.cpp        :  36)   Processed 135108 paths from 150118 (90%)
  0:03:51.117  2965M / 8314M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:03:51.118  2965M / 8314M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:00:01.387     3M / 158M  INFO    General                 (binary_converter.cpp      :  96)   262144 reads processed
  0:03:51.216  2964M / 8314M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:03:51.217  2964M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  60)   Removing overlaps
  0:03:51.218  2964M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  70)   Marking overlaps
  0:03:51.219  2964M / 8314M INFO   OverlapRemover           (overlap_remover.hpp       : 116)   Marking start/end overlaps
  0:03:51.390  2964M / 8314M INFO   OverlapRemover           (overlap_remover.hpp       : 119)   Marking remaining overlaps
  0:03:49.660  1774M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999835 reads processed
  0:03:49.681  1765M / 8144M INFO    General                 (pair_info_count.cpp       : 346)   Mapping contigs library #1
  0:03:49.682  1765M / 8144M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:51.558  2965M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  73)   Splitting paths
  0:03:51.583  2975M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  78)   Deduplicating paths
  0:03:51.664  2965M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  80)   Overlaps removed
  0:03:51.862  2965M / 8314M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:03:51.864  2965M / 8314M INFO    General                 (launcher.cpp              : 454)   Closing gaps in paths
  0:00:02.174     0M / 206M  INFO    General                 (binary_converter.cpp      :  96)   524288 reads processed
  0:03:52.374  3530M / 8314M INFO    General                 (launcher.cpp              : 484)   Gap closing completed
  0:03:52.444  3554M / 8314M INFO    General                 (launcher.cpp              : 302)   Traversing tandem repeats
  0:03:53.338  3554M / 8314M INFO    General                 (launcher.cpp              : 312)   Traversed 1 loops
  0:03:53.340  3554M / 8314M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:03:53.341  3554M / 8314M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:03:53.418  3554M / 8314M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:03:53.420  3554M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  60)   Removing overlaps
  0:03:53.421  3554M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  70)   Marking overlaps
  0:03:53.423  3554M / 8314M INFO   OverlapRemover           (overlap_remover.hpp       : 116)   Marking start/end overlaps
  0:00:03.748     0M / 239M  INFO    General                 (binary_converter.cpp      : 111)   999484 reads written
  0:00:03.748     0M / 239M  INFO    General                 (read_converter.cpp        :  81)   Converting single reads
  0:00:03.748     0M / 239M  INFO    General                 (binary_converter.cpp      : 111)   0 reads written
  0:00:03.748     0M / 239M  INFO    General                 (read_converter.cpp        :  87)   Converting merged reads
  0:00:03.748     0M / 239M  INFO    General                 (binary_converter.cpp      : 111)   0 reads written
  0:00:03.759     1M / 239M  INFO   StageManager             (stage.cpp                 : 185)   STAGE == de Bruijn graph construction (id: construction)
  0:00:03.760     1M / 239M  INFO    General                 (construction.cpp          : 153)   Max read length 150
  0:00:03.760     1M / 239M  INFO    General                 (construction.cpp          : 159)   Average read length 149.609
  0:00:03.760     1M / 239M  INFO    General                 (stage.cpp                 : 117)   PROCEDURE == k+1-mer counting (id: construction:kpomer_counting)
  0:00:03.760     1M / 239M  INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:03.760     1M / 239M  INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:03.760     1M / 239M  INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:03.760     1M / 239M  INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 419430
  0:03:53.567  3554M / 8314M INFO   OverlapRemover           (overlap_remover.hpp       : 119)   Marking remaining overlaps
  0:03:53.720  3554M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  73)   Splitting paths
  0:03:53.739  3555M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  78)   Deduplicating paths
  0:03:53.826  3554M / 8314M INFO   PEResolver               (pe_resolver.cpp           :  80)   Overlaps removed
  0:03:54.055  3554M / 8314M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:03:54.057  3554M / 8314M INFO    General                 (launcher.cpp              : 664)   ExSPAnder repeat resolving tool finished
  0:03:54.433  2165M / 8314M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:03:54.434  2165M / 8314M INFO    General                 (contig_output.hpp         :  16)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/before_rr.fasta
  0:03:55.200  2165M / 8314M INFO    General                 (contig_output_stage.cpp   : 151)   Writing GFA graph to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/assembly_graph_with_scaffolds.gfa
  0:03:55.601  2165M / 8314M INFO    General                 (contig_output_stage.cpp   : 165)   Outputting FastG graph to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/assembly_graph.fastg
  0:03:53.989  1782M / 8144M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 123814 reads processed
  0:03:53.990  1782M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Distance Estimation (id: distance_estimation)
  0:03:53.991  1782M / 8144M INFO    General                 (distance_estimation.cpp   : 179)   Processing library #0
  0:03:53.992  1782M / 8144M INFO    General                 (distance_estimation.cpp   : 150)   Weight Filter Done
  0:03:53.992  1782M / 8144M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SIMPLE distance estimator
  0:03:54.096  1783M / 8144M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:03:54.097  1783M / 8144M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 233588
  0:03:54.263  1772M / 8144M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 51646
  0:03:54.267  1768M / 8144M INFO    General                 (distance_estimation.cpp   : 156)   Refining clustered pair information
  0:03:54.287  1768M / 8144M INFO    General                 (distance_estimation.cpp   : 158)   The refining of clustered pair information has been finished
  0:03:54.288  1768M / 8144M INFO    General                 (distance_estimation.cpp   : 160)   Improving paired information
  0:03:54.514  1768M / 8144M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 3454; contradictional = 0
  0:03:54.722  1768M / 8144M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 543; contradictional = 0
  0:03:54.723  1768M / 8144M INFO    General                 (distance_estimation.cpp   : 104)   Filling scaffolding index
  0:03:54.724  1768M / 8144M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SMOOTHING distance estimator
  0:03:54.839  1769M / 8144M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:03:54.840  1769M / 8144M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 226566
  0:03:54.936  1773M / 8144M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 226566
  0:03:54.937  1769M / 8144M INFO    General                 (distance_estimation.cpp   : 186)   Clearing raw paired index
  0:03:54.959  1760M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Repeat Resolving (id: repeat_resolving)
  0:03:54.960  1760M / 8144M INFO    General                 (repeat_resolving.cpp      :  87)   Using Path-Extend repeat resolving
  0:03:54.960  1760M / 8144M INFO    General                 (launcher.cpp              : 600)   ExSPAnder repeat resolving tool started
  0:03:55.264  2182M / 8144M INFO    General                 (launcher.cpp              : 418)   Creating main extenders, unique edge length = 2000
  0:03:55.266  2202M / 8144M INFO    General                 (launcher.cpp              : 342)   filling path container
  0:03:55.278  2207M / 8144M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 59640
  0:03:55.279  2217M / 8144M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 59640
  0:03:57.035  2165M / 8314M INFO    General                 (contig_output_stage.cpp   : 196)   Breaking scaffolds
  0:03:55.322  2243M / 8144M INFO    General                 (extenders_logic.cpp       :  47)   resolvable_repeat_length_bound set to 10000
  0:03:55.385  2262M / 8144M INFO    General                 (extenders_logic.cpp       : 543)   Using 1 paired-end library
  0:03:55.386  2262M / 8144M INFO    General                 (extenders_logic.cpp       : 544)   Using 1 paired-end scaffolding library
  0:03:55.387  2262M / 8144M INFO    General                 (extenders_logic.cpp       : 545)   Using 1 single read library
  0:03:55.447  2262M / 8144M INFO    General                 (launcher.cpp              : 385)   Filling backbone edges for long reads scaffolding...
  0:03:55.448  2262M / 8144M INFO    General                 (launcher.cpp              : 387)    with long reads paths
  0:03:55.449  2262M / 8144M INFO    General                 (launcher.cpp              : 396)   Removing fake unique with paired-end libs
  0:03:55.450  2262M / 8144M INFO    General                 (launcher.cpp              : 407)   0 unique edges
  0:03:55.451  2262M / 8144M INFO    General                 (extenders_logic.cpp       : 446)   Using 0 long reads scaffolding libraries
  0:03:55.451  2262M / 8144M INFO    General                 (extenders_logic.cpp       : 456)   Using additional coordinated coverage extender
  0:03:55.452  2272M / 8144M INFO    General                 (launcher.cpp              : 447)   Total number of extenders is 5
  0:03:55.453  2272M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 0 paths from 104889 (0%)
  0:03:55.478  2274M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 128 paths from 104889 (0%)
  0:03:55.487  2275M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 256 paths from 104889 (0%)
  0:03:55.496  2276M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 512 paths from 104889 (0%)
  0:03:55.512  2278M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 1024 paths from 104889 (0%)
  0:03:55.539  2283M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 2048 paths from 104889 (1%)
  0:03:55.588  2291M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 4096 paths from 104889 (3%)
  0:03:55.678  2308M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 8192 paths from 104889 (7%)
  0:03:55.730  2317M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 10489 paths from 104889 (10%)
  0:03:55.851  2341M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 16384 paths from 104889 (15%)
  0:03:55.946  2360M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 20978 paths from 104889 (20%)
  0:03:56.146  2401M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 31467 paths from 104889 (30%)
  0:03:56.172  2406M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 32768 paths from 104889 (31%)
  0:03:56.333  2442M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 41956 paths from 104889 (40%)
  0:03:56.431  2482M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 52445 paths from 104889 (50%)
  0:00:08.460  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 125)   Processed 3997936 reads
  0:00:08.465     1M / 5521M INFO    General                 (kmer_splitters.hpp        : 131)   Used 3997936 reads
  0:00:08.475     1M / 5521M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:03:56.519  2521M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 62934 paths from 104889 (60%)
  0:03:56.542  2531M / 8144M INFO    General                 (path_extenders.cpp        :  34)   Processed 65536 paths from 104889 (62%)
  0:03:56.605  2562M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 73423 paths from 104889 (70%)
  0:03:58.361  2848M / 8314M INFO    General                 (contig_output_stage.cpp   :  98)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/final_contigs.fasta
  0:03:56.686  2601M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 83912 paths from 104889 (80%)
  0:00:08.675     1M / 5521M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 143219523 kmers in total.
  0:00:08.675     1M / 5521M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Extension index construction (id: construction:extension_index_construction)
  0:00:08.676     1M / 5521M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 438)   Building kmer index
  0:00:08.676     1M / 5521M INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:08.676     1M / 5521M INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:08.676     1M / 5521M INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:08.676     1M / 5521M INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 419430
  0:03:56.757  2641M / 8144M INFO    General                 (path_extenders.cpp        :  36)   Processed 94401 paths from 104889 (90%)
  0:03:56.875  2680M / 8144M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:03:56.876  2680M / 8144M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:03:58.634  2848M / 8314M INFO    General                 (contig_output_stage.cpp   : 104)   Outputting FastG paths to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/final_contigs.paths
  0:03:56.933  2679M / 8144M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:03:56.935  2679M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  60)   Removing overlaps
  0:03:56.936  2679M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  70)   Marking overlaps
  0:03:56.937  2679M / 8144M INFO   OverlapRemover           (overlap_remover.hpp       : 116)   Marking start/end overlaps
  0:03:57.037  2679M / 8144M INFO   OverlapRemover           (overlap_remover.hpp       : 119)   Marking remaining overlaps
  0:03:57.136  2679M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  73)   Splitting paths
  0:03:57.155  2685M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  78)   Deduplicating paths
  0:03:57.213  2680M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  80)   Overlaps removed
  0:03:57.362  2680M / 8144M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:03:57.364  2680M / 8144M INFO    General                 (launcher.cpp              : 454)   Closing gaps in paths
  0:03:57.724  3070M / 8144M INFO    General                 (launcher.cpp              : 484)   Gap closing completed
  0:03:57.775  3083M / 8144M INFO    General                 (launcher.cpp              : 302)   Traversing tandem repeats
  0:03:59.617  2247M / 8314M INFO    General                 (contig_output_stage.cpp   :  98)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/scaffolds.fasta
  0:03:59.878  2247M / 8314M INFO    General                 (contig_output_stage.cpp   : 104)   Outputting FastG paths to /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/scaffolds.paths
  0:04:00.074  2247M / 8314M INFO    General                 (contig_output_stage.cpp   : 111)   Populating GFA with scaffold paths
  0:03:58.414  3083M / 8144M INFO    General                 (launcher.cpp              : 312)   Traversed 50 loops
  0:03:58.419  3083M / 8144M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:03:58.420  3083M / 8144M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:04:00.226  2165M / 8314M INFO    General                 (pipeline.cpp              : 287)   SPAdes finished
  0:03:58.478  3083M / 8144M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:03:58.480  3083M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  60)   Removing overlaps
  0:03:58.482  3083M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  70)   Marking overlaps
  0:03:58.483  3083M / 8144M INFO   OverlapRemover           (overlap_remover.hpp       : 116)   Marking start/end overlaps
  0:03:58.589  3083M / 8144M INFO   OverlapRemover           (overlap_remover.hpp       : 119)   Marking remaining overlaps
  0:03:58.700  3083M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  73)   Splitting paths
  0:03:58.715  3083M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  78)   Deduplicating paths
  0:03:58.773  3083M / 8144M INFO   PEResolver               (pe_resolver.cpp           :  80)   Overlaps removed
  0:03:58.922  3083M / 8144M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:03:58.924  3083M / 8144M INFO    General                 (launcher.cpp              : 664)   ExSPAnder repeat resolving tool finished
  0:03:59.201  2150M / 8144M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:03:59.204  2150M / 8144M INFO    General                 (contig_output.hpp         :  16)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/before_rr.fasta
  0:04:01.418     1M / 8314M INFO    General                 (main.cpp                  : 136)   Assembling time: 0 hours 4 minutes 1 seconds

===== K55 finished. 


===== Copy files started. 


== Running: /usr/bin/python3 /usr/local/src/SPAdes/share/spades/spades_pipeline/scripts/copy_files.py /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/before_rr.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/before_rr.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/assembly_graph_after_simplification.gfa /nephele_data/outputs/asmbMetaSpades/S1_asmb/assembly_graph_after_simplification.gfa /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/final_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/contigs.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/first_pe_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/first_pe_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/strain_graph.gfa /nephele_data/outputs/asmbMetaSpades/S1_asmb/strain_graph.gfa /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/scaffolds.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffolds.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/scaffolds.paths /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffolds.paths /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/assembly_graph_with_scaffolds.gfa /nephele_data/outputs/asmbMetaSpades/S1_asmb/assembly_graph_with_scaffolds.gfa /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/assembly_graph.fastg /nephele_data/outputs/asmbMetaSpades/S1_asmb/assembly_graph.fastg /nephele_data/outputs/asmbMetaSpades/S1_asmb/K55/final_contigs.paths /nephele_data/outputs/asmbMetaSpades/S1_asmb/contigs.paths

  0:03:59.773  2150M / 8144M INFO    General                 (contig_output_stage.cpp   : 151)   Writing GFA graph to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/assembly_graph_with_scaffolds.gfa
  0:04:00.079  2150M / 8144M INFO    General                 (contig_output_stage.cpp   : 165)   Outputting FastG graph to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/assembly_graph.fastg

===== Copy files finished. 


===== Assembling finished. 


===== Breaking scaffolds started. 


== Running: /usr/bin/python3 /usr/local/src/SPAdes/share/spades/spades_pipeline/scripts/breaking_scaffolds_script.py --result_scaffolds_filename /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffolds.fasta --misc_dir /nephele_data/outputs/asmbMetaSpades/S1_asmb/misc --threshold_for_breaking_scaffolds 3

  0:04:01.144  2150M / 8144M INFO    General                 (contig_output_stage.cpp   : 196)   Breaking scaffolds

===== Breaking scaffolds finished. 


===== Terminate started. 


===== Terminate finished. 

 * Assembled contigs are in /nephele_data/outputs/asmbMetaSpades/S1_asmb/contigs.fasta
 * Assembled scaffolds are in /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffolds.fasta
 * Paths in the assembly graph corresponding to the contigs are in /nephele_data/outputs/asmbMetaSpades/S1_asmb/contigs.paths
 * Paths in the assembly graph corresponding to the scaffolds are in /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffolds.paths
 * Assembly graph is in /nephele_data/outputs/asmbMetaSpades/S1_asmb/assembly_graph.fastg
 * Assembly graph in GFA format is in /nephele_data/outputs/asmbMetaSpades/S1_asmb/assembly_graph_with_scaffolds.gfa

======= SPAdes pipeline finished.

SPAdes log can be found here: /nephele_data/outputs/asmbMetaSpades/S1_asmb/spades.log

Thank you for using SPAdes!
[Tue Oct 24 17:26:32 2023]
Finished job 19.
12 of 139 steps (9%) done

[Tue Oct 24 17:26:32 2023]
rule kreport2krona_per_sample:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S28_taxREPORT.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt
    jobid: 12
    wildcards: sample=S28

python3 /usr/local/src/nephele2/pipelines/wgsa/report2krona_wTAXid_last.py --report-file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S28_taxREPORT.txt --no-tax-prefixes -o /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt &&sed -i '2s/\t\t/\tUnclassified\t/g' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt &&sed -i '2s/\t\t/\tUnclassified\t/g' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt

[Tue Oct 24 17:26:32 2023]
rule run_bbtools_stats:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffolds.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta, /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_stats.txt
    jobid: 18
    wildcards: sample=S1

sed $'s/_cov_/ cov_/g' /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffolds.fasta > /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta && /usr/local/src/bbmap/stats.sh in=/nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta out=/nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_stats.txt && printf "\nTEDreads mapping stats:\n"  >> /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_stats.txt && rm -rf /nephele_data/outputs/asmbMetaSpades/S1_asmb/K* /nephele_data/outputs/asmbMetaSpades/S1_asmb/pipeline_state /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp /nephele_data/outputs/asmbMetaSpades/S1_asmb/misc /nephele_data/outputs/asmbMetaSpades/S1_asmb/before_rr.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/dataset.info /nephele_data/outputs/asmbMetaSpades/S1_asmb/*params* /nephele_data/outputs/asmbMetaSpades/S1_asmb/*.gfa /nephele_data/outputs/asmbMetaSpades/S1_asmb/first_pe_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/run_spades.sh /nephele_data/outputs/asmbMetaSpades/S1_asmb/*.yaml /nephele_data/outputs/asmbMetaSpades/S1_asmb/*.paths /nephele_data/outputs/asmbMetaSpades/S1_asmb/assembly_graph.fastg

[Tue Oct 24 17:26:32 2023]
rule kreport2krona_per_sample:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S6_taxREPORT.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt
    jobid: 7
    wildcards: sample=S6

python3 /usr/local/src/nephele2/pipelines/wgsa/report2krona_wTAXid_last.py --report-file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S6_taxREPORT.txt --no-tax-prefixes -o /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt &&sed -i '2s/\t\t/\tUnclassified\t/g' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt &&sed -i '2s/\t\t/\tUnclassified\t/g' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt
Namespace(m_file=None, o_file='/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt', r_dir=None, r_file='/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S28_taxREPORT.txt', tax_exclude=True, x_include=False)
[Tue Oct 24 17:26:32 2023]
Finished job 12.
13 of 139 steps (9%) done

[Tue Oct 24 17:26:32 2023]
rule tax_biom_per_sample:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S28_4biom.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S28_json.biom
    jobid: 77
    wildcards: sample=S28

sed 's/\t/;/g' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt | sed 's/;/\t/1' | nl -n ln |sed '1s/^/\t/' | sed '1s/1\s\+\t#/\t/' | sed 's/\s\+\t/\t/g' | sed '1s/LINEAGE/Taxonomy/' | sed -e '1s/Level.*/Taxonomy/' > /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S28_4biom.txt && biom convert -i /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S28_4biom.txt -o /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S28_json.biom --to-json --table-type='OTU table' --process-obs-metadata taxonomy
Namespace(m_file=None, o_file='/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt', r_dir=None, r_file='/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S6_taxREPORT.txt', tax_exclude=True, x_include=False)
[Tue Oct 24 17:26:32 2023]
Finished job 7.
14 of 139 steps (10%) done

[Tue Oct 24 17:26:32 2023]
rule tax_biom_per_sample:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S6_4biom.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S6_json.biom
    jobid: 76
    wildcards: sample=S6

sed 's/\t/;/g' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt | sed 's/;/\t/1' | nl -n ln |sed '1s/^/\t/' | sed '1s/1\s\+\t#/\t/' | sed 's/\s\+\t/\t/g' | sed '1s/LINEAGE/Taxonomy/' | sed -e '1s/Level.*/Taxonomy/' > /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S6_4biom.txt && biom convert -i /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S6_4biom.txt -o /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S6_json.biom --to-json --table-type='OTU table' --process-obs-metadata taxonomy
Removing temporary output file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S28_4biom.txt.
[Tue Oct 24 17:26:32 2023]
Finished job 77.
15 of 139 steps (11%) done
Removing temporary output file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S6_4biom.txt.
[Tue Oct 24 17:26:32 2023]
Finished job 76.
16 of 139 steps (12%) done
  0:04:02.132  2620M / 8144M INFO    General                 (contig_output_stage.cpp   :  98)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/final_contigs.fasta
  0:04:02.329  2620M / 8144M INFO    General                 (contig_output_stage.cpp   : 104)   Outputting FastG paths to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/final_contigs.paths
  0:00:14.291  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 143219523 kmers
  0:00:14.292  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 199)   Used 143219523 kmers.
  0:00:14.296     1M / 6995M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:14.551     1M / 6995M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 141386674 kmers in total.
  0:00:14.552     1M / 6995M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:04:03.048  2209M / 8144M INFO    General                 (contig_output_stage.cpp   :  98)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/scaffolds.fasta
  0:04:03.246  2209M / 8144M INFO    General                 (contig_output_stage.cpp   : 104)   Outputting FastG paths to /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/scaffolds.paths
  0:04:03.384  2209M / 8144M INFO    General                 (contig_output_stage.cpp   : 111)   Populating GFA with scaffold paths
  0:00:15.347   103M / 6995M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 141386674 kmers, 102236352 bytes occupied (5.78478 bits per kmer).
  0:00:15.347   103M / 6995M INFO    General                 (kmer_index_builder.hpp    : 169)   Merging final buckets.
  0:04:03.490  2150M / 8144M INFO    General                 (pipeline.cpp              : 287)   SPAdes finished
  0:00:16.746   239M / 6995M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 100)   Building k-mer extensions from k+1-mers
  0:04:05.147     1M / 8144M INFO    General                 (main.cpp                  : 136)   Assembling time: 0 hours 4 minutes 5 seconds

===== K55 finished. 


===== Copy files started. 


== Running: /usr/bin/python3 /usr/local/src/SPAdes/share/spades/spades_pipeline/scripts/copy_files.py /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/before_rr.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/before_rr.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/assembly_graph_after_simplification.gfa /nephele_data/outputs/asmbMetaSpades/S28_asmb/assembly_graph_after_simplification.gfa /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/final_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/contigs.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/first_pe_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/first_pe_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/strain_graph.gfa /nephele_data/outputs/asmbMetaSpades/S28_asmb/strain_graph.gfa /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/scaffolds.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffolds.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/scaffolds.paths /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffolds.paths /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/assembly_graph_with_scaffolds.gfa /nephele_data/outputs/asmbMetaSpades/S28_asmb/assembly_graph_with_scaffolds.gfa /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/assembly_graph.fastg /nephele_data/outputs/asmbMetaSpades/S28_asmb/assembly_graph.fastg /nephele_data/outputs/asmbMetaSpades/S28_asmb/K55/final_contigs.paths /nephele_data/outputs/asmbMetaSpades/S28_asmb/contigs.paths


===== Copy files finished. 


===== Assembling finished. 


===== Breaking scaffolds started. 


== Running: /usr/bin/python3 /usr/local/src/SPAdes/share/spades/spades_pipeline/scripts/breaking_scaffolds_script.py --result_scaffolds_filename /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffolds.fasta --misc_dir /nephele_data/outputs/asmbMetaSpades/S28_asmb/misc --threshold_for_breaking_scaffolds 3


===== Breaking scaffolds finished. 


===== Terminate started. 


===== Terminate finished. 

 * Assembled contigs are in /nephele_data/outputs/asmbMetaSpades/S28_asmb/contigs.fasta
 * Assembled scaffolds are in /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffolds.fasta
 * Paths in the assembly graph corresponding to the contigs are in /nephele_data/outputs/asmbMetaSpades/S28_asmb/contigs.paths
 * Paths in the assembly graph corresponding to the scaffolds are in /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffolds.paths
 * Assembly graph is in /nephele_data/outputs/asmbMetaSpades/S28_asmb/assembly_graph.fastg
 * Assembly graph in GFA format is in /nephele_data/outputs/asmbMetaSpades/S28_asmb/assembly_graph_with_scaffolds.gfa

======= SPAdes pipeline finished.

SPAdes log can be found here: /nephele_data/outputs/asmbMetaSpades/S28_asmb/spades.log

Thank you for using SPAdes!
[Tue Oct 24 17:26:37 2023]
Finished job 31.
17 of 139 steps (12%) done

[Tue Oct 24 17:26:37 2023]
rule run_bbtools_stats:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffolds.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta, /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_stats.txt
    jobid: 30
    wildcards: sample=S28

sed $'s/_cov_/ cov_/g' /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffolds.fasta > /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta && /usr/local/src/bbmap/stats.sh in=/nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta out=/nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_stats.txt && printf "\nTEDreads mapping stats:\n"  >> /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_stats.txt && rm -rf /nephele_data/outputs/asmbMetaSpades/S28_asmb/K* /nephele_data/outputs/asmbMetaSpades/S28_asmb/pipeline_state /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp /nephele_data/outputs/asmbMetaSpades/S28_asmb/misc /nephele_data/outputs/asmbMetaSpades/S28_asmb/before_rr.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/dataset.info /nephele_data/outputs/asmbMetaSpades/S28_asmb/*params* /nephele_data/outputs/asmbMetaSpades/S28_asmb/*.gfa /nephele_data/outputs/asmbMetaSpades/S28_asmb/first_pe_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/run_spades.sh /nephele_data/outputs/asmbMetaSpades/S28_asmb/*.yaml /nephele_data/outputs/asmbMetaSpades/S28_asmb/*.paths /nephele_data/outputs/asmbMetaSpades/S28_asmb/assembly_graph.fastg

[Tue Oct 24 17:26:37 2023]
rule run_kraken2_classification:
    input: /nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S1_klog.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S1_taxREPORT.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S1_classLOG.txt
    jobid: 3
    wildcards: sample=S1
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --gzip-compressed --threads 16 --confidence 0.05 --db /mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 --memory-mapping --paired /nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz /nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz --output /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S1_klog.txt --report /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S1_taxREPORT.txt 2>> /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S1_classLOG.txt
  0:00:21.950   239M / 6995M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 105)   Building k-mer extensions from k+1-mers finished.
  0:00:21.994   239M / 6995M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Early tip clipping (id: construction:early_tip_clipper)
  0:00:21.994   239M / 6995M INFO    General                 (construction.cpp          : 301)   Early tip clipper length bound set as (RL - K)
  0:00:21.994   239M / 6995M INFO   Early tip clipping       (early_simplification.hpp  :  47)   Early tip clipping
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffolds.fasta.
[Tue Oct 24 17:26:42 2023]
Finished job 30.
18 of 139 steps (13%) done
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffolds.fasta.
[Tue Oct 24 17:26:42 2023]
Finished job 18.
19 of 139 steps (14%) done

[Tue Oct 24 17:26:42 2023]
rule bowtie2_build:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/bowtie2_build.done
    jobid: 22
    wildcards: sample=S1
    threads: 16

bowtie2-build --quiet --threads 16 /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.db && touch /nephele_data/outputs/asmbMetaSpades/S1_asmb/bowtie2_build.done
Removing temporary output file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/S1_klog.txt.
[Tue Oct 24 17:26:46 2023]
Finished job 3.
20 of 139 steps (14%) done

[Tue Oct 24 17:26:46 2023]
rule gene_prediction:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gff, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.fna
    jobid: 41
    wildcards: sample=S1
    threads: 16

prodigal -p meta -i /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta -f gff -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gff -a /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa -d /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.fna -q
  0:00:28.087   398M / 6995M INFO   Early tip clipping       (early_simplification.hpp  :  82)   #tipped junctions: 1486643
  0:00:28.164   398M / 6995M INFO   Early tip clipping       (early_simplification.hpp  :  93)   Clipped tips: 1508371
  0:00:28.185   239M / 6995M INFO   Early tip clipping       (early_simplification.hpp  :  49)   36386904 22-mers were removed by early tip clipper
  0:00:28.185   239M / 6995M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Condensing graph (id: construction:graph_condensing)
  0:00:28.186   239M / 6995M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 354)   Extracting unbranching paths
  0:00:35.525   459M / 6995M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 373)   Extracting unbranching paths finished. 5681256 sequences extracted
  0:00:38.249   459M / 6995M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 309)   Collecting perfect loops
  0:00:39.122   459M / 6995M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 342)   Collecting perfect loops finished. 42 loops collected
  0:00:39.393   459M / 6995M INFO    General                 (debruijn_graph_constructor: 487)   Total 11362596 edges to create
  0:00:39.394   897M / 6995M INFO    General                 (debruijn_graph_constructor: 489)   Collecting link records
  0:00:45.697  1073M / 6995M INFO    General                 (debruijn_graph_constructor: 491)   Ordering link records
  0:00:45.814  1073M / 6995M INFO    General                 (debruijn_graph_constructor: 493)   Sorting done
  0:00:45.876  1105M / 6995M INFO    General                 (debruijn_graph_constructor: 503)   Total 3848449 vertices to create
  0:00:45.877  1462M / 6995M INFO    General                 (debruijn_graph_constructor: 506)   Connecting the graph
  0:00:50.474  1166M / 6995M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Filling coverage indices (PHM) (id: construction:coverage_filling_phm)
  0:00:50.474  1166M / 6995M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
[Tue Oct 24 17:27:09 2023]
Finished job 22.
21 of 139 steps (15%) done

[Tue Oct 24 17:27:09 2023]
rule bowtie2_run:
    input: /nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz, /nephele_data/outputs/asmbMetaSpades/S1_asmb/bowtie2_build.done
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.sam
    jobid: 21
    wildcards: sample=S1
    threads: 16

bowtie2 --phred33 --sensitive-local --no-unal --seed 4 -1 /nephele_data/outputs/TED_out/S1_R1_ted.fastq.gz -2 /nephele_data/outputs/TED_out/S1_R2_ted.fastq.gz -x /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.db -S /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.sam -p 16 2>> /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_stats.txt
  0:00:51.294  1270M / 6995M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 143219523 kmers, 103558872 bytes occupied (5.78462 bits per kmer).
  0:00:51.447  1819M / 6995M INFO    General                 (coverage_hash_map_builder.:  47)   Collecting k-mer coverage information from reads, this takes a while.
  0:00:57.419  1819M / 6995M INFO    General                 (construction.cpp          : 430)   Filling coverage and flanking coverage from PHM
  0:01:02.638  1819M / 6995M INFO    General                 (coverage_filling.hpp      :  82)   Processed 11362215 edges
  0:01:03.068   928M / 6995M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Raw Simplification (id: raw_simplification)
  0:01:03.068   928M / 6995M INFO    General                 (simplification.cpp        : 127)   PROCEDURE == Initial cleaning
  0:01:03.068   928M / 6995M INFO    General                 (graph_simplification.hpp  : 662)   Flanking coverage based disconnection disabled
  0:01:03.068   928M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Self conjugate edge remover
  0:01:03.258   928M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Self conjugate edge remover triggered 0 times
  0:01:03.258   928M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial tip clipper
  0:01:03.656   928M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial tip clipper triggered 18941 times
  0:01:03.657   928M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial ec remover
  0:01:17.712  1053M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial ec remover triggered 1438094 times
  0:01:17.726  1053M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial isolated edge remover
  0:01:18.022  1049M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial isolated edge remover triggered 109045 times
  0:01:18.023   843M / 6995M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification (id: simplification)
  0:01:18.023   843M / 6995M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:01:18.023   843M / 6995M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:18.023   843M / 6995M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:01:18.023   843M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:18.249   843M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 20813 times
  0:01:18.253   843M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:33.539   828M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 546405 times
  0:01:33.544   828M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:33.568   828M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:33.568   828M / 6995M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:01:33.568   828M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:33.671   811M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 4671 times
  0:01:33.672   811M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:33.681   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 122 times
  0:01:33.681   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:33.752   809M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 5779 times
  0:01:33.754   809M / 6995M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:01:33.754   809M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:33.762   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 231 times
  0:01:33.762   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:33.928   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 1466 times
  0:01:33.929   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:33.965   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 3362 times
  0:01:33.966   808M / 6995M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:01:33.966   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:33.987   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 78 times
  0:01:33.987   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:34.150   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 818 times
  0:01:34.150   808M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:34.170   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:34.170   807M / 6995M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:01:34.170   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:34.171   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 3 times
  0:01:34.171   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:34.171   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:34.171   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:34.171   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:34.171   807M / 6995M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 6
  0:01:34.171   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:34.171   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:34.171   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:34.172   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:34.172   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:34.172   807M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:34.211   806M / 6995M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification Cleanup (id: simplification_cleanup)
  0:01:34.211   806M / 6995M INFO    General                 (simplification.cpp        : 176)   PROCEDURE == Post simplification
  0:01:34.211   806M / 6995M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:34.211   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:34.397   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 4889 times
  0:01:34.398   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:34.463   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 1350 times
  0:01:34.464   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:34.493   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 87 times
  0:01:34.493   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:34.883   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 95 times
  0:01:34.884   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:34.911   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 866 times
  0:01:34.911   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:34.943   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 876 times
  0:01:34.943   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:35.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 164 times
  0:01:35.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:35.050   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 5 times
  0:01:35.050   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:35.101   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 51 times
  0:01:35.101   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:35.132   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 66 times
  0:01:35.132   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:35.159   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 5 times
  0:01:35.159   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:35.531   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 10 times
  0:01:35.531   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:35.551   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 52 times
  0:01:35.551   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:35.570   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 12 times
  0:01:35.571   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:35.630   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 11 times
  0:01:35.631   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:35.666   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:35.666   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:35.715   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 6 times
  0:01:35.715   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:35.716   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 3 times
  0:01:35.716   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:35.743   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:35.743   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:36.113   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 3 times
  0:01:36.113   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.113   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 2 times
  0:01:36.113   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:36.114   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:36.114   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.114   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:36.114   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:36.114   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:36.114   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:36.163   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 1 times
  0:01:36.163   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:36.163   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:01:36.163   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:36.190   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:36.190   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:36.559   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:01:36.560   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:36.560   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:36.560   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:36.560   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:36.560   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:36.560   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 2 times
  0:01:36.560   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:36.560   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:36.560   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:36.610   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:01:36.610   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:36.611   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:01:36.611   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:36.638   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:36.638   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:37.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:01:37.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:37.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:37.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:37.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:37.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:37.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:37.007   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:37.008   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:37.008   806M / 6995M INFO    General                 (simplification.cpp        : 323)   Running Hidden EC remover (meta)
  0:01:37.040   806M / 6995M INFO    General                 (simplification.cpp        : 327)   Disrupting self-conjugate edges
  0:01:37.111   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Removing isolated edges
  0:01:37.134   806M / 6995M INFO   Simplification           (parallel_processing.hpp   : 170)   Removing isolated edges triggered 2264 times
  0:01:37.134   806M / 6995M INFO    General                 (simplification.cpp        : 491)   Counting average coverage
  0:01:37.176   806M / 6995M INFO    General                 (simplification.cpp        : 497)   Average coverage = 5.15152
  0:01:37.176   806M / 6995M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:01:37.176   806M / 6995M INFO    General                 (read_converter.cpp        : 102)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K21/simplified_contigs
  0:01:37.182   808M / 6995M INFO    General                 (binary_converter.cpp      :  96)   16384 reads processed
  0:01:37.189   808M / 6995M INFO    General                 (binary_converter.cpp      :  96)   32768 reads processed
  0:01:37.202   808M / 6995M INFO    General                 (binary_converter.cpp      :  96)   65536 reads processed
  0:01:37.232   808M / 6995M INFO    General                 (binary_converter.cpp      : 111)   94639 reads written
  0:01:37.234   806M / 6995M INFO    General                 (pipeline.cpp              : 287)   SPAdes finished
  0:01:37.339     1M / 6995M INFO    General                 (main.cpp                  : 136)   Assembling time: 0 hours 1 minutes 37 seconds

===== K21 finished. 


===== K33 started. 


== Running: /usr/local/src/SPAdes/bin/spades-core /nephele_data/outputs/asmbMetaSpades/S6_asmb/K33/configs/config.info /nephele_data/outputs/asmbMetaSpades/S6_asmb/K33/configs/mda_mode.info /nephele_data/outputs/asmbMetaSpades/S6_asmb/K33/configs/meta_mode.info

  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K33/configs/config.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K33/configs/mda_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K33/configs/meta_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (memory_limit.cpp          :  48)   Memory limit set to 550 Gb
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 107)   Starting SPAdes, built from refs/heads/spades_3.15.2, git revision aab988a9b4986906b38396da7233bb1ee02982f2
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 108)   Maximum k-mer length: 128
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 109)   Assembling dataset (/nephele_data/outputs/asmbMetaSpades/S6_asmb/dataset.info) with K=33
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 110)   Maximum # of threads to use (adjusted due to OMP capabilities): 16
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 212)   SPAdes started
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 225)   Starting from stage: read_conversion
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 231)   Two-step repeat resolution disabled
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 672)   Graph created, vertex min_id: 3, edge min_id: 3
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 673)   Vertex size: 48, edge size: 40
  0:00:00.000     1M / 11M   INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:00:00.000     1M / 11M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == Binary Read Conversion (id: read_conversion)
  0:00:00.001     1M / 11M   INFO    General                 (read_converter.cpp        :  53)   Binary reads detected
  0:00:00.002     1M / 11M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == de Bruijn graph construction (id: construction)
  0:00:00.002     1M / 11M   INFO    General                 (construction.cpp          : 118)   Contigs from previous K will be used: /nephele_data/outputs/asmbMetaSpades/S6_asmb/K21/simplified_contigs
  0:00:00.068     1M / 11M   INFO    General                 (construction.cpp          : 153)   Max read length 150
  0:00:00.068     1M / 11M   INFO    General                 (construction.cpp          : 159)   Average read length 149.609
  0:00:00.068     1M / 11M   INFO    General                 (stage.cpp                 : 117)   PROCEDURE == k+1-mer counting (id: construction:kpomer_counting)
  0:00:00.068     1M / 11M   INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:00.068     1M / 11M   INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:00.068     1M / 11M   INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:00.068     1M / 11M   INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:06.826  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 125)   Processed 4187214 reads
  0:00:06.832     1M / 6102M INFO    General                 (kmer_splitters.hpp        : 131)   Used 4187214 reads
  0:00:06.844     1M / 6102M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:07.311     1M / 6102M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 157027397 kmers in total.
  0:00:07.311     1M / 6102M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Extension index construction (id: construction:extension_index_construction)
  0:00:07.313     1M / 6102M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 438)   Building kmer index
  0:00:07.313     1M / 6102M INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:07.313     1M / 6102M INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:07.313     1M / 6102M INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:07.313     1M / 6102M INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:08.643  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 9110481 kmers
  0:00:09.456  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 24613948 kmers
  0:00:10.272  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 40324015 kmers
  0:00:11.085  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 56032107 kmers
  0:00:11.917  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 71724863 kmers
  0:00:12.733  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 87433409 kmers
  0:00:13.544  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 103136495 kmers
  0:00:14.350  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 118826733 kmers
  0:00:15.162  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 134520437 kmers
  0:00:15.966  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 150211873 kmers
  0:00:16.317  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 157028277 kmers
  0:00:16.317  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 199)   Used 157028277 kmers.
  0:00:16.322     2M / 8186M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:17.755     2M / 8186M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 156332881 kmers in total.
  0:00:17.755     2M / 8186M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:19.663   117M / 8186M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 156332881 kmers, 113033680 bytes occupied (5.78426 bits per kmer).
  0:00:19.664   117M / 8186M INFO    General                 (kmer_index_builder.hpp    : 169)   Merging final buckets.
  0:00:22.736   269M / 8186M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 100)   Building k-mer extensions from k+1-mers
  0:00:30.471   269M / 8186M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 105)   Building k-mer extensions from k+1-mers finished.
  0:00:30.573   269M / 8186M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Early tip clipping (id: construction:early_tip_clipper)
  0:00:30.573   269M / 8186M INFO    General                 (construction.cpp          : 301)   Early tip clipper length bound set as (RL - K)
  0:00:30.573   269M / 8186M INFO   Early tip clipping       (early_simplification.hpp  :  47)   Early tip clipping
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/bowtie2_build.done.
[Tue Oct 24 17:28:27 2023]
Finished job 21.
22 of 139 steps (16%) done

[Tue Oct 24 17:28:27 2023]
rule samtools_to_bam:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.sam
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.bam, /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_colated.bam, /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_fixmate.bam, /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_fixmate_sorted.bam, /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_tmp_markdup.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam
    jobid: 20
    wildcards: sample=S1
    threads: 16

samtools sort /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.sam -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.bam -@ 16 -T /nephele_data/tmp/S1_sort && samtools collate /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.bam -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_colated.bam -@ 16 /nephele_data/tmp/S1_collate && samtools fixmate -m /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_colated.bam /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_fixmate.bam -@ 16 && samtools sort /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_fixmate.bam -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_fixmate_sorted.bam -@ 16 -T /nephele_data/tmp/S1_sort && samtools markdup -r -s /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_fixmate_sorted.bam -f /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_tmp_markdup.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam -@ 16 -T /nephele_data/tmp/S1_markdup && samtools index -b /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam -@ 16
[bam_sort_core] merging from 0 files and 16 in-memory blocks...
  0:00:37.498   429M / 8186M INFO   Early tip clipping       (early_simplification.hpp  :  82)   #tipped junctions: 1661570
  0:00:37.573   429M / 8186M INFO   Early tip clipping       (early_simplification.hpp  :  93)   Clipped tips: 1694332
  0:00:37.616   269M / 8186M INFO   Early tip clipping       (early_simplification.hpp  :  49)   61714674 34-mers were removed by early tip clipper
  0:00:37.617   269M / 8186M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Condensing graph (id: construction:graph_condensing)
  0:00:37.618   269M / 8186M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 354)   Extracting unbranching paths
  0:00:43.716   416M / 8186M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 373)   Extracting unbranching paths finished. 2962638 sequences extracted
[bam_sort_core] merging from 0 files and 16 in-memory blocks...
  0:00:46.130   416M / 8186M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 309)   Collecting perfect loops
  0:00:47.285   416M / 8186M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 342)   Collecting perfect loops finished. 57 loops collected
  0:00:47.466   416M / 8186M INFO    General                 (debruijn_graph_constructor: 487)   Total 5925390 edges to create
  0:00:47.467   645M / 8186M INFO    General                 (debruijn_graph_constructor: 489)   Collecting link records
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.sam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1.bam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_colated.bam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_fixmate.bam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_fixmate_sorted.bam.
[Tue Oct 24 17:28:46 2023]
Finished job 20.
23 of 139 steps (17%) done

[Tue Oct 24 17:28:46 2023]
rule kreport2krona_per_sample:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S1_taxREPORT.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt
    jobid: 2
    wildcards: sample=S1

python3 /usr/local/src/nephele2/pipelines/wgsa/report2krona_wTAXid_last.py --report-file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S1_taxREPORT.txt --no-tax-prefixes -o /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt &&sed -i '2s/\t\t/\tUnclassified\t/g' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt &&sed -i '2s/\t\t/\tUnclassified\t/g' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt

[Tue Oct 24 17:28:46 2023]
rule add_de_replication_stats:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_stats.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_tmp_markdup.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/add_de_replication_stats.done
    jobid: 17
    wildcards: sample=S1

cat /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_stats.txt <(printf "\nRead alignment de-replication stats:\n") /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_tmp_markdup.txt > /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_tmp_file.txt && mv /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_tmp_file.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_stats.txt && touch /nephele_data/outputs/asmbMetaSpades/S1_asmb/add_de_replication_stats.done

[Tue Oct 24 17:28:46 2023]
rule scaffold_and_read_counts:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_basecov.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_idx.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_readcount.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_depths.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov1.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_scaffCoverage.txt
    jobid: 35
    wildcards: sample=S1

/usr/local/src/bbmap/pileup.sh /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam out=/nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov.txt overwrite=true && sort -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov.txt && jgi_summarize_bam_contig_depths /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam --outputDepth /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_depths.txt && sort /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_depths.txt | sed '1 s/^/#/' | cut -f 1-3 > /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_basecov.txt && samtools idxstats /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam > /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_idx.txt && cut -f 1-3 /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_idx.txt | sed -e '1s/^/#contigName\tLength\tReadsCount\n/' | sort | grep -v "*" > /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_readcount.txt && paste /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_readcount.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_basecov.txt | cut -f 1,2,3,8-14,17 -d $'\t' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov1.txt && awk 'BEGIN{FS=OFS="\t"} NR>1 {if ($2>0 && $3>0) $12=sprintf("%0.2f", $3*1e3/$2); else $12=0; print}'  /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov1.txt | sed -e '1s/^/#NODE\tlen\tReads\t\%ScaffCovered\t\%bpCovered\tplusReads\tminusReads\t\%GC\tMedFold\tstDev\tAveDepth\tRPK\n/' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_scaffCoverage.txt
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/S1_tmp_markdup.txt.
[Tue Oct 24 17:28:46 2023]
Finished job 17.
24 of 139 steps (17%) done
java -ea -Xmx76101m -cp /usr/local/src/bbmap/current/ jgi.CoveragePileup /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam out=/nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov.txt overwrite=true
Namespace(m_file=None, o_file='/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt', r_dir=None, r_file='/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/reports/S1_taxREPORT.txt', tax_exclude=True, x_include=False)
[Tue Oct 24 17:28:46 2023]
Finished job 2.
25 of 139 steps (18%) done

[Tue Oct 24 17:28:46 2023]
rule TAX_collation:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/SccList.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+TAX+Lineage.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+TAX.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Lineage.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+Lineage.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_TAX.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/TAX_collationR.log
    jobid: 136

find /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin//*_4krona.txt -type f -empty -delete && ls -1 /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/ | xargs basename -a -s _wTAXid_4krona.txt > /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/SccList.txt && Rscript /usr/local/src/nephele2/pipelines/wgsa/TableMerging_TAX_v4.R --binDIR /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/ --sccList /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/SccList.txt --outdir /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/ --genesDIR NA 2>&1 >/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/TAX_collationR.log

[Tue Oct 24 17:28:46 2023]
rule tax_biom_per_sample:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S1_4biom.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S1_json.biom
    jobid: 75
    wildcards: sample=S1

sed 's/\t/;/g' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt | sed 's/;/\t/1' | nl -n ln |sed '1s/^/\t/' | sed '1s/1\s\+\t#/\t/' | sed 's/\s\+\t/\t/g' | sed '1s/LINEAGE/Taxonomy/' | sed -e '1s/Level.*/Taxonomy/' > /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S1_4biom.txt && biom convert -i /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S1_4biom.txt -o /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S1_json.biom --to-json --table-type='OTU table' --process-obs-metadata taxonomy

[Tue Oct 24 17:28:46 2023]
rule kreport2krona_import_text:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/TAXplots_readsTAX_RefDB.html
    jobid: 1

ktImportText /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S1_wTAXid_4krona.txt /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S6_wTAXid_4krona.txt /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bin/S28_wTAXid_4krona.txt -o /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/TAXplots_readsTAX_RefDB.html
  0:00:50.725   737M / 8186M INFO    General                 (debruijn_graph_constructor: 491)   Ordering link records
  0:00:50.769   737M / 8186M INFO    General                 (debruijn_graph_constructor: 493)   Sorting done
  0:00:50.795   769M / 8186M INFO    General                 (debruijn_graph_constructor: 503)   Total 2268179 vertices to create
  0:00:50.795   982M / 8186M INFO    General                 (debruijn_graph_constructor: 506)   Connecting the graph
Writing /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/TAXplots_readsTAX_RefDB.html...
[Tue Oct 24 17:28:46 2023]
Finished job 1.
26 of 139 steps (19%) done
Removing temporary output file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S1_4biom.txt.
[Tue Oct 24 17:28:47 2023]
Finished job 75.
27 of 139 steps (19%) done
  0:00:53.412   810M / 8186M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Filling coverage indices (PHM) (id: construction:coverage_filling_phm)
  0:00:53.413   810M / 8186M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
Executing jgi.CoveragePileup [/nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam, out=/nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov.txt, overwrite=true]

  0:00:54.434   925M / 8186M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 157027397 kmers, 113535184 bytes occupied (5.78422 bits per kmer).
  0:00:54.601  1526M / 8186M INFO    General                 (coverage_hash_map_builder.:  47)   Collecting k-mer coverage information from reads, this takes a while.
Found samtools 1.13
Could not find sambamba.
  0:00:59.017  1526M / 8186M INFO    General                 (construction.cpp          : 430)   Filling coverage and flanking coverage from PHM
Reads:                               	1743714
Mapped reads:                        	1743714
Mapped bases:                        	248440487
Ref scaffolds:                       	144598
Ref bases:                           	54210351

Percent mapped:                      	100.000
Percent proper pairs:                	95.092
Average coverage:                    	4.583
Average coverage with deletions:     	4.583
  0:01:02.407  1526M / 8186M INFO    General                 (coverage_filling.hpp      :  82)   Processed 5925287 edges
Standard deviation:                    	15.490
Percent scaffolds with any coverage: 	97.78
Percent of reference bases covered:  	96.20

Time: 	8.963 seconds.
Output depth matrix to /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_depths.txt
jgi_summarize_bam_contig_depths v2.15-6-g8b5702b 2022-01-10T22:14:13
Output matrix to /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_depths.txt
0: Opening bam: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam
  0:01:03.125   541M / 8186M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Raw Simplification (id: raw_simplification)
  0:01:03.125   541M / 8186M INFO    General                 (simplification.cpp        : 127)   PROCEDURE == Initial cleaning
  0:01:03.125   541M / 8186M INFO    General                 (graph_simplification.hpp  : 662)   Flanking coverage based disconnection disabled
  0:01:03.125   541M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Self conjugate edge remover
Processing bam files
  0:01:03.203   541M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Self conjugate edge remover triggered 16 times
  0:01:03.203   541M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial tip clipper
  0:01:03.433   541M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial tip clipper triggered 27689 times
  0:01:03.433   541M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial ec remover
  0:01:08.783   571M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial ec remover triggered 628956 times
  0:01:08.790   571M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial isolated edge remover
  0:01:09.054   566M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial isolated edge remover triggered 161244 times
  0:01:09.054   480M / 8186M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification (id: simplification)
  0:01:09.054   480M / 8186M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:01:09.055   480M / 8186M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:09.055   480M / 8186M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:01:09.055   480M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:09.182   480M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 16770 times
  0:01:09.184   480M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:15.366   465M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 292341 times
  0:01:15.369   465M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:15.383   465M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 19 times
  0:01:15.383   465M / 8186M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:01:15.383   465M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:15.429   456M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 1766 times
  0:01:15.430   456M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:15.431   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 32 times
  0:01:15.431   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:15.445   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 1333 times
  0:01:15.446   454M / 8186M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:01:15.446   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:15.447   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 75 times
  0:01:15.447   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:15.490   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 516 times
  0:01:15.491   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:15.499   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 878 times
  0:01:15.499   454M / 8186M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:01:15.499   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:15.513   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 35 times
  0:01:15.513   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:15.563   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 244 times
  0:01:15.564   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:15.576   454M / 8186M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 1 times
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:15.576   454M / 8186M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 6
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:01:15.576   454M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:01:15.596   453M / 8186M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification Cleanup (id: simplification_cleanup)
  0:01:15.596   453M / 8186M INFO    General                 (simplification.cpp        : 176)   PROCEDURE == Post simplification
  0:01:15.596   453M / 8186M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:15.596   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:15.697   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 1558 times
  0:01:15.697   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:15.722   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 335 times
  0:01:15.722   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:15.741   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 40 times
  0:01:15.741   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:16.229   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 1231 times
  0:01:16.230   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:16.243   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 154 times
  0:01:16.243   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:16.261   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 273 times
  0:01:16.261   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:16.290   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 47 times
  0:01:16.290   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:16.307   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:16.307   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:16.330   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 12 times
  0:01:16.331   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:16.346   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 7 times
  0:01:16.346   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:16.365   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 1 times
  0:01:16.365   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:16.793   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 2 times
  0:01:16.793   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:16.806   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 8 times
  0:01:16.806   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:16.818   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:16.818   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:16.845   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 1 times
  0:01:16.845   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:16.862   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:16.862   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:01:16.889   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:01:16.889   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:01:16.889   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:01:16.889   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:01:16.908   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:01:16.908   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:01:17.334   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:01:17.334   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:17.334   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:01:17.334   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:01:17.334   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:01:17.334   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:01:17.334   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:01:17.334   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:01:17.334   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:01:17.334   453M / 8186M INFO    General                 (simplification.cpp        : 323)   Running Hidden EC remover (meta)
  0:01:17.356   453M / 8186M INFO    General                 (simplification.cpp        : 327)   Disrupting self-conjugate edges
  0:01:17.403   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Removing isolated edges
  0:01:17.417   453M / 8186M INFO   Simplification           (parallel_processing.hpp   : 170)   Removing isolated edges triggered 1427 times
  0:01:17.417   453M / 8186M INFO    General                 (simplification.cpp        : 491)   Counting average coverage
  0:01:17.442   453M / 8186M INFO    General                 (simplification.cpp        : 497)   Average coverage = 3.75175
  0:01:17.442   453M / 8186M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:01:17.442   453M / 8186M INFO    General                 (read_converter.cpp        : 102)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K33/simplified_contigs
  0:01:17.446   455M / 8186M INFO    General                 (binary_converter.cpp      :  96)   16384 reads processed
  0:01:17.450   455M / 8186M INFO    General                 (binary_converter.cpp      :  96)   32768 reads processed
  0:01:17.459   455M / 8186M INFO    General                 (binary_converter.cpp      :  96)   65536 reads processed
  0:01:17.483   455M / 8186M INFO    General                 (binary_converter.cpp      : 111)   88530 reads written
  0:01:17.484   453M / 8186M INFO    General                 (pipeline.cpp              : 287)   SPAdes finished
  0:01:17.549     1M / 8186M INFO    General                 (main.cpp                  : 136)   Assembling time: 0 hours 1 minutes 17 seconds

===== K33 finished. 


===== K55 started. 


== Running: /usr/local/src/SPAdes/bin/spades-core /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/configs/config.info /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/configs/mda_mode.info /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/configs/meta_mode.info

  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/configs/config.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/configs/mda_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  :  99)   Loaded config from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/configs/meta_mode.info
  0:00:00.000     1M / 11M   INFO    General                 (memory_limit.cpp          :  48)   Memory limit set to 550 Gb
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 107)   Starting SPAdes, built from refs/heads/spades_3.15.2, git revision aab988a9b4986906b38396da7233bb1ee02982f2
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 108)   Maximum k-mer length: 128
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 109)   Assembling dataset (/nephele_data/outputs/asmbMetaSpades/S6_asmb/dataset.info) with K=55
  0:00:00.000     1M / 11M   INFO    General                 (main.cpp                  : 110)   Maximum # of threads to use (adjusted due to OMP capabilities): 16
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 212)   SPAdes started
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 225)   Starting from stage: read_conversion
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 231)   Two-step repeat resolution enabled
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 672)   Graph created, vertex min_id: 3, edge min_id: 3
  0:00:00.000     1M / 11M   INFO   GraphCore                (graph_core.hpp            : 673)   Vertex size: 48, edge size: 40
  0:00:00.000     1M / 11M   INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:00:00.000     1M / 11M   INFO    General                 (pipeline.cpp              : 242)   Will need read mapping, kmer mapper will be attached
  0:00:00.000     1M / 11M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == Binary Read Conversion (id: read_conversion)
  0:00:00.001     1M / 11M   INFO    General                 (read_converter.cpp        :  53)   Binary reads detected
  0:00:00.002     1M / 11M   INFO   StageManager             (stage.cpp                 : 185)   STAGE == de Bruijn graph construction (id: construction)
  0:00:00.002     1M / 11M   INFO    General                 (construction.cpp          : 118)   Contigs from previous K will be used: /nephele_data/outputs/asmbMetaSpades/S6_asmb/K33/simplified_contigs
  0:00:00.026     1M / 11M   INFO    General                 (construction.cpp          : 153)   Max read length 150
  0:00:00.026     1M / 11M   INFO    General                 (construction.cpp          : 159)   Average read length 149.609
  0:00:00.026     1M / 11M   INFO    General                 (stage.cpp                 : 117)   PROCEDURE == k+1-mer counting (id: construction:kpomer_counting)
  0:00:00.026     1M / 11M   INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:00.026     1M / 11M   INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:00.026     1M / 11M   INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:00.026     1M / 11M   INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:05.213  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 125)   Processed 4174996 reads
  0:00:05.218     1M / 5686M INFO    General                 (kmer_splitters.hpp        : 131)   Used 4174996 reads
  0:00:05.229     1M / 5686M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:05.691     1M / 5686M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 157199715 kmers in total.
  0:00:05.691     1M / 5686M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Extension index construction (id: construction:extension_index_construction)
  0:00:05.692     1M / 5686M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 438)   Building kmer index
  0:00:05.692     1M / 5686M INFO    General                 (kmer_index_builder.hpp    : 243)   Splitting kmer instances into 160 files using 16 threads. This might take a while.
  0:00:05.692     1M / 5686M INFO    General                 (file_limit.hpp            :  32)   Open file limit set to 1024
  0:00:05.692     1M / 5686M INFO    General                 (kmer_splitter.hpp         :  93)   Memory available for splitting buffers: 11.4583 Gb
  0:00:05.692     1M / 5686M INFO    General                 (kmer_splitter.hpp         : 101)   Using cell size of 209715
  0:00:06.995  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 10176132 kmers
  0:00:07.659  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 25728650 kmers
  0:00:08.323  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 41459328 kmers
  0:00:08.989  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 57172309 kmers
  0:00:09.656  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 72903787 kmers
  0:00:10.317  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 88611097 kmers
  0:00:10.980  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 104328905 kmers
  0:00:11.650  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 120043210 kmers
  0:00:12.318  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 135759076 kmers
  0:00:12.992  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 151470186 kmers
  0:00:13.243  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 194)   Processed 157200595 kmers
  0:00:13.243  9601M / 9601M INFO    General                 (kmer_splitters.hpp        : 199)   Used 157200595 kmers.
  0:00:13.247     2M / 8139M INFO    General                 (kmer_index_builder.hpp    : 249)   Starting k-mer counting.
  0:00:14.395     2M / 8139M INFO    General                 (kmer_index_builder.hpp    : 260)   K-mer counting done. There are 157640429 kmers in total.
  0:00:14.395     2M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:15.498   117M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 157640429 kmers, 113977856 bytes occupied (5.78419 bits per kmer).
  0:00:15.498   117M / 8139M INFO    General                 (kmer_index_builder.hpp    : 169)   Merging final buckets.
[Tue Oct 24 17:29:30 2023]
Finished job 41.
28 of 139 steps (20%) done

[Tue Oct 24 17:29:30 2023]
rule tax_classification_genes:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.fna
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_taxREPORT.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_classLOG.txt
    jobid: 91
    wildcards: sample=S1
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --threads 16  --db /mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 --confidence 0.05 /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.fna --memory-mapping --output /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt --report /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_taxREPORT.txt 2>> /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_classLOG.txt

[Tue Oct 24 17:29:30 2023]
rule gff_to_gtf:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gff
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gtf
    jobid: 40
    wildcards: sample=S1

/usr/local/src/nephele2/pipelines/wgsa/gff2gtf.sh /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gff > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gtf
[Tue Oct 24 17:29:30 2023]
Finished job 40.
29 of 139 steps (21%) done
[Tue Oct 24 17:29:32 2023]
Finished job 91.
30 of 139 steps (22%) done

[Tue Oct 24 17:29:32 2023]
rule run_verse:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gtf, /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/verse.CDS.summary.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/verse.CDS.txt
    jobid: 39
    wildcards: sample=S1
    threads: 16

verse -a /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gtf -t 'CDS' -g gene_id -z 0 -s 0 -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/verse /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam -T 4
  0:00:18.890   269M / 8139M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 100)   Building k-mer extensions from k+1-mers
Note: Using an external vector in selections is ambiguous.
ℹ Use `all_of(tiers)` instead of `tiers` to silence this message.
ℹ See <https://tidyselect.r-lib.org/reference/faq-external-vector.html>.
This message is displayed once per session.
`summarise()` has grouped output by 'Kingdom', 'Phylum', 'Class', 'Order', 'Family', 'Genus', 'Species'. You can override using the `.groups` argument.

        ===      ===    %%  %%  %%%%%%  %%   %%  %%       %%%%   %%%%%   
         ==      ==     %% %%     %%    %%% %%%  %%      %%  %%  %%  %%  
          ==    ==      %%%%      %%    %% % %%  %%      %%%%%%  %%%%%   
           ==  ==       %% %%     %%    %%   %%  %%      %%  %%  %%  %%  
            ====        %%  %%  %%%%%%  %%   %%  %%%%%%  %%  %%  %%%%%   
             ==        ................................................. 
	  v0.1.5

//============================== VERSE setting ===============================\\
||            Running mode : Default(featureCounts)                           ||
||            Feature type : CDS                                              ||
||              Input file : 1 BAM file                                       ||
||                           P /nephele_data/outputs/asmbMetaSpades/S1_as ... ||
||             Output file : /nephele_data/outputs/asmbMetaSpades/S1_asmb ... ||
||         Annotation file : /nephele_data/outputs/asmbMetaSpades/S1_asmb ... ||
||                                                                            ||
||                 Threads : 4                                                ||
|| Multithreaded BAM unzip : no                                               ||
||                                                                            ||
||              Paired-end : yes                                              ||
||         Strand specific : no                                               ||
||      Multimapping reads : not counted                                      ||
||                                                                            ||
||          Chimeric reads : counted                                          ||
||        Both ends mapped : not required                                     ||
||                                                                            ||
\\============= Based on the framework of featureCounts(SUBREAD) =============//

//================================= Running ==================================\\
||                                                                            ||
|| Load annotation file /nephele_data/outputs/asmbMetaSpades/S1_asmb/gene ... ||
||    CDSs : 161006                                                           ||
||    CDSs after merge : 161006                                               ||
||    Genes : 161006                                                          ||
||    Chromosomes : 137183                                                    ||
||                                                                            ||
|| Process BAM file /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.as ... ||
||    Quantifying in paired-end mode.                                         ||
||    Assign read pairs to features...                                        ||
||    Read pairs with missing mates : 1596058                                 ||
||    Total read pairs : 1669886                                              ||
||    Successfully assigned read pairs : 1470987 (88.1%)                      ||
||    Running time : 0.06 minutes                                             ||
||                                                                            ||
||                         Read assignment finished.                          ||
||                                                                            ||
\\====== VERSE: a Versatile and Efficient Rna-SEq read assignment tool =======//

[Tue Oct 24 17:29:36 2023]
Finished job 39.
31 of 139 steps (22%) done

[Tue Oct 24 17:29:36 2023]
rule tax_classification_scaffolds:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_taxREPORT.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAXclassLOG.txt
    jobid: 101
    wildcards: sample=S1
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --db /mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 --confidence 0.05 --memory-mapping --threads 16 /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta --output /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_klog.txt --report /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_taxREPORT.txt 2>> /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAXclassLOG.txt

[Tue Oct 24 17:29:36 2023]
rule rename_verse_summary:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/verse.CDS.summary.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_stats.txt
    jobid: 38
    wildcards: sample=S1

mv /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/verse.CDS.summary.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_stats.txt

[Tue Oct 24 17:29:36 2023]
rule tpm_normalization:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gtf, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/verse.CDS.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_lengths.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_counts.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_coverage.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_RPK.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_ABUNtab.txt
    jobid: 55
    wildcards: sample=S1

cut -f4,5,9 /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.gtf | sed 's/gene_id //g' | gawk '{print $3,$2-$1+1}' | tr ' ' '\t' | sed '1s/^/gene\tlength\n/' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_lengths.txt && join /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_lengths.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/verse.CDS.txt -t $'\t' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_counts.txt && grep "_" /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_counts.txt   | awk -v OFS="\t" '{$4 = sprintf("%0.0f", $3*150/$2)}1' | sort | sed -e '1s/^/#name\tlen\treads\tcov\n/' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_coverage.txt && grep "_" /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_coverage.txt | awk -v OFS="\t" '{$5 = sprintf("%0.0f", $3*1e3/$2)}1' | sort | sed -e '1s/^/#name\tlen\treads\tcov\tRPK\n/' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_RPK.txt && awk -v OFS="\t" 'NR==FNR{sum+= $5; next} FNR==1{print $0,"iTPM"; next} {printf("%s %0.0f\n", $0,$5*1e6/sum)}'  /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_RPK.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_RPK.txt |sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_ABUNtab.txt  
[Tue Oct 24 17:29:36 2023]
Finished job 38.
32 of 139 steps (23%) done
`summarise()` has grouped output by 'Kingdom', 'Phylum', 'Class', 'Order', 'Family', 'Genus', 'Species'. You can override using the `.groups` argument.
`summarise()` has grouped output by 'Kingdom', 'Phylum', 'Class', 'Order', 'Family', 'Genus', 'Species'. You can override using the `.groups` argument.
Warning message:
In dir.create(output$dir) :
  '/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables' already exists
Removing temporary output file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/SccList.txt.
[Tue Oct 24 17:29:37 2023]
Finished job 136.
33 of 139 steps (24%) done

[Tue Oct 24 17:29:37 2023]
rule TAX_collation_biom:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+Lineage.txt, /nephele_data/inputs/wgsa_example_mapping_corrected.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+Lineage_json.biom, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/tmp_.txt
    jobid: 135

sed '1s/Lineage/Taxonomy/' /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+Lineage.txt > /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/tmp_.txt && biom convert -i /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/tmp_.txt -m <(sed '1s/^/#/' /nephele_data/inputs/wgsa_example_mapping_corrected.txt) -o /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+Lineage_json.biom --to-json --table-type='OTU table' --process-obs-metadata taxonomy

[Tue Oct 24 17:29:37 2023]
rule TAX_diversity_plots:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+TAX.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_TAX.txt, /nephele_data/inputs/wgsa_example_mapping_corrected.txt
    output: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/tmp_mapping_file.txt, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/TAX_diversity_plots.done
    jobid: 138


            sed 's/^#//g' /nephele_data/inputs/wgsa_example_mapping_corrected.txt > /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/tmp_mapping_file.txt
            Rscript /usr/local/src/nephele2/pipelines/wgsa/DiversityPlots_TAX_v3.R --wdir /nephele_data/tmp/ --indir /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/ --mfile /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/tmp_mapping_file.txt --outdir /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/ || echo "ERROR: Failed to generate TAX_diversity_plots"
            touch /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/TAX_diversity_plots.done
            
Removing temporary output file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/tmp_.txt.
[Tue Oct 24 17:29:38 2023]
Finished job 135.
34 of 139 steps (24%) done
Loading required package: data.table
Loading required package: fossil
  0:00:24.812   269M / 8139M INFO   DeBruijnExtensionIndexBu (kmer_extension_index_build: 105)   Building k-mer extensions from k+1-mers finished.
Loading required package: sp
  0:00:24.917   269M / 8139M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Condensing graph (id: construction:graph_condensing)
  0:00:24.918   269M / 8139M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 354)   Extracting unbranching paths
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/verse.CDS.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_lengths.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_counts.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_coverage.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/tmp_RPK.txt.
[Tue Oct 24 17:29:38 2023]
Finished job 55.
35 of 139 steps (25%) done

[Tue Oct 24 17:29:38 2023]
rule tax_genes_ABUNtabtax:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_ABUNtab.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt
    jobid: 90
    wildcards: sample=S1

cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt | sed -e 's/ (taxid /\t/g' | sed -e 's/)$//g' | sort | sed '1s/^/#contigName\tTAXname\tTAXid\n/' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt &&paste /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_ABUNtab.txt <(cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt) > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt 
[Tue Oct 24 17:29:39 2023]
Finished job 101.
36 of 139 steps (26%) done

[Tue Oct 24 17:29:39 2023]
rule bowtie2_build:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/bowtie2_build.done
    jobid: 34
    wildcards: sample=S28
    threads: 16

bowtie2-build --quiet --threads 16 /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.db && touch /nephele_data/outputs/asmbMetaSpades/S28_asmb/bowtie2_build.done
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt.
[Tue Oct 24 17:29:39 2023]
Finished job 90.
37 of 139 steps (27%) done

[Tue Oct 24 17:29:39 2023]
rule tax_genes_4krona:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt
    output: /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S1_4krona.txt
    jobid: 97
    wildcards: sample=S1

cut -f6-8 /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt | awk -F'\t' 'NR>1{k = $3; sum[k]+= $1; name[k]=$2} END { print; for (k in sum) print sum[k], name[k], k}' OFS="	" |sed -e '1 s/^/#iTPM\tTAXname\tTAXid\n/' > /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S1_4krona.txt
Loading required package: maps
[Tue Oct 24 17:29:39 2023]
Finished job 97.
38 of 139 steps (27%) done
Loading required package: shapefiles
Loading required package: foreign

Attaching package: ‘shapefiles’

The following objects are masked from ‘package:foreign’:

    read.dbf, write.dbf

Loading required package: ggplot2
Loading required package: vegan
Loading required package: permute
Loading required package: lattice
This is vegan 2.5-7
Loading required package: ampvis2
All packages loaded successfully
[1] "-----------> docopt settings---------------------"
[1] "Usage: DiversityPlots_v1.R [options]\n  --help            show this screen.\n  --wdir PATH       give path to working dir /project main dir  [default: pwd ].\n  --indir PATH      give path to input files directory [default: profiles/merged_tables ].\n  --mfile NAME      give name of mapping file [default: mapping.txt ].\n  --outdir NAME     give path & name of output directory to create [default: pwd/profiles/DiversityPlots]."
List of 10
 $ --help  : logi FALSE
 $ --wdir  : chr "/nephele_data/tmp/"
 $ --indir : chr "/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/"
 $ --mfile : chr "/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/tmp_mapping_file.txt"
 $ --outdir: chr "/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/"
 $ help    : logi FALSE
 $ wdir    : chr "/nephele_data/tmp/"
 $ indir   : chr "/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/"
 $ mfile   : chr "/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/tmp_mapping_file.txt"
 $ outdir  : chr "/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/"
NULL
[1] "-----------> docopt settings------^^^^-----------"
Warning message:
In dir.create(path$outdir) :
  '/nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots' already exists
Warning message:
In tables$meta <- read.table(paste0(args$mfile), header = T, sep = "\t",  :
  Coercing LHS to a list
    SampleID                       ForwardFastqFile
S1        S1 S1_GItract_camiHiSeq_sub1M_R1.fastq.gz
S28      S28   S28_Skin_camiHiSeq_sub1M_R1.fastq.gz
S6        S6    S6_Oral_camiHiSeq_sub1M_R1.fastq.gz
                          ReverseFastqFile TreatmentGroup
S1  S1_GItract_camiHiSeq_sub1M_R2.fastq.gz          Stool
S28   S28_Skin_camiHiSeq_sub1M_R2.fastq.gz           Skin
S6     S6_Oral_camiHiSeq_sub1M_R2.fastq.gz           Skin
[1] "-----------> read in mapping file^^^"
          S1 S28   S6
id2789425  0   0    1
id1655     0   0    5
id712116   0   0    5
id706438   0   0    3
id544580   0   0 3883
id111015   0   1    0
[1] "-----------> read in Counts file^^^"
           Kingdom         Phylum         Class           Order
id2789425 Bacteria Actinomycetota Actinomycetes Actinomycetales
id1655    Bacteria Actinomycetota Actinomycetes Actinomycetales
id712116  Bacteria Actinomycetota Actinomycetes Actinomycetales
id706438  Bacteria Actinomycetota Actinomycetes Actinomycetales
id544580  Bacteria Actinomycetota Actinomycetes Actinomycetales
id111015  Bacteria Actinomycetota Actinomycetes Actinomycetales
                    Family       Genus                    Species
id2789425 Actinomycetaceae Actinomyces        Actinomyces_HMT_175
id1655    Actinomycetaceae Actinomyces     Actinomyces_naeslundii
id712116  Actinomycetaceae Actinomyces Actinomyces_oral_taxon_169
id706438  Actinomycetaceae Actinomyces Actinomyces_oral_taxon_171
id544580  Actinomycetaceae Actinomyces           Actinomyces_oris
id111015  Actinomycetaceae Actinomyces   Actinomyces_radicidentis
[1] "-----------> read in TAX file^^^"
[1] "-----------> Calculating alpha diversity indexes"
Warning message:
In alpha1$reads = colSums(tables$counts) : Coercing LHS to a list
    SpRichness  Evenness NumbReads  Shannon InvSimpson    chao1
S1         323 0.5057342    999327 2.921956  10.477427 461.7935
S28        389 0.3928707    986022 2.342916   5.377797 659.4000
S6         444 0.4770372    997758 2.907935   8.428382 669.9403
[1] "-----------> Adding these apha indices to metadata ^^^"
Warning message:
In sst$meta = tables$meta : Coercing LHS to a list
    group1 group2   variable  value
 1:     S1  Stool SpRichness 323.00
 2:    S28   Skin SpRichness 389.00
 3:     S6   Skin SpRichness 444.00
 4:     S1  Stool   Evenness   0.51
 5:    S28   Skin   Evenness   0.39
 6:     S6   Skin   Evenness   0.48
 7:     S1  Stool    Shannon   2.92
 8:    S28   Skin    Shannon   2.34
 9:     S6   Skin    Shannon   2.91
10:     S1  Stool InvSimpson  10.48
11:    S28   Skin InvSimpson   5.38
12:     S6   Skin InvSimpson   8.43
[1] "-----------> plotting alpha diversity"
  0:00:33.928   480M / 8139M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 373)   Extracting unbranching paths finished. 3943390 sequences extracted
null device 
          1 
[1] "-----------> prepping AMPVIS2 object"
Thread 0 finished: final.assembly.bam with 1743714 reads and 873048 readsWellMapped
Creating depth matrix file: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_depths.txt
Warning message:
Could not find a column named OTU/ASV in otutable, using rownames as OTU ID's 
[1] "-----------> checking some AMPVIS2 data"
          S1 S28 S6
id2789425  0   0  1
id1655     0   0  5
id712116   0   0  5
id706438   0   0  3
           Kingdom         Phylum         Class           Order
id2789425 Bacteria Actinomycetota Actinomycetes Actinomycetales
id1655    Bacteria Actinomycetota Actinomycetes Actinomycetales
id712116  Bacteria Actinomycetota Actinomycetes Actinomycetales
id706438  Bacteria Actinomycetota Actinomycetes Actinomycetales
                    Family       Genus                    Species       OTU
id2789425 Actinomycetaceae Actinomyces        Actinomyces_HMT_175 id2789425
id1655    Actinomycetaceae Actinomyces     Actinomyces_naeslundii    id1655
id712116  Actinomycetaceae Actinomyces Actinomyces_oral_taxon_169  id712116
id706438  Actinomycetaceae Actinomyces Actinomyces_oral_taxon_171  id706438
    SampleID                       ForwardFastqFile
S1        S1 S1_GItract_camiHiSeq_sub1M_R1.fastq.gz
S28      S28   S28_Skin_camiHiSeq_sub1M_R1.fastq.gz
S6        S6    S6_Oral_camiHiSeq_sub1M_R1.fastq.gz
                          ReverseFastqFile
S1  S1_GItract_camiHiSeq_sub1M_R2.fastq.gz
S28   S28_Skin_camiHiSeq_sub1M_R2.fastq.gz
S6     S6_Oral_camiHiSeq_sub1M_R2.fastq.gz
[1] "-----------> checking AMPVIS2 data ^^^"
[1] "-----------> making PCOA plot"
799 OTUs not present in more than 0.01% relative abundance in any sample have been filtered 
Before:961 OTUs
After:162 OTUs
Closing most bam files
Closing last bam file
Finished
null device 
          1 
[1] "-----------> making nMDS plot"
799 OTUs not present in more than 0.01% relative abundance in any sample have been filtered 
Before:961 OTUs
After:162 OTUs
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_basecov.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_idx.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_readcount.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/tmp_scaffcov1.txt.
[Tue Oct 24 17:29:50 2023]
Finished job 35.
39 of 139 steps (28%) done

[Tue Oct 24 17:29:50 2023]
rule generate_scafftax:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_scaffCoverage.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_scaffCovr+tax.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt
    jobid: 100
    wildcards: sample=S1

cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_klog.txt | sed -e 's/ (taxid /\t/g' | sed -e 's/)$//g' | sort | sed '1s/^/#contigName\tTAXname\tTAXid\n/' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt && paste /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_scaffCoverage.txt <(cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt) > /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_scaffCovr+tax.txt
null device 
          1 
Warning messages:
1: In vegan::metaMDS(data$abund, distance = distmeasure, trace = FALSE,  :
  stress is (nearly) zero: you may have insufficient data
2: In postMDS(out$points, dis, plot = max(0, plot - 1), ...) :
  skipping half-change scaling: too few points below threshold
[1] "-----------> making heatmap profile graph"
null device 
          1 
Warning message:
Transformation introduced infinite values in discrete y-axis 
[1] "-----------> making rarecurve graph"
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_klog.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt.
[Tue Oct 24 17:29:50 2023]
Finished job 100.
40 of 139 steps (29%) done
0 samples have been filtered.
Error in value[[3L]](cond) : attempt to apply non-function
In addition: Warning message:
The chosen rarefy size (500000) is smaller than the smallest amount of reads in any sample (986022). 
[1] "-----------> making rank abundance / Whittaker plot"
null device 
          1 
Warning message:
In max(ids, na.rm = TRUE) : no non-missing arguments to max; returning -Inf
Removing temporary output file /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/tmp_mapping_file.txt.
[Tue Oct 24 17:29:51 2023]
Finished job 138.
41 of 139 steps (29%) done

[Tue Oct 24 17:29:51 2023]
rule metabat2_run:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta, /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_depths.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/metabat2_run.done
    jobid: 109
    wildcards: sample=S1
    threads: 16

metabat2 -i /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.fasta -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/mag -m 1500 --maxEdges 250 --unbinned  -t 16 -a /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_depths.txt && touch /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/metabat2_run.done
MetaBAT 2 (v2.15-6-g8b5702b) using minContig 1500, minCV 1.0, minCVSum 1.0, maxP 95%, minS 60, maxEdges 250 and minClsSize 200000. with random seed=1698182991
  0:00:38.077   480M / 8139M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 309)   Collecting perfect loops
1 bins (4284128 bases in total) formed.
[Tue Oct 24 17:29:52 2023]
Finished job 109.
42 of 139 steps (30%) done

[Tue Oct 24 17:29:52 2023]
rule checkm_coverage:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/metabat2_run.done
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_coverage.txt
    jobid: 111
    wildcards: sample=S1
    threads: 16

checkm coverage -x fa -t 16 /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_coverage.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam 2>/dev/null
  0:00:39.275   480M / 8139M INFO   UnbranchingPathExtractor (debruijn_graph_constructor: 342)   Collecting perfect loops finished. 1 loops collected
  0:00:39.561   480M / 8139M INFO    General                 (debruijn_graph_constructor: 487)   Total 7886782 edges to create
  0:00:39.562   786M / 8139M INFO    General                 (debruijn_graph_constructor: 489)   Collecting link records
[2023-10-24 17:29:53] INFO: CheckM v1.1.3
[2023-10-24 17:29:53] INFO: checkm coverage -x fa -t 16 /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_coverage.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly.bam
[2023-10-24 17:29:53] INFO: [CheckM - coverage] Calculating coverage of sequences.
[2023-10-24 17:29:53] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:29:53] INFO: Determining bin assignment of each sequence.
[2023-10-24 17:29:54] INFO: Processing 1 file(s) with 16 threads.

[2023-10-24 17:29:54] INFO: Processing final.assembly.bam (1 of 1):
  0:00:44.053   910M / 8139M INFO    General                 (debruijn_graph_constructor: 491)   Ordering link records
  0:00:44.143   910M / 8139M INFO    General                 (debruijn_graph_constructor: 493)   Sorting done
  0:00:44.221   974M / 8139M INFO    General                 (debruijn_graph_constructor: 503)   Total 4384105 vertices to create
  0:00:44.227  1380M / 8139M INFO    General                 (debruijn_graph_constructor: 506)   Connecting the graph
[Tue Oct 24 17:30:02 2023]
Finished job 34.
43 of 139 steps (31%) done

[Tue Oct 24 17:30:02 2023]
rule bowtie2_run:
    input: /nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz, /nephele_data/outputs/asmbMetaSpades/S28_asmb/bowtie2_build.done
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.sam
    jobid: 33
    wildcards: sample=S28
    threads: 16

bowtie2 --phred33 --sensitive-local --no-unal --seed 4 -1 /nephele_data/outputs/TED_out/S28_R1_ted.fastq.gz -2 /nephele_data/outputs/TED_out/S28_R2_ted.fastq.gz -x /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.db -S /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.sam -p 16 2>> /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_stats.txt
  0:00:49.249  1127M / 8139M INFO    General                 (stage.cpp                 : 117)   PROCEDURE == Filling coverage indices (PHM) (id: construction:coverage_filling_phm)
  0:00:49.249  1127M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:00:51.087  1243M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 157199715 kmers, 113659712 bytes occupied (5.78422 bits per kmer).
  0:00:51.284  1843M / 8139M INFO    General                 (coverage_hash_map_builder.:  47)   Collecting k-mer coverage information from reads, this takes a while.

    # total reads: 1743714
      # properly mapped reads: 600294 (34.4%)
      # duplicate reads: 0 (0.0%)
      # secondary reads: 0 (0.0%)
      # reads failing QC: 110381 (6.3%)
      # reads failing alignment length: 229583 (13.2%)
      # reads failing edit distance: 749935 (43.0%)
      # reads not properly paired: 53521 (3.1%)

[2023-10-24 17:30:06] INFO: Writing coverage information to file.
  0:00:55.973  1843M / 8139M INFO    General                 (construction.cpp          : 430)   Filling coverage and flanking coverage from PHM
  0:01:03.433  1843M / 8139M INFO    General                 (coverage_filling.hpp      :  82)   Processed 7886772 edges
  0:01:04.190   858M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Gap Closer (id: early_gapcloser)
  0:01:04.194   867M / 8139M INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:01:04.812   935M / 8139M INFO    General                 (gap_closer.cpp            : 101)   Total edges in tip neighborhood: 2964336 out of 7886772, length: 188262274
  0:01:05.084   971M / 8139M INFO    General                 (edge_index.hpp            : 167)   Using small index (max_id = 7926218)
  0:01:05.797   971M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:01:13.879  1064M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 132325219 kmers, 95574496 bytes occupied (5.77816 bits per kmer).
  0:01:14.168  2076M / 8139M INFO    General                 (edge_index_builders.hpp   : 265)   Collecting edge information from graph, this takes a while.
  0:01:19.888  2150M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999484 reads processed
  0:01:21.553  1054M / 8139M INFO    General                 (gap_closer.cpp            : 452)   Initializing gap closer
  0:01:21.558  1054M / 8139M INFO   GapCloser                (gap_closer.cpp            : 359)   Closing short gaps
[2023-10-24 17:30:37] INFO: Coverage information written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_coverage.txt
[2023-10-24 17:30:37] INFO: { Current stage: 0:00:44.128 || Total: 0:00:44.128 }
[Tue Oct 24 17:30:37 2023]
Finished job 111.
44 of 139 steps (32%) done

[Tue Oct 24 17:30:37 2023]
rule gene_prediction:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gff, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.fna
    jobid: 49
    wildcards: sample=S28
    threads: 16

prodigal -p meta -i /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta -f gff -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gff -a /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa -d /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.fna -q
  0:01:30.179  1054M / 8139M INFO   GapCloser                (gap_closer.cpp            : 393)   Closing short gaps complete: filled 638 gaps after checking 73020 candidates
  0:01:30.305  1054M / 8139M INFO    General                 (gap_closer.cpp            : 456)   Gap closer done
  0:01:30.592   859M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Raw Simplification (id: raw_simplification)
  0:01:30.592   859M / 8139M INFO    General                 (simplification.cpp        : 127)   PROCEDURE == Initial cleaning
  0:01:30.592   859M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Self conjugate edge remover
  0:01:30.754   859M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Self conjugate edge remover triggered 8 times
  0:01:30.754   859M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial tip clipper
  0:01:35.100   852M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial tip clipper triggered 559825 times
  0:01:35.102   852M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial ec remover
  0:01:35.686   858M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial ec remover triggered 33604 times
  0:01:35.688   858M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with low flanking coverage
  0:01:36.627   869M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with low flanking coverage triggered 67109 times
  0:01:36.628   869M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Initial isolated edge remover
  0:01:37.890   836M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Initial isolated edge remover triggered 550818 times
  0:01:37.896   796M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Simplification (id: simplification_preliminary)
  0:01:37.896   796M / 8139M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:01:37.896   796M / 8139M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:01:37.896   796M / 8139M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:01:37.896   796M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:01:43.446   751M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 873079 times
  0:01:43.459   751M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:04.584  1334M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 105833 times
  0:02:04.585  1334M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:04.619  1335M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 12 times
  0:02:04.620  1335M / 8139M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:02:04.620  1335M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:04.683  1332M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 3407 times
  0:02:04.684  1332M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:04.697  1332M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 36 times
  0:02:04.698  1332M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:04.880  1332M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 13106 times
  0:02:04.882  1332M / 8139M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:02:04.883  1332M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:04.908  1331M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 1317 times
  0:02:04.910  1331M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:05.020  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 324 times
  0:02:05.024  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:05.039  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 662 times
  0:02:05.041  1333M / 8139M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:02:05.041  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:05.067  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 45 times
  0:02:05.068  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:05.108  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 28 times
  0:02:05.109  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:05.133  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:05.134  1333M / 8139M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 5
  0:02:05.134  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:05.135  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:05.135  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:05.136  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:05.136  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:05.137  1333M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:05.174  1332M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Gap Closer (id: prelim_gapcloser)
  0:02:05.179  1341M / 8139M INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:02:05.235  1349M / 8139M INFO    General                 (gap_closer.cpp            : 101)   Total edges in tip neighborhood: 229699 out of 240822, length: 58717295
  0:02:05.255  1351M / 8139M INFO    General                 (edge_index.hpp            : 167)   Using small index (max_id = 7926218)
  0:02:05.405  1351M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:02:06.843  1373M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 30505815 kmers, 22035874 bytes occupied (5.7788 bits per kmer).
  0:02:06.911  1609M / 8139M INFO    General                 (edge_index_builders.hpp   : 265)   Collecting edge information from graph, this takes a while.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/bowtie2_build.done.
[Tue Oct 24 17:31:30 2023]
Finished job 33.
45 of 139 steps (32%) done

[Tue Oct 24 17:31:30 2023]
rule samtools_to_bam:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.sam
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.bam, /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_colated.bam, /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_fixmate.bam, /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_fixmate_sorted.bam, /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_tmp_markdup.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam
    jobid: 32
    wildcards: sample=S28
    threads: 16

samtools sort /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.sam -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.bam -@ 16 -T /nephele_data/tmp/S28_sort && samtools collate /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.bam -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_colated.bam -@ 16 /nephele_data/tmp/S28_collate && samtools fixmate -m /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_colated.bam /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_fixmate.bam -@ 16 && samtools sort /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_fixmate.bam -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_fixmate_sorted.bam -@ 16 -T /nephele_data/tmp/S28_sort && samtools markdup -r -s /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_fixmate_sorted.bam -f /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_tmp_markdup.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam -@ 16 -T /nephele_data/tmp/S28_markdup && samtools index -b /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam -@ 16
[bam_sort_core] merging from 0 files and 16 in-memory blocks...
  0:02:17.431  1616M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999484 reads processed
  0:02:17.553  1359M / 8139M INFO    General                 (gap_closer.cpp            : 452)   Initializing gap closer
  0:02:17.554  1359M / 8139M INFO   GapCloser                (gap_closer.cpp            : 359)   Closing short gaps
  0:02:17.781  1359M / 8139M INFO   GapCloser                (gap_closer.cpp            : 393)   Closing short gaps complete: filled 45 gaps after checking 31098 candidates
  0:02:17.827  1359M / 8139M INFO    General                 (gap_closer.cpp            : 456)   Gap closer done
  0:02:17.849  1332M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Paired Information Counting (id: late_pair_info_count_preliminary)
  0:02:18.621  1422M / 8139M INFO    General                 (graph_pack.cpp            :  67)   Index refill
  0:02:18.622  1422M / 8139M INFO    General                 (edge_index.hpp            : 156)   Using small index (max_id = 7926218)
  0:02:18.790  1422M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:02:19.805  1445M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 33170737 kmers, 23981558 bytes occupied (5.78379 bits per kmer).
  0:02:19.877  1701M / 8139M INFO    General                 (edge_index_builders.hpp   : 252)   Collecting edge information from graph, this takes a while.
  0:02:20.370  1701M / 8139M INFO    General                 (graph_pack.cpp            :  77)   Normalizing k-mer map. Total 12813430 kmers to process
  0:02:22.657  1701M / 8139M INFO    General                 (graph_pack.cpp            :  79)   Normalizing done
  0:02:22.658  1701M / 8139M INFO    General                 (pair_info_count.cpp       : 339)   Min edge length for estimation: 900
  0:02:22.659  1701M / 8139M INFO    General                 (pair_info_count.cpp       : 350)   Estimating insert size for library #0
  0:02:22.659  1701M / 8139M INFO    General                 (pair_info_count.cpp       : 202)   Estimating insert size (takes a while)
  0:02:22.744  1974M / 8139M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
[bam_sort_core] merging from 0 files and 16 in-memory blocks...
  0:02:30.183  1974M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999484 reads processed
  0:02:31.711  1974M / 8139M INFO    General                 (pair_info_count.cpp       : 220)   Edge pairs: 198513
  0:02:31.712  1974M / 8139M INFO    General                 (pair_info_count.cpp       : 224)   297713 paired reads (29.7867% of all) aligned to long edges
  0:02:31.713  1701M / 8139M INFO    General                 (pair_info_count.cpp       : 373)     Insert size = 266.743, deviation = 27.8862, left quantile = 231, right quantile = 303, read length = 150
  0:02:31.714  1702M / 8139M INFO    General                 (pair_info_count.cpp       : 390)   Filtering data for library #0
  0:02:31.715  1702M / 8139M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.sam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28.bam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_colated.bam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_fixmate.bam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_fixmate_sorted.bam.
[Tue Oct 24 17:31:49 2023]
Finished job 32.
46 of 139 steps (33%) done

[Tue Oct 24 17:31:49 2023]
rule add_de_replication_stats:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_stats.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_tmp_markdup.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/add_de_replication_stats.done
    jobid: 29
    wildcards: sample=S28

cat /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_stats.txt <(printf "\nRead alignment de-replication stats:\n") /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_tmp_markdup.txt > /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_tmp_file.txt && mv /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_tmp_file.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_stats.txt && touch /nephele_data/outputs/asmbMetaSpades/S28_asmb/add_de_replication_stats.done

[Tue Oct 24 17:31:49 2023]
rule checkm_profile:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_coverage.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_profiles.txt
    jobid: 110
    wildcards: sample=S1

checkm profile -q /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_coverage.txt --tab_table -f /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_profiles.txt

[Tue Oct 24 17:31:49 2023]
rule scaffold_and_read_counts:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_basecov.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_idx.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_readcount.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_depths.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov1.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_scaffCoverage.txt
    jobid: 37
    wildcards: sample=S28

/usr/local/src/bbmap/pileup.sh /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam out=/nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov.txt overwrite=true && sort -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov.txt && jgi_summarize_bam_contig_depths /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam --outputDepth /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_depths.txt && sort /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_depths.txt | sed '1 s/^/#/' | cut -f 1-3 > /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_basecov.txt && samtools idxstats /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam > /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_idx.txt && cut -f 1-3 /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_idx.txt | sed -e '1s/^/#contigName\tLength\tReadsCount\n/' | sort | grep -v "*" > /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_readcount.txt && paste /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_readcount.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_basecov.txt | cut -f 1,2,3,8-14,17 -d $'\t' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov1.txt && awk 'BEGIN{FS=OFS="\t"} NR>1 {if ($2>0 && $3>0) $12=sprintf("%0.2f", $3*1e3/$2); else $12=0; print}'  /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov1.txt | sed -e '1s/^/#NODE\tlen\tReads\t\%ScaffCovered\t\%bpCovered\tplusReads\tminusReads\t\%GC\tMedFold\tstDev\tAveDepth\tRPK\n/' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_scaffCoverage.txt
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/S28_tmp_markdup.txt.
[Tue Oct 24 17:31:49 2023]
Finished job 29.
47 of 139 steps (34%) done
java -ea -Xmx75954m -cp /usr/local/src/bbmap/current/ jgi.CoveragePileup /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam out=/nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov.txt overwrite=true
Executing jgi.CoveragePileup [/nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam, out=/nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov.txt, overwrite=true]

Found samtools 1.13
Could not find sambamba.
[Tue Oct 24 17:31:50 2023]
Finished job 110.
48 of 139 steps (35%) done
  0:02:38.528  1702M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999484 reads processed
  0:02:38.529  1702M / 8139M INFO    General                 (pair_info_count.cpp       : 402)   Mapping library #0
  0:02:38.530  1702M / 8139M INFO    General                 (pair_info_count.cpp       : 404)   Mapping paired reads (takes a while)
  0:02:38.530  1702M / 8139M INFO    General                 (pair_info_count.cpp       : 302)   Left insert size quantile 231, right insert size quantile 303, filtering threshold 1, rounding threshold 0
  0:02:38.535  1711M / 8139M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
Reads:                               	1956867
Mapped reads:                        	1956867
Mapped bases:                        	280186656
Ref scaffolds:                       	99753
Ref bases:                           	41131257

Percent mapped:                      	100.000
Percent proper pairs:                	96.801
Average coverage:                    	6.812
Average coverage with deletions:     	6.812
Standard deviation:                    	12.537
Percent scaffolds with any coverage: 	96.12
Percent of reference bases covered:  	94.87

Time: 	5.911 seconds.
Output depth matrix to /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_depths.txt
jgi_summarize_bam_contig_depths v2.15-6-g8b5702b 2022-01-10T22:14:13
Output matrix to /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_depths.txt
0: Opening bam: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam
Processing bam files
  0:02:44.793  1719M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999484 reads processed
  0:02:44.808  1710M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Distance Estimation (id: distance_estimation_preliminary)
  0:02:44.809  1710M / 8139M INFO    General                 (distance_estimation.cpp   : 179)   Processing library #0
  0:02:44.809  1710M / 8139M INFO    General                 (distance_estimation.cpp   : 150)   Weight Filter Done
  0:02:44.810  1710M / 8139M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SIMPLE distance estimator
  0:02:44.929  1712M / 8139M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:02:44.930  1712M / 8139M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 300930
  0:02:45.119  1701M / 8139M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 63186
  0:02:45.122  1693M / 8139M INFO    General                 (distance_estimation.cpp   : 156)   Refining clustered pair information
  0:02:45.140  1693M / 8139M INFO    General                 (distance_estimation.cpp   : 158)   The refining of clustered pair information has been finished
  0:02:45.140  1693M / 8139M INFO    General                 (distance_estimation.cpp   : 160)   Improving paired information
  0:02:45.516  1694M / 8139M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 16261; contradictional = 0
  0:02:45.901  1695M / 8139M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 3940; contradictional = 0
  0:02:45.902  1695M / 8139M INFO    General                 (distance_estimation.cpp   : 104)   Filling scaffolding index
  0:02:45.903  1695M / 8139M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SMOOTHING distance estimator
  0:02:46.003  1695M / 8139M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:02:46.004  1695M / 8139M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 250554
  0:02:46.092  1699M / 8139M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 250554
  0:02:46.093  1695M / 8139M INFO    General                 (distance_estimation.cpp   : 186)   Clearing raw paired index
  0:02:46.109  1687M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Preliminary Repeat Resolving (id: repeat_resolving_preliminary)
  0:02:46.110  1687M / 8139M INFO    General                 (repeat_resolving.cpp      :  74)   Setting up preliminary path extend settings
  0:02:46.110  1687M / 8139M INFO    General                 (repeat_resolving.cpp      :  87)   Using Path-Extend repeat resolving
  0:02:46.111  1687M / 8139M INFO    General                 (launcher.cpp              : 600)   ExSPAnder repeat resolving tool started
  0:02:46.453  2178M / 8139M INFO    General                 (launcher.cpp              : 418)   Creating main extenders, unique edge length = 2000
  0:02:46.454  2178M / 8139M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 103588
  0:02:46.459  2198M / 8139M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 103588
  0:02:46.516  2244M / 8139M INFO    General                 (extenders_logic.cpp       : 543)   Using 1 paired-end library
  0:02:46.518  2244M / 8139M INFO    General                 (extenders_logic.cpp       : 544)   Using 1 paired-end scaffolding library
  0:02:46.518  2244M / 8139M INFO    General                 (extenders_logic.cpp       : 545)   Using 0 single read libraries
  0:02:46.519  2244M / 8139M INFO    General                 (launcher.cpp              : 447)   Total number of extenders is 3
  0:02:46.520  2244M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 0 paths from 120191 (0%)
  0:02:46.539  2246M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 128 paths from 120191 (0%)
  0:02:46.558  2247M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 256 paths from 120191 (0%)
  0:02:46.581  2248M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 512 paths from 120191 (0%)
  0:02:46.609  2251M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 1024 paths from 120191 (0%)
  0:02:46.648  2255M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 2048 paths from 120191 (1%)
  0:02:46.705  2264M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 4096 paths from 120191 (3%)
  0:02:46.790  2281M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 8192 paths from 120191 (6%)
  0:02:46.856  2296M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 12020 paths from 120191 (10%)
  0:02:46.928  2313M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 16384 paths from 120191 (13%)
  0:02:47.035  2343M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 24040 paths from 120191 (20%)
  0:02:47.092  2377M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 32768 paths from 120191 (27%)
  0:02:47.114  2390M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 36060 paths from 120191 (30%)
  0:02:47.185  2437M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 48080 paths from 120191 (40%)
  0:02:47.249  2485M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 60100 paths from 120191 (50%)
  0:02:47.278  2506M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 65536 paths from 120191 (54%)
  0:02:47.312  2533M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 72120 paths from 120191 (60%)
  0:02:47.371  2580M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 84140 paths from 120191 (70%)
  0:02:47.439  2627M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 96160 paths from 120191 (80%)
  0:02:47.522  2674M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 108180 paths from 120191 (90%)
  0:02:47.737  2720M / 8139M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:02:47.739  2720M / 8139M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:02:47.805  2714M / 8139M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:02:47.806  2714M / 8139M INFO    General                 (launcher.cpp              : 263)   Overlaps will not be removed
  0:02:47.948  2714M / 8139M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:02:47.950  2714M / 8139M INFO    General                 (launcher.cpp              : 454)   Closing gaps in paths
  0:02:48.345  3164M / 8139M INFO    General                 (launcher.cpp              : 484)   Gap closing completed
  0:02:48.403  3188M / 8139M INFO    General                 (launcher.cpp              : 302)   Traversing tandem repeats
  0:02:49.060  3188M / 8139M INFO    General                 (launcher.cpp              : 312)   Traversed 5 loops
  0:02:49.063  3188M / 8139M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:02:49.065  3188M / 8139M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:02:49.131  3188M / 8139M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:02:49.134  3188M / 8139M INFO    General                 (launcher.cpp              : 263)   Overlaps will not be removed
  0:02:49.280  3188M / 8139M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:02:49.282  3188M / 8139M INFO    General                 (launcher.cpp              : 664)   ExSPAnder repeat resolving tool finished
  0:02:49.568  2136M / 8139M INFO    General                 (repeat_resolving.cpp      :  93)   Restoring initial path extend settings
  0:02:49.570  2136M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:02:49.571  2136M / 8139M INFO    General                 (contig_output_stage.cpp   : 151)   Writing GFA graph to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/strain_graph.gfa
  0:02:49.879  2136M / 8139M INFO    General                 (contig_output_stage.cpp   : 196)   Breaking scaffolds
  0:02:50.931  2681M / 8139M INFO    General                 (contig_output_stage.cpp   :  98)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/final_contigs.fasta
  0:02:51.245  2136M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Second Phase Setup (id: second_phase_setup)
  0:02:51.247  2136M / 8139M INFO    General                 (second_phase_setup.cpp    :  18)   Preparing second phase
  0:02:51.470  1614M / 8139M INFO    General                 (second_phase_setup.cpp    :  26)   Moving preliminary contigs from /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/final_contigs.fasta to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/first_pe_contigs.fasta
  0:02:51.474  1614M / 8139M INFO    General                 (second_phase_setup.cpp    :  38)   Ready to run second phase
  0:02:51.475  1614M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification (id: simplification)
  0:02:51.476  1334M / 8139M INFO    General                 (simplification.cpp        : 368)   Graph simplification started
  0:02:51.477  1334M / 8139M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:02:51.477  1334M / 8139M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 1
  0:02:51.478  1334M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:51.500  1334M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:51.501  1334M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:51.855  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 1277 times
  0:02:51.856  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:51.877  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:51.877  1346M / 8139M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 2
  0:02:51.878  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:51.879  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 14 times
  0:02:51.879  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:51.880  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:51.880  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:51.881  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:51.881  1346M / 8139M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 3
  0:02:51.881  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:51.882  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:51.882  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:51.883  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:51.883  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:51.884  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:51.884  1346M / 8139M INFO    General                 (simplification.cpp        : 373)   PROCEDURE == Simplification cycle, iteration 4
  0:02:51.884  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:02:51.906  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:02:51.907  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:02:51.929  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:02:51.930  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Low coverage edge remover
  0:02:51.949  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Low coverage edge remover triggered 0 times
  0:02:51.980  1346M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Gap Closer (id: late_gapcloser)
  0:02:51.984  1355M / 8139M INFO    General                 (edge_index.hpp            : 115)   Size of edge index entries: 12/8
  0:02:52.028  1360M / 8139M INFO    General                 (gap_closer.cpp            : 101)   Total edges in tip neighborhood: 226269 out of 233056, length: 59728572
  0:02:52.038  1362M / 8139M INFO    General                 (edge_index.hpp            : 167)   Using small index (max_id = 7926218)
  0:02:52.129  1362M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:02:52.923  1383M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 30699527 kmers, 22192006 bytes occupied (5.78302 bits per kmer).
  0:02:52.990  1620M / 8139M INFO    General                 (edge_index_builders.hpp   : 265)   Collecting edge information from graph, this takes a while.
  0:03:00.356  1627M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999484 reads processed
  0:03:00.475  1372M / 8139M INFO    General                 (gap_closer.cpp            : 452)   Initializing gap closer
  0:03:00.476  1372M / 8139M INFO   GapCloser                (gap_closer.cpp            : 359)   Closing short gaps
  0:03:00.695  1372M / 8139M INFO   GapCloser                (gap_closer.cpp            : 393)   Closing short gaps complete: filled 0 gaps after checking 30763 candidates
  0:03:00.730  1372M / 8139M INFO    General                 (gap_closer.cpp            : 456)   Gap closer done
  0:03:00.750  1346M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Simplification Cleanup (id: simplification_cleanup)
  0:03:00.751  1346M / 8139M INFO    General                 (simplification.cpp        : 176)   PROCEDURE == Post simplification
  0:03:00.752  1346M / 8139M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:03:00.752  1346M / 8139M INFO    General                 (graph_simplification.hpp  : 634)   Creating parallel br instance
  0:03:00.753  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:03:00.781  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 208 times
  0:03:00.782  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:03:00.805  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 40 times
  0:03:00.805  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:03:00.839  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 2 times
  0:03:00.840  1346M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
[Tue Oct 24 17:32:14 2023]
Finished job 49.
49 of 139 steps (35%) done

[Tue Oct 24 17:32:14 2023]
rule gff_to_gtf:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gff
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gtf
    jobid: 48
    wildcards: sample=S28

/usr/local/src/nephele2/pipelines/wgsa/gff2gtf.sh /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gff > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gtf

[Tue Oct 24 17:32:14 2023]
rule tax_classification_genes:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.fna
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_taxREPORT.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_classLOG.txt
    jobid: 95
    wildcards: sample=S28
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --threads 16  --db /mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 --confidence 0.05 /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.fna --memory-mapping --output /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt --report /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_taxREPORT.txt 2>> /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_classLOG.txt
[Tue Oct 24 17:32:14 2023]
Finished job 48.
50 of 139 steps (36%) done
  0:03:01.538  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 101 times
  0:03:01.539  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:03:01.566  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 15 times
  0:03:01.567  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:03:01.594  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 259 times
  0:03:01.595  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:03:01.620  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 5 times
  0:03:01.620  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final bulge remover
  0:03:01.684  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Final bulge remover triggered 20 times
  0:03:01.685  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:03:01.706  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:03:01.707  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:03:01.730  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 1 times
  0:03:01.731  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:03:01.755  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:03:01.756  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:03:01.795  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:03:01.796  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
  0:03:02.395  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:03:02.396  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:03:02.418  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 8 times
  0:03:02.419  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:03:02.440  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 2 times
  0:03:02.441  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:03:02.463  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:03:02.464  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final bulge remover
  0:03:02.487  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Final bulge remover triggered 0 times
  0:03:02.488  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:03:02.507  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:03:02.508  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Relative coverage component remover
  0:03:02.529  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Relative coverage component remover triggered 0 times
  0:03:02.530  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Disconnecting edges with relatively low coverage
  0:03:02.530  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Disconnecting edges with relatively low coverage triggered 0 times
  0:03:02.531  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex tip clipper
  0:03:02.564  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex tip clipper triggered 0 times
  0:03:02.565  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Complex bulge remover
[Tue Oct 24 17:32:16 2023]
Finished job 95.
51 of 139 steps (37%) done

[Tue Oct 24 17:32:16 2023]
rule run_verse:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gtf, /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/verse.CDS.summary.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/verse.CDS.txt
    jobid: 47
    wildcards: sample=S28
    threads: 16

verse -a /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gtf -t 'CDS' -g gene_id -z 0 -s 0 -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/verse /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam -T 4
  0:03:03.163  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Complex bulge remover triggered 0 times
  0:03:03.164  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Tip clipper
  0:03:03.164  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Tip clipper triggered 0 times
  0:03:03.165  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final tip clipper
  0:03:03.165  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Final tip clipper triggered 0 times
  0:03:03.166  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Bulge remover
  0:03:03.166  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Bulge remover triggered 0 times
  0:03:03.166  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Final bulge remover
  0:03:03.167  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Final bulge remover triggered 0 times
  0:03:03.167  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Thorn remover (meta)
  0:03:03.168  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Thorn remover (meta) triggered 0 times
  0:03:03.168  1348M / 8139M INFO    General                 (simplification.cpp        : 323)   Running Hidden EC remover (meta)
  0:03:03.205  1348M / 8139M INFO    General                 (simplification.cpp        : 327)   Disrupting self-conjugate edges
  0:03:03.283  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 167)   Running Removing isolated edges
  0:03:03.323  1348M / 8139M INFO   Simplification           (parallel_processing.hpp   : 170)   Removing isolated edges triggered 13748 times
  0:03:03.324  1347M / 8139M INFO    General                 (simplification.cpp        : 491)   Counting average coverage
  0:03:03.366  1347M / 8139M INFO    General                 (simplification.cpp        : 497)   Average coverage = 2.22805
  0:03:03.367  1347M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Mismatch Correction (id: mismatch_correction)
  0:03:03.368  1347M / 8139M INFO    General                 (graph_pack.cpp            :  67)   Index refill
  0:03:03.368  1347M / 8139M INFO    General                 (edge_index.hpp            : 156)   Using small index (max_id = 7926218)
  0:03:03.473  1347M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 395)   Building perfect hash indices
  0:03:04.243  1369M / 8139M INFO   K-mer Index Building     (kmer_index_builder.hpp    : 431)   Index built. Total 31229217 kmers, 22567182 bytes occupied (5.78104 bits per kmer).
  0:03:04.311  1610M / 8139M INFO    General                 (edge_index_builders.hpp   : 252)   Collecting edge information from graph, this takes a while.
  0:03:04.770  1610M / 8139M INFO    General                 (graph_pack.cpp            :  77)   Normalizing k-mer map. Total 13108666 kmers to process
  0:03:07.072  1610M / 8139M INFO    General                 (graph_pack.cpp            :  79)   Normalizing done
  0:03:07.073  1610M / 8139M INFO    General                 (mismatch_correction.cpp   : 400)   Collect potential mismatches

        ===      ===    %%  %%  %%%%%%  %%   %%  %%       %%%%   %%%%%   
         ==      ==     %% %%     %%    %%% %%%  %%      %%  %%  %%  %%  
          ==    ==      %%%%      %%    %% % %%  %%      %%%%%%  %%%%%   
           ==  ==       %% %%     %%    %%   %%  %%      %%  %%  %%  %%  
            ====        %%  %%  %%%%%%  %%   %%  %%%%%%  %%  %%  %%%%%   
             ==        ................................................. 
	  v0.1.5

//============================== VERSE setting ===============================\\
||            Running mode : Default(featureCounts)                           ||
||            Feature type : CDS                                              ||
||              Input file : 1 BAM file                                       ||
||                           P /nephele_data/outputs/asmbMetaSpades/S28_a ... ||
||             Output file : /nephele_data/outputs/asmbMetaSpades/S28_asm ... ||
||         Annotation file : /nephele_data/outputs/asmbMetaSpades/S28_asm ... ||
||                                                                            ||
||                 Threads : 4                                                ||
|| Multithreaded BAM unzip : no                                               ||
||                                                                            ||
||              Paired-end : yes                                              ||
||         Strand specific : no                                               ||
||      Multimapping reads : not counted                                      ||
||                                                                            ||
||          Chimeric reads : counted                                          ||
||        Both ends mapped : not required                                     ||
||                                                                            ||
\\============= Based on the framework of featureCounts(SUBREAD) =============//

//================================= Running ==================================\\
||                                                                            ||
|| Load annotation file /nephele_data/outputs/asmbMetaSpades/S28_asmb/gen ... ||
||    CDSs : 115248                                                           ||
||    CDSs after merge : 115248                                               ||
||    Genes : 115248                                                          ||
||    Chromosomes : 95336                                                     ||
||                                                                            ||
|| Process BAM file /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.a ... ||
||    Quantifying in paired-end mode.                                         ||
||    Assign read pairs to features...                                        ||
||    Read pairs with missing mates : 1881207                                 ||
||    Total read pairs : 1919037                                              ||
||    Successfully assigned read pairs : 1656516 (86.3%)                      ||
||    Running time : 0.07 minutes                                             ||
||                                                                            ||
||                         Read assignment finished.                          ||
||                                                                            ||
\\====== VERSE: a Versatile and Efficient Rna-SEq read assignment tool =======//

[Tue Oct 24 17:32:21 2023]
Finished job 47.
52 of 139 steps (37%) done

[Tue Oct 24 17:32:21 2023]
rule tax_classification_scaffolds:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_taxREPORT.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAXclassLOG.txt
    jobid: 105
    wildcards: sample=S28
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --db /mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 --confidence 0.05 --memory-mapping --threads 16 /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta --output /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_klog.txt --report /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_taxREPORT.txt 2>> /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAXclassLOG.txt

[Tue Oct 24 17:32:21 2023]
rule rename_verse_summary:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/verse.CDS.summary.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_stats.txt
    jobid: 46
    wildcards: sample=S28

mv /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/verse.CDS.summary.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_stats.txt

[Tue Oct 24 17:32:21 2023]
rule tpm_normalization:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gtf, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/verse.CDS.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_lengths.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_counts.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_coverage.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_RPK.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_ABUNtab.txt
    jobid: 69
    wildcards: sample=S28

cut -f4,5,9 /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.gtf | sed 's/gene_id //g' | gawk '{print $3,$2-$1+1}' | tr ' ' '\t' | sed '1s/^/gene\tlength\n/' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_lengths.txt && join /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_lengths.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/verse.CDS.txt -t $'\t' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_counts.txt && grep "_" /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_counts.txt   | awk -v OFS="\t" '{$4 = sprintf("%0.0f", $3*150/$2)}1' | sort | sed -e '1s/^/#name\tlen\treads\tcov\n/' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_coverage.txt && grep "_" /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_coverage.txt | awk -v OFS="\t" '{$5 = sprintf("%0.0f", $3*1e3/$2)}1' | sort | sed -e '1s/^/#name\tlen\treads\tcov\tRPK\n/' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_RPK.txt && awk -v OFS="\t" 'NR==FNR{sum+= $5; next} FNR==1{print $0,"iTPM"; next} {printf("%s %0.0f\n", $0,$5*1e6/sum)}'  /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_RPK.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_RPK.txt |sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_ABUNtab.txt  
[Tue Oct 24 17:32:21 2023]
Finished job 46.
53 of 139 steps (38%) done
  0:03:09.064  1612M / 8139M INFO    General                 (mismatch_correction.cpp   : 193)   Total 13508 edges (out of 202518) with 320032 potential mismatch positions (23.692 positions per edge)
  0:03:09.066  1612M / 8139M INFO    General                 (mismatch_correction.cpp   : 402)   Potential mismatches collected
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/verse.CDS.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_lengths.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_counts.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_coverage.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/tmp_RPK.txt.
[Tue Oct 24 17:32:22 2023]
Finished job 69.
54 of 139 steps (39%) done

[Tue Oct 24 17:32:22 2023]
rule tax_genes_ABUNtabtax:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_ABUNtab.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt
    jobid: 94
    wildcards: sample=S28

cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt | sed -e 's/ (taxid /\t/g' | sed -e 's/)$//g' | sort | sed '1s/^/#contigName\tTAXname\tTAXid\n/' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt &&paste /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_ABUNtab.txt <(cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt) > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt 
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt.
[Tue Oct 24 17:32:23 2023]
Finished job 94.
55 of 139 steps (40%) done

[Tue Oct 24 17:32:23 2023]
rule tax_genes_4krona:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt
    output: /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S28_4krona.txt
    jobid: 99
    wildcards: sample=S28

cut -f6-8 /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt | awk -F'\t' 'NR>1{k = $3; sum[k]+= $1; name[k]=$2} END { print; for (k in sum) print sum[k], name[k], k}' OFS="	" |sed -e '1 s/^/#iTPM\tTAXname\tTAXid\n/' > /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S28_4krona.txt
[Tue Oct 24 17:32:23 2023]
Finished job 99.
56 of 139 steps (40%) done
[Tue Oct 24 17:32:23 2023]
Finished job 105.
57 of 139 steps (41%) done

[Tue Oct 24 17:32:23 2023]
rule run_amrfinder:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/AMRs/AMRs.faa, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/AMRs/AMRs_info.txt
    jobid: 87
    wildcards: sample=S1
    threads: 16

[33mJob counts:
	count	jobs
	1	run_amrfinder
	1[0m
[33mamrfinder --plus --protein /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa --threads 16 --protein_output /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/AMRs/AMRs.faa -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/AMRs/AMRs_info.txt[0m
Running: amrfinder --plus --protein /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa --threads 16 --protein_output /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/AMRs/AMRs.faa -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/AMRs/AMRs_info.txt
Software directory: '/usr/local/src/amrfinder/'
Software version: 3.10.18
Database directory: '/usr/local/src/amrfinder/data/2021-12-21.1'
Database version: 2021-12-21.1
AMRFinder protein-only search
  - include -n NUC_FASTA, --nucleotide NUC_FASTA and -g GFF_FILE, --gff GFF_FILE options to add translated searches
  - include -O ORGANISM, --organism ORGANISM option to add mutation searches and suppress common proteins
Running blastp...
Thread 0 finished: final.assembly.bam with 1956867 reads and 915068 readsWellMapped
Creating depth matrix file: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_depths.txt
Closing most bam files
Closing last bam file
Finished
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_basecov.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_idx.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_readcount.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/tmp_scaffcov1.txt.
[Tue Oct 24 17:32:31 2023]
Finished job 37.
58 of 139 steps (42%) done

[Tue Oct 24 17:32:31 2023]
rule generate_scafftax:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_scaffCoverage.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_scaffCovr+tax.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt
    jobid: 104
    wildcards: sample=S28

cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_klog.txt | sed -e 's/ (taxid /\t/g' | sed -e 's/)$//g' | sort | sed '1s/^/#contigName\tTAXname\tTAXid\n/' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt && paste /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_scaffCoverage.txt <(cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt) > /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_scaffCovr+tax.txt
  0:03:17.927  1626M / 8139M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 200000 reads
  0:03:17.944  1640M / 8139M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 400000 reads
  0:03:17.968  1654M / 8139M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 600000 reads
  0:03:18.024  1667M / 8139M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 800000 reads
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_klog.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt.
[Tue Oct 24 17:32:31 2023]
Finished job 104.
59 of 139 steps (42%) done

[Tue Oct 24 17:32:31 2023]
rule metabat2_run:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta, /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_depths.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/metabat2_run.done
    jobid: 121
    wildcards: sample=S28
    threads: 16

metabat2 -i /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.fasta -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/mag -m 1500 --maxEdges 250 --unbinned  -t 16 -a /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_depths.txt && touch /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/metabat2_run.done
  0:03:18.062  1681M / 8139M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 1000000 reads
MetaBAT 2 (v2.15-6-g8b5702b) using minContig 1500, minCV 1.0, minCVSum 1.0, maxP 95%, minS 60, maxEdges 250 and minClsSize 200000. with random seed=1698183151
  0:03:18.070  1695M / 8139M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 1200000 reads
  0:03:18.135  1709M / 8139M INFO    General                 (sequence_mapper_notifier.h:  77)   Processed 2200000 reads
1 bins (2548112 bases in total) formed.
[Tue Oct 24 17:32:32 2023]
Finished job 121.
60 of 139 steps (43%) done

[Tue Oct 24 17:32:32 2023]
rule checkm_coverage:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/metabat2_run.done
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_coverage.txt
    jobid: 123
    wildcards: sample=S28
    threads: 16

checkm coverage -x fa -t 16 /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_coverage.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam 2>/dev/null
[2023-10-24 17:32:33] INFO: CheckM v1.1.3
[2023-10-24 17:32:33] INFO: checkm coverage -x fa -t 16 /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_coverage.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly.bam
[2023-10-24 17:32:33] INFO: [CheckM - coverage] Calculating coverage of sequences.
[2023-10-24 17:32:33] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:32:33] INFO: Determining bin assignment of each sequence.
[2023-10-24 17:32:33] INFO: Processing 1 file(s) with 16 threads.

[2023-10-24 17:32:33] INFO: Processing final.assembly.bam (1 of 1):
  0:03:20.698  1882M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 3997936 reads processed
  0:03:23.750  1638M / 8139M INFO    General                 (mismatch_correction.cpp   : 395)   All edges processed
  0:03:23.756  1611M / 8139M INFO    General                 (mismatch_correction.cpp   : 450)   Corrected 343 nucleotides
  0:03:23.757  1611M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:03:23.758  1611M / 8139M INFO    General                 (contig_output.hpp         :  16)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/before_rr.fasta
  0:03:24.278  1611M / 8139M INFO    General                 (contig_output_stage.cpp   : 151)   Writing GFA graph to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/assembly_graph_after_simplification.gfa
  0:03:24.552  1611M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Paired Information Counting (id: late_pair_info_count)
  0:03:25.213  1686M / 8139M INFO    General                 (graph_pack.cpp            :  77)   Normalizing k-mer map. Total 13130870 kmers to process

    # total reads: 1956867
      # properly mapped reads: 619218 (31.6%)
      # duplicate reads: 0 (0.0%)
      # secondary reads: 0 (0.0%)
      # reads failing QC: 111388 (5.7%)
      # reads failing alignment length: 236595 (12.1%)
      # reads failing edit distance: 956231 (48.9%)
      # reads not properly paired: 33435 (1.7%)

[2023-10-24 17:32:40] INFO: Writing coverage information to file.
  0:03:27.572  1686M / 8139M INFO    General                 (graph_pack.cpp            :  79)   Normalizing done
  0:03:27.573  1686M / 8139M INFO    General                 (pair_info_count.cpp       : 339)   Min edge length for estimation: 900
  0:03:27.574  1686M / 8139M INFO    General                 (pair_info_count.cpp       : 350)   Estimating insert size for library #0
  0:03:27.574  1686M / 8139M INFO    General                 (pair_info_count.cpp       : 202)   Estimating insert size (takes a while)
  0:03:27.670  1958M / 8139M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:34.523  1958M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999484 reads processed
  0:03:36.052  1958M / 8139M INFO    General                 (pair_info_count.cpp       : 220)   Edge pairs: 145078
  0:03:36.053  1958M / 8139M INFO    General                 (pair_info_count.cpp       : 224)   312484 paired reads (31.2645% of all) aligned to long edges
  0:03:36.054  1686M / 8139M INFO    General                 (pair_info_count.cpp       : 373)     Insert size = 266.72, deviation = 27.8828, left quantile = 231, right quantile = 303, read length = 150
  0:03:36.055  1687M / 8139M INFO    General                 (pair_info_count.cpp       : 390)   Filtering data for library #0
  0:03:36.055  1687M / 8139M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:42.519  1687M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999484 reads processed
  0:03:42.520  1687M / 8139M INFO    General                 (pair_info_count.cpp       : 402)   Mapping library #0
  0:03:42.520  1687M / 8139M INFO    General                 (pair_info_count.cpp       : 404)   Mapping paired reads (takes a while)
  0:03:42.521  1687M / 8139M INFO    General                 (pair_info_count.cpp       : 302)   Left insert size quantile 231, right insert size quantile 303, filtering threshold 1, rounding threshold 0
  0:03:42.525  1696M / 8139M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
[2023-10-24 17:32:58] INFO: Coverage information written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_coverage.txt
[2023-10-24 17:32:58] INFO: { Current stage: 0:00:24.757 || Total: 0:00:24.757 }
[Tue Oct 24 17:32:58 2023]
Finished job 123.
61 of 139 steps (44%) done

[Tue Oct 24 17:32:58 2023]
rule gene_annotation:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.hits, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.seed_orthologs, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.annotations
    jobid: 54
    wildcards: sample=S1
    threads: 16
    resources: mem_gb=186

emapper.py -i /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa -o annots --output_dir /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ --cpu 16 --itype proteins --block_size 4 --index_chunks 2 --data_dir /mnt/EFS/dbs/wgsa2/eggnog_data --override --temp_dir /nephele_data/tmp/  --scratch_dir /nephele_data/tmp/ --dbmem
  0:03:49.245  1701M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 999484 reads processed
  0:03:49.258  1693M / 8139M INFO    General                 (pair_info_count.cpp       : 346)   Mapping contigs library #1
  0:03:49.259  1693M / 8139M INFO    General                 (pair_info_count.cpp       :  48)   Selecting usual mapper
  0:03:52.475  1709M / 8139M INFO    General                 (sequence_mapper_notifier.h:  95)   Total 114549 reads processed
  0:03:52.476  1709M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Distance Estimation (id: distance_estimation)
  0:03:52.476  1709M / 8139M INFO    General                 (distance_estimation.cpp   : 179)   Processing library #0
  0:03:52.477  1709M / 8139M INFO    General                 (distance_estimation.cpp   : 150)   Weight Filter Done
  0:03:52.477  1709M / 8139M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SIMPLE distance estimator
  0:03:52.564  1710M / 8139M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:03:52.565  1710M / 8139M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 231670
  0:03:52.722  1697M / 8139M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 41316
  0:03:52.725  1693M / 8139M INFO    General                 (distance_estimation.cpp   : 156)   Refining clustered pair information
  0:03:52.739  1693M / 8139M INFO    General                 (distance_estimation.cpp   : 158)   The refining of clustered pair information has been finished
  0:03:52.740  1693M / 8139M INFO    General                 (distance_estimation.cpp   : 160)   Improving paired information
  0:03:52.991  1694M / 8139M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 8853; contradictional = 0
  0:03:53.244  1695M / 8139M INFO   PairInfoImprover         (pair_info_improver.hpp    : 105)   Paired info stats: missing = 1949; contradictional = 0
  0:03:53.245  1695M / 8139M INFO    General                 (distance_estimation.cpp   : 104)   Filling scaffolding index
  0:03:53.246  1695M / 8139M INFO   DistanceEstimator        (distance_estimation.hpp   : 116)   Using SMOOTHING distance estimator
  0:03:53.332  1695M / 8139M INFO    General                 (distance_estimation.cpp   :  37)   Filtering info
  0:03:53.333  1695M / 8139M INFO    General                 (pair_info_filters.hpp     : 242)   Start filtering; library index size: 211180
  0:03:53.411  1699M / 8139M INFO    General                 (pair_info_filters.hpp     : 263)   Done filtering; library index size: 211180
  0:03:53.412  1695M / 8139M INFO    General                 (distance_estimation.cpp   : 186)   Clearing raw paired index
  0:03:53.424  1689M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Repeat Resolving (id: repeat_resolving)
  0:03:53.425  1689M / 8139M INFO    General                 (repeat_resolving.cpp      :  87)   Using Path-Extend repeat resolving
  0:03:53.426  1689M / 8139M INFO    General                 (launcher.cpp              : 600)   ExSPAnder repeat resolving tool started
  0:03:53.683  2095M / 8139M INFO    General                 (launcher.cpp              : 418)   Creating main extenders, unique edge length = 2000
  0:03:53.685  2115M / 8139M INFO    General                 (launcher.cpp              : 342)   filling path container
  0:03:53.697  2120M / 8139M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 62920
  0:03:53.699  2130M / 8139M INFO    General                 (extenders_logic.cpp       : 345)   Creating extender; library index size: 62920
  0:03:53.743  2156M / 8139M INFO    General                 (extenders_logic.cpp       :  47)   resolvable_repeat_length_bound set to 10000
  0:03:53.814  2175M / 8139M INFO    General                 (extenders_logic.cpp       : 543)   Using 1 paired-end library
  0:03:53.815  2175M / 8139M INFO    General                 (extenders_logic.cpp       : 544)   Using 1 paired-end scaffolding library
  0:03:53.816  2175M / 8139M INFO    General                 (extenders_logic.cpp       : 545)   Using 1 single read library
  0:03:53.866  2175M / 8139M INFO    General                 (launcher.cpp              : 385)   Filling backbone edges for long reads scaffolding...
  0:03:53.868  2175M / 8139M INFO    General                 (launcher.cpp              : 387)    with long reads paths
  0:03:53.869  2175M / 8139M INFO    General                 (launcher.cpp              : 396)   Removing fake unique with paired-end libs
  0:03:53.869  2175M / 8139M INFO    General                 (launcher.cpp              : 407)   0 unique edges
  0:03:53.870  2175M / 8139M INFO    General                 (extenders_logic.cpp       : 446)   Using 0 long reads scaffolding libraries
  0:03:53.871  2175M / 8139M INFO    General                 (extenders_logic.cpp       : 456)   Using additional coordinated coverage extender
  0:03:53.872  2185M / 8139M INFO    General                 (launcher.cpp              : 447)   Total number of extenders is 5
  0:03:53.872  2185M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 0 paths from 101086 (0%)
  0:03:53.907  2188M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 128 paths from 101086 (0%)
  0:03:53.926  2189M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 256 paths from 101086 (0%)
  0:03:53.950  2190M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 512 paths from 101086 (0%)
  0:03:53.975  2192M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 1024 paths from 101086 (1%)
  0:03:54.011  2197M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 2048 paths from 101086 (2%)
  0:03:54.069  2205M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 4096 paths from 101086 (4%)
  0:03:54.152  2221M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 8192 paths from 101086 (8%)
  0:03:54.186  2229M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 10109 paths from 101086 (10%)
  0:03:54.291  2254M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 16384 paths from 101086 (16%)
  0:03:54.349  2269M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 20218 paths from 101086 (20%)
  0:03:54.442  2308M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 30327 paths from 101086 (30%)
  0:03:54.460  2317M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 32768 paths from 101086 (32%)
  0:03:54.507  2348M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 40436 paths from 101086 (40%)
  0:03:54.569  2387M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 50545 paths from 101086 (50%)
  0:03:54.626  2427M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 60654 paths from 101086 (60%)
  0:03:54.656  2446M / 8139M INFO    General                 (path_extenders.cpp        :  34)   Processed 65536 paths from 101086 (64%)
  0:03:54.687  2467M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 70763 paths from 101086 (70%)
  0:03:54.742  2506M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 80872 paths from 101086 (80%)
  0:03:54.800  2546M / 8139M INFO    General                 (path_extenders.cpp        :  36)   Processed 90981 paths from 101086 (90%)
  0:03:54.905  2583M / 8139M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:03:54.906  2583M / 8139M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:03:54.958  2582M / 8139M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:03:54.959  2582M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  60)   Removing overlaps
  0:03:54.960  2582M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  70)   Marking overlaps
  0:03:54.961  2582M / 8139M INFO   OverlapRemover           (overlap_remover.hpp       : 116)   Marking start/end overlaps
  0:03:55.055  2582M / 8139M INFO   OverlapRemover           (overlap_remover.hpp       : 119)   Marking remaining overlaps
  0:03:55.149  2582M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  73)   Splitting paths
  0:03:55.167  2589M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  78)   Deduplicating paths
  0:03:55.220  2583M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  80)   Overlaps removed
  0:03:55.348  2583M / 8139M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:03:55.350  2583M / 8139M INFO    General                 (launcher.cpp              : 454)   Closing gaps in paths
  0:03:55.686  2966M / 8139M INFO    General                 (launcher.cpp              : 484)   Gap closing completed
  0:03:55.734  2979M / 8139M INFO    General                 (launcher.cpp              : 302)   Traversing tandem repeats
  0:03:56.327  2979M / 8139M INFO    General                 (launcher.cpp              : 312)   Traversed 12 loops
  0:03:56.329  2979M / 8139M INFO    General                 (launcher.cpp              : 250)   Finalizing paths
  0:03:56.331  2979M / 8139M INFO    General                 (launcher.cpp              : 252)   Deduplicating paths
  0:03:56.385  2979M / 8139M INFO    General                 (launcher.cpp              : 256)   Paths deduplicated
  0:03:56.387  2979M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  60)   Removing overlaps
  0:03:56.389  2979M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  70)   Marking overlaps
  0:03:56.390  2979M / 8139M INFO   OverlapRemover           (overlap_remover.hpp       : 116)   Marking start/end overlaps
  0:03:56.506  2979M / 8139M INFO   OverlapRemover           (overlap_remover.hpp       : 119)   Marking remaining overlaps
  0:03:56.611  2979M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  73)   Splitting paths
  0:03:56.630  2980M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  78)   Deduplicating paths
  0:03:56.693  2980M / 8139M INFO   PEResolver               (pe_resolver.cpp           :  80)   Overlaps removed
  0:03:56.850  2980M / 8139M INFO    General                 (launcher.cpp              : 273)   Paths finalized
  0:03:56.853  2980M / 8139M INFO    General                 (launcher.cpp              : 664)   ExSPAnder repeat resolving tool finished
  0:03:57.128  2072M / 8139M INFO   StageManager             (stage.cpp                 : 185)   STAGE == Contig Output (id: contig_output)
  0:03:57.132  2072M / 8139M INFO    General                 (contig_output.hpp         :  16)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/before_rr.fasta
  0:03:57.719  2072M / 8139M INFO    General                 (contig_output_stage.cpp   : 151)   Writing GFA graph to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/assembly_graph_with_scaffolds.gfa
  0:03:58.010  2072M / 8139M INFO    General                 (contig_output_stage.cpp   : 165)   Outputting FastG graph to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/assembly_graph.fastg
  0:03:59.058  2072M / 8139M INFO    General                 (contig_output_stage.cpp   : 196)   Breaking scaffolds
  0:03:59.909  2529M / 8139M INFO    General                 (contig_output_stage.cpp   :  98)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/final_contigs.fasta
  0:04:00.083  2529M / 8139M INFO    General                 (contig_output_stage.cpp   : 104)   Outputting FastG paths to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/final_contigs.paths
  0:04:00.732  2127M / 8139M INFO    General                 (contig_output_stage.cpp   :  98)   Outputting contigs to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/scaffolds.fasta
  0:04:00.906  2127M / 8139M INFO    General                 (contig_output_stage.cpp   : 104)   Outputting FastG paths to /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/scaffolds.paths
  0:04:01.039  2127M / 8139M INFO    General                 (contig_output_stage.cpp   : 111)   Populating GFA with scaffold paths
  0:04:01.140  2072M / 8139M INFO    General                 (pipeline.cpp              : 287)   SPAdes finished
  0:04:02.749     1M / 8139M INFO    General                 (main.cpp                  : 136)   Assembling time: 0 hours 4 minutes 2 seconds

===== K55 finished. 


===== Copy files started. 


== Running: /usr/bin/python3 /usr/local/src/SPAdes/share/spades/spades_pipeline/scripts/copy_files.py /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/before_rr.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/before_rr.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/assembly_graph_after_simplification.gfa /nephele_data/outputs/asmbMetaSpades/S6_asmb/assembly_graph_after_simplification.gfa /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/final_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/contigs.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/first_pe_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/first_pe_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/strain_graph.gfa /nephele_data/outputs/asmbMetaSpades/S6_asmb/strain_graph.gfa /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/scaffolds.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffolds.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/scaffolds.paths /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffolds.paths /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/assembly_graph_with_scaffolds.gfa /nephele_data/outputs/asmbMetaSpades/S6_asmb/assembly_graph_with_scaffolds.gfa /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/assembly_graph.fastg /nephele_data/outputs/asmbMetaSpades/S6_asmb/assembly_graph.fastg /nephele_data/outputs/asmbMetaSpades/S6_asmb/K55/final_contigs.paths /nephele_data/outputs/asmbMetaSpades/S6_asmb/contigs.paths


===== Copy files finished. 


===== Assembling finished. 


===== Breaking scaffolds started. 


== Running: /usr/bin/python3 /usr/local/src/SPAdes/share/spades/spades_pipeline/scripts/breaking_scaffolds_script.py --result_scaffolds_filename /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffolds.fasta --misc_dir /nephele_data/outputs/asmbMetaSpades/S6_asmb/misc --threshold_for_breaking_scaffolds 3


===== Breaking scaffolds finished. 


===== Terminate started. 


===== Terminate finished. 

 * Assembled contigs are in /nephele_data/outputs/asmbMetaSpades/S6_asmb/contigs.fasta
 * Assembled scaffolds are in /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffolds.fasta
 * Paths in the assembly graph corresponding to the contigs are in /nephele_data/outputs/asmbMetaSpades/S6_asmb/contigs.paths
 * Paths in the assembly graph corresponding to the scaffolds are in /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffolds.paths
 * Assembly graph is in /nephele_data/outputs/asmbMetaSpades/S6_asmb/assembly_graph.fastg
 * Assembly graph in GFA format is in /nephele_data/outputs/asmbMetaSpades/S6_asmb/assembly_graph_with_scaffolds.gfa

======= SPAdes pipeline finished.

SPAdes log can be found here: /nephele_data/outputs/asmbMetaSpades/S6_asmb/spades.log

Thank you for using SPAdes!
[Tue Oct 24 17:33:17 2023]
Finished job 25.
62 of 139 steps (45%) done

[Tue Oct 24 17:33:17 2023]
rule checkm_profile:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_coverage.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_profiles.txt
    jobid: 122
    wildcards: sample=S28

checkm profile -q /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_coverage.txt --tab_table -f /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_profiles.txt

[Tue Oct 24 17:33:17 2023]
rule run_bbtools_stats:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffolds.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta, /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_stats.txt
    jobid: 24
    wildcards: sample=S6

sed $'s/_cov_/ cov_/g' /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffolds.fasta > /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta && /usr/local/src/bbmap/stats.sh in=/nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta out=/nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_stats.txt && printf "\nTEDreads mapping stats:\n"  >> /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_stats.txt && rm -rf /nephele_data/outputs/asmbMetaSpades/S6_asmb/K* /nephele_data/outputs/asmbMetaSpades/S6_asmb/pipeline_state /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp /nephele_data/outputs/asmbMetaSpades/S6_asmb/misc /nephele_data/outputs/asmbMetaSpades/S6_asmb/before_rr.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/dataset.info /nephele_data/outputs/asmbMetaSpades/S6_asmb/*params* /nephele_data/outputs/asmbMetaSpades/S6_asmb/*.gfa /nephele_data/outputs/asmbMetaSpades/S6_asmb/first_pe_contigs.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/run_spades.sh /nephele_data/outputs/asmbMetaSpades/S6_asmb/*.yaml /nephele_data/outputs/asmbMetaSpades/S6_asmb/*.paths /nephele_data/outputs/asmbMetaSpades/S6_asmb/assembly_graph.fastg
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffolds.fasta.
[Tue Oct 24 17:33:18 2023]
Finished job 24.
63 of 139 steps (45%) done
[Tue Oct 24 17:33:18 2023]
Finished job 122.
64 of 139 steps (46%) done

[Tue Oct 24 17:33:18 2023]
rule bowtie2_build:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/bowtie2_build.done
    jobid: 28
    wildcards: sample=S6
    threads: 16

bowtie2-build --quiet --threads 16 /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.db && touch /nephele_data/outputs/asmbMetaSpades/S6_asmb/bowtie2_build.done
[Tue Oct 24 17:33:39 2023]
Finished job 28.
65 of 139 steps (47%) done

[Tue Oct 24 17:33:39 2023]
rule bowtie2_run:
    input: /nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz, /nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz, /nephele_data/outputs/asmbMetaSpades/S6_asmb/bowtie2_build.done
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.sam
    jobid: 27
    wildcards: sample=S6
    threads: 16

bowtie2 --phred33 --sensitive-local --no-unal --seed 4 -1 /nephele_data/outputs/TED_out/S6_R1_ted.fastq.gz -2 /nephele_data/outputs/TED_out/S6_R2_ted.fastq.gz -x /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.db -S /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.sam -p 16 2>> /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_stats.txt
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/bowtie2_build.done.
[Tue Oct 24 17:35:12 2023]
Finished job 27.
66 of 139 steps (47%) done

[Tue Oct 24 17:35:12 2023]
rule samtools_to_bam:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.sam
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.bam, /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_colated.bam, /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_fixmate.bam, /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_fixmate_sorted.bam, /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_tmp_markdup.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam
    jobid: 26
    wildcards: sample=S6
    threads: 16

samtools sort /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.sam -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.bam -@ 16 -T /nephele_data/tmp/S6_sort && samtools collate /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.bam -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_colated.bam -@ 16 /nephele_data/tmp/S6_collate && samtools fixmate -m /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_colated.bam /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_fixmate.bam -@ 16 && samtools sort /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_fixmate.bam -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_fixmate_sorted.bam -@ 16 -T /nephele_data/tmp/S6_sort && samtools markdup -r -s /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_fixmate_sorted.bam -f /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_tmp_markdup.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam -@ 16 -T /nephele_data/tmp/S6_markdup && samtools index -b /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam -@ 16
[bam_sort_core] merging from 0 files and 16 in-memory blocks...
[bam_sort_core] merging from 0 files and 16 in-memory blocks...
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.sam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6.bam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_colated.bam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_fixmate.bam.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_fixmate_sorted.bam.
[Tue Oct 24 17:35:31 2023]
Finished job 26.
67 of 139 steps (48%) done

[Tue Oct 24 17:35:31 2023]
rule scaffold_and_read_counts:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_basecov.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_idx.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_readcount.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_depths.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov1.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_scaffCoverage.txt
    jobid: 36
    wildcards: sample=S6

/usr/local/src/bbmap/pileup.sh /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam out=/nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov.txt overwrite=true && sort -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov.txt && jgi_summarize_bam_contig_depths /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam --outputDepth /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_depths.txt && sort /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_depths.txt | sed '1 s/^/#/' | cut -f 1-3 > /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_basecov.txt && samtools idxstats /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam > /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_idx.txt && cut -f 1-3 /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_idx.txt | sed -e '1s/^/#contigName\tLength\tReadsCount\n/' | sort | grep -v "*" > /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_readcount.txt && paste /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_readcount.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_basecov.txt | cut -f 1,2,3,8-14,17 -d $'\t' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov1.txt && awk 'BEGIN{FS=OFS="\t"} NR>1 {if ($2>0 && $3>0) $12=sprintf("%0.2f", $3*1e3/$2); else $12=0; print}'  /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov1.txt | sed -e '1s/^/#NODE\tlen\tReads\t\%ScaffCovered\t\%bpCovered\tplusReads\tminusReads\t\%GC\tMedFold\tstDev\tAveDepth\tRPK\n/' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_scaffCoverage.txt

[Tue Oct 24 17:35:31 2023]
rule add_de_replication_stats:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_stats.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_tmp_markdup.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/add_de_replication_stats.done
    jobid: 23
    wildcards: sample=S6

cat /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_stats.txt <(printf "\nRead alignment de-replication stats:\n") /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_tmp_markdup.txt > /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_tmp_file.txt && mv /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_tmp_file.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_stats.txt && touch /nephele_data/outputs/asmbMetaSpades/S6_asmb/add_de_replication_stats.done
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/S6_tmp_markdup.txt.
[Tue Oct 24 17:35:31 2023]
Finished job 23.
68 of 139 steps (49%) done
java -ea -Xmx66453m -cp /usr/local/src/bbmap/current/ jgi.CoveragePileup /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam out=/nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov.txt overwrite=true
Executing jgi.CoveragePileup [/nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam, out=/nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov.txt, overwrite=true]

Found samtools 1.13
Could not find sambamba.
Reads:                               	1803165
Mapped reads:                        	1803165
Mapped bases:                        	261223586
Ref scaffolds:                       	98194
Ref bases:                           	36547744

Percent mapped:                      	100.000
Percent proper pairs:                	96.408
Average coverage:                    	7.147
Average coverage with deletions:     	7.147
Standard deviation:                    	12.206
Percent scaffolds with any coverage: 	97.25
Percent of reference bases covered:  	96.10

Time: 	5.553 seconds.
Output depth matrix to /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_depths.txt
jgi_summarize_bam_contig_depths v2.15-6-g8b5702b 2022-01-10T22:14:13
Output matrix to /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_depths.txt
0: Opening bam: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam
Processing bam files
Thread 0 finished: final.assembly.bam with 1803165 reads and 942122 readsWellMapped
Creating depth matrix file: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_depths.txt
Closing most bam files
Closing last bam file
Finished
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_basecov.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_idx.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_readcount.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/tmp_scaffcov1.txt.
[Tue Oct 24 17:36:12 2023]
Finished job 36.
69 of 139 steps (50%) done

[Tue Oct 24 17:36:12 2023]
rule metabat2_run:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta, /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_depths.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/metabat2_run.done
    jobid: 115
    wildcards: sample=S6
    threads: 16

metabat2 -i /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/mag -m 1500 --maxEdges 250 --unbinned  -t 16 -a /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_depths.txt && touch /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/metabat2_run.done
MetaBAT 2 (v2.15-6-g8b5702b) using minContig 1500, minCV 1.0, minCVSum 1.0, maxP 95%, minS 60, maxEdges 250 and minClsSize 200000. with random seed=1698183372
4 bins (5146529 bases in total) formed.
[Tue Oct 24 17:36:13 2023]
Finished job 115.
70 of 139 steps (50%) done

[Tue Oct 24 17:36:13 2023]
rule checkm_coverage:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/metabat2_run.done
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_coverage.txt
    jobid: 117
    wildcards: sample=S6
    threads: 16

checkm coverage -x fa -t 16 /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_coverage.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam 2>/dev/null
[2023-10-24 17:36:14] INFO: CheckM v1.1.3
[2023-10-24 17:36:14] INFO: checkm coverage -x fa -t 16 /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_coverage.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam
[2023-10-24 17:36:14] INFO: [CheckM - coverage] Calculating coverage of sequences.
[2023-10-24 17:36:14] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:36:14] INFO: Determining bin assignment of each sequence.
[2023-10-24 17:36:14] INFO: Processing 1 file(s) with 16 threads.

[2023-10-24 17:36:14] INFO: Processing final.assembly.bam (1 of 1):

    # total reads: 1803165
      # properly mapped reads: 663319 (36.8%)
      # duplicate reads: 0 (0.0%)
      # secondary reads: 0 (0.0%)
      # reads failing QC: 73111 (4.1%)
      # reads failing alignment length: 160923 (8.9%)
      # reads failing edit distance: 865321 (48.0%)
      # reads not properly paired: 40491 (2.2%)

[2023-10-24 17:36:21] INFO: Writing coverage information to file.
Running hmmsearch...
[2023-10-24 17:36:40] INFO: Coverage information written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_coverage.txt
[2023-10-24 17:36:40] INFO: { Current stage: 0:00:26.148 || Total: 0:00:26.148 }
[Tue Oct 24 17:36:40 2023]
Finished job 117.
71 of 139 steps (51%) done

[Tue Oct 24 17:36:40 2023]
rule gene_prediction:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gff, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.fna
    jobid: 45
    wildcards: sample=S6
    threads: 16

prodigal -p meta -i /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta -f gff -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gff -a /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa -d /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.fna -q
Making report...
AMRFinder took 277 seconds to complete
Running AMRFinder
[Tue Oct 24 17:37:01 2023]
Finished job 87.
72 of 139 steps (52%) done

[Tue Oct 24 17:37:01 2023]
rule run_amrfinder:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/AMRs/AMRs.faa, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/AMRs/AMRs_info.txt
    jobid: 89
    wildcards: sample=S28
    threads: 16

[33mJob counts:
	count	jobs
	1	run_amrfinder
	1[0m
[33mamrfinder --plus --protein /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa --threads 16 --protein_output /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/AMRs/AMRs.faa -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/AMRs/AMRs_info.txt[0m
Running: amrfinder --plus --protein /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa --threads 16 --protein_output /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/AMRs/AMRs.faa -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/AMRs/AMRs_info.txt
Software directory: '/usr/local/src/amrfinder/'
Software version: 3.10.18
Database directory: '/usr/local/src/amrfinder/data/2021-12-21.1'
Database version: 2021-12-21.1
AMRFinder protein-only search
  - include -n NUC_FASTA, --nucleotide NUC_FASTA and -g GFF_FILE, --gff GFF_FILE options to add translated searches
  - include -O ORGANISM, --organism ORGANISM option to add mutation searches and suppress common proteins
Running blastp...
[Tue Oct 24 17:38:28 2023]
Finished job 45.
73 of 139 steps (53%) done

[Tue Oct 24 17:38:28 2023]
rule checkm_profile:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_coverage.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_profiles.txt
    jobid: 116
    wildcards: sample=S6

checkm profile -q /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_coverage.txt --tab_table -f /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_profiles.txt

[Tue Oct 24 17:38:28 2023]
rule gff_to_gtf:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gff
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gtf
    jobid: 44
    wildcards: sample=S6

/usr/local/src/nephele2/pipelines/wgsa/gff2gtf.sh /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gff > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gtf
[Tue Oct 24 17:38:29 2023]
Finished job 44.
74 of 139 steps (53%) done
[Tue Oct 24 17:38:30 2023]
Finished job 116.
75 of 139 steps (54%) done

[Tue Oct 24 17:38:30 2023]
rule run_verse:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gtf, /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/verse.CDS.summary.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/verse.CDS.txt
    jobid: 43
    wildcards: sample=S6
    threads: 16

verse -a /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gtf -t 'CDS' -g gene_id -z 0 -s 0 -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/verse /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.bam -T 4

        ===      ===    %%  %%  %%%%%%  %%   %%  %%       %%%%   %%%%%   
         ==      ==     %% %%     %%    %%% %%%  %%      %%  %%  %%  %%  
          ==    ==      %%%%      %%    %% % %%  %%      %%%%%%  %%%%%   
           ==  ==       %% %%     %%    %%   %%  %%      %%  %%  %%  %%  
            ====        %%  %%  %%%%%%  %%   %%  %%%%%%  %%  %%  %%%%%   
             ==        ................................................. 
	  v0.1.5

//============================== VERSE setting ===============================\\
||            Running mode : Default(featureCounts)                           ||
||            Feature type : CDS                                              ||
||              Input file : 1 BAM file                                       ||
||                           P /nephele_data/outputs/asmbMetaSpades/S6_as ... ||
||             Output file : /nephele_data/outputs/asmbMetaSpades/S6_asmb ... ||
||         Annotation file : /nephele_data/outputs/asmbMetaSpades/S6_asmb ... ||
||                                                                            ||
||                 Threads : 4                                                ||
|| Multithreaded BAM unzip : no                                               ||
||                                                                            ||
||              Paired-end : yes                                              ||
||         Strand specific : no                                               ||
||      Multimapping reads : not counted                                      ||
||                                                                            ||
||          Chimeric reads : counted                                          ||
||        Both ends mapped : not required                                     ||
||                                                                            ||
\\============= Based on the framework of featureCounts(SUBREAD) =============//

//================================= Running ==================================\\
||                                                                            ||
|| Load annotation file /nephele_data/outputs/asmbMetaSpades/S6_asmb/gene ... ||
||    CDSs : 108813                                                           ||
||    CDSs after merge : 108813                                               ||
||    Genes : 108813                                                          ||
||    Chromosomes : 92570                                                     ||
||                                                                            ||
|| Process BAM file /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.as ... ||
||    Quantifying in paired-end mode.                                         ||
||    Assign read pairs to features...                                        ||
||    Read pairs with missing mates : 1698095                                 ||
||    Total read pairs : 1750630                                              ||
||    Successfully assigned read pairs : 1513309 (86.4%)                      ||
||    Running time : 0.07 minutes                                             ||
||                                                                            ||
||                         Read assignment finished.                          ||
||                                                                            ||
\\====== VERSE: a Versatile and Efficient Rna-SEq read assignment tool =======//

[Tue Oct 24 17:38:34 2023]
Finished job 43.
76 of 139 steps (55%) done

[Tue Oct 24 17:38:34 2023]
rule rename_verse_summary:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/verse.CDS.summary.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_stats.txt
    jobid: 42
    wildcards: sample=S6

mv /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/verse.CDS.summary.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_stats.txt

[Tue Oct 24 17:38:34 2023]
rule tpm_normalization:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gtf, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/verse.CDS.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_lengths.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_counts.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_coverage.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_RPK.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_ABUNtab.txt
    jobid: 62
    wildcards: sample=S6

cut -f4,5,9 /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.gtf | sed 's/gene_id //g' | gawk '{print $3,$2-$1+1}' | tr ' ' '\t' | sed '1s/^/gene\tlength\n/' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_lengths.txt && join /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_lengths.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/verse.CDS.txt -t $'\t' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_counts.txt && grep "_" /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_counts.txt   | awk -v OFS="\t" '{$4 = sprintf("%0.0f", $3*150/$2)}1' | sort | sed -e '1s/^/#name\tlen\treads\tcov\n/' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_coverage.txt && grep "_" /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_coverage.txt | awk -v OFS="\t" '{$5 = sprintf("%0.0f", $3*1e3/$2)}1' | sort | sed -e '1s/^/#name\tlen\treads\tcov\tRPK\n/' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_RPK.txt && awk -v OFS="\t" 'NR==FNR{sum+= $5; next} FNR==1{print $0,"iTPM"; next} {printf("%s %0.0f\n", $0,$5*1e6/sum)}'  /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_RPK.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_RPK.txt |sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_ABUNtab.txt  
[Tue Oct 24 17:38:34 2023]
Finished job 42.
77 of 139 steps (55%) done
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/verse.CDS.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_lengths.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_counts.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_coverage.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/tmp_RPK.txt.
[Tue Oct 24 17:38:36 2023]
Finished job 62.
78 of 139 steps (56%) done

[Tue Oct 24 17:38:36 2023]
rule run_amrfinder:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/AMRs/AMRs.faa, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/AMRs/AMRs_info.txt
    jobid: 88
    wildcards: sample=S6
    threads: 16

[33mJob counts:
	count	jobs
	1	run_amrfinder
	1[0m
[33mamrfinder --plus --protein /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa --threads 16 --protein_output /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/AMRs/AMRs.faa -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/AMRs/AMRs_info.txt[0m
Running: amrfinder --plus --protein /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa --threads 16 --protein_output /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/AMRs/AMRs.faa -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/AMRs/AMRs_info.txt
Software directory: '/usr/local/src/amrfinder/'
Software version: 3.10.18
Database directory: '/usr/local/src/amrfinder/data/2021-12-21.1'
Database version: 2021-12-21.1
AMRFinder protein-only search
  - include -n NUC_FASTA, --nucleotide NUC_FASTA and -g GFF_FILE, --gff GFF_FILE options to add translated searches
  - include -O ORGANISM, --organism ORGANISM option to add mutation searches and suppress common proteins
Running blastp...
Running hmmsearch...
Making report...
AMRFinder took 198 seconds to complete
Running AMRFinder
[Tue Oct 24 17:40:20 2023]
Finished job 89.
79 of 139 steps (57%) done

[Tue Oct 24 17:40:20 2023]
rule checkm_lineage_wf:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/metabat2_run.done
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/lineage.ms
    jobid: 108
    wildcards: sample=S1
    threads: 16

checkm lineage_wf --tab_table --nt --pplacer_threads 16 -t 16 -x fa /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/
[2023-10-24 17:40:21] INFO: CheckM v1.1.3
[2023-10-24 17:40:21] INFO: checkm lineage_wf --tab_table --nt --pplacer_threads 16 -t 16 -x fa /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/
[2023-10-24 17:40:21] INFO: [CheckM - tree] Placing bins in reference genome tree.
[2023-10-24 17:40:21] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:40:22] INFO: Identifying marker genes in 3 bins with 16 threads:
    Finished processing 0 of 3 (0.00%) bins.    Finished processing 1 of 3 (33.33%) bins.    Finished processing 2 of 3 (66.67%) bins.Running hmmsearch...
Making report...
AMRFinder took 179 seconds to complete
Running AMRFinder
[Tue Oct 24 17:41:36 2023]
Finished job 88.
80 of 139 steps (58%) done

[Tue Oct 24 17:41:36 2023]
rule checkm_lineage_wf:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/metabat2_run.done
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/lineage.ms
    jobid: 114
    wildcards: sample=S6
    threads: 16

checkm lineage_wf --tab_table --nt --pplacer_threads 16 -t 16 -x fa /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/
[2023-10-24 17:41:37] INFO: CheckM v1.1.3
[2023-10-24 17:41:37] INFO: checkm lineage_wf --tab_table --nt --pplacer_threads 16 -t 16 -x fa /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/
[2023-10-24 17:41:37] INFO: [CheckM - tree] Placing bins in reference genome tree.
[2023-10-24 17:41:37] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:41:37] INFO: Identifying marker genes in 6 bins with 16 threads:
    Finished processing 0 of 6 (0.00%) bins.    Finished processing 1 of 6 (16.67%) bins.    Finished processing 2 of 6 (33.33%) bins.    Finished processing 3 of 6 (50.00%) bins.    Finished processing 4 of 6 (66.67%) bins.    Finished processing 5 of 6 (83.33%) bins.    Finished processing 6 of 6 (100.00%) bins.
[2023-10-24 17:43:01] INFO: Saving HMM info to file.
[2023-10-24 17:43:01] INFO: Calculating genome statistics for 6 bins with 16 threads:
    Finished processing 0 of 6 (0.00%) bins.    Finished processing 1 of 6 (16.67%) bins.    Finished processing 2 of 6 (33.33%) bins.    Finished processing 3 of 6 (50.00%) bins.    Finished processing 4 of 6 (66.67%) bins.    Finished processing 5 of 6 (83.33%) bins.    Finished processing 6 of 6 (100.00%) bins.
[2023-10-24 17:43:03] INFO: Extracting marker genes to align.
[2023-10-24 17:43:03] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 6 (16.67%) bins.    Finished parsing hits for 2 of 6 (33.33%) bins.    Finished parsing hits for 3 of 6 (50.00%) bins.    Finished parsing hits for 4 of 6 (66.67%) bins.    Finished parsing hits for 5 of 6 (83.33%) bins.    Finished parsing hits for 6 of 6 (100.00%) bins.[2023-10-24 17:43:04] INFO: Extracting 43 HMMs with 16 threads:

    Finished extracting 0 of 43 (0.00%) HMMs.    Finished extracting 1 of 43 (2.33%) HMMs.    Finished extracting 2 of 43 (4.65%) HMMs.    Finished extracting 3 of 43 (6.98%) HMMs.    Finished extracting 4 of 43 (9.30%) HMMs.    Finished extracting 5 of 43 (11.63%) HMMs.    Finished extracting 6 of 43 (13.95%) HMMs.    Finished extracting 7 of 43 (16.28%) HMMs.    Finished extracting 8 of 43 (18.60%) HMMs.    Finished extracting 9 of 43 (20.93%) HMMs.    Finished extracting 10 of 43 (23.26%) HMMs.    Finished extracting 11 of 43 (25.58%) HMMs.    Finished extracting 12 of 43 (27.91%) HMMs.    Finished extracting 13 of 43 (30.23%) HMMs.    Finished extracting 14 of 43 (32.56%) HMMs.    Finished extracting 15 of 43 (34.88%) HMMs.    Finished extracting 16 of 43 (37.21%) HMMs.    Finished extracting 17 of 43 (39.53%) HMMs.    Finished extracting 18 of 43 (41.86%) HMMs.    Finished extracting 19 of 43 (44.19%) HMMs.    Finished extracting 20 of 43 (46.51%) HMMs.    Finished extracting 21 of 43 (48.84%) HMMs.    Finished extracting 22 of 43 (51.16%) HMMs.    Finished extracting 23 of 43 (53.49%) HMMs.    Finished extracting 24 of 43 (55.81%) HMMs.    Finished extracting 25 of 43 (58.14%) HMMs.    Finished extracting 26 of 43 (60.47%) HMMs.    Finished extracting 27 of 43 (62.79%) HMMs.    Finished extracting 28 of 43 (65.12%) HMMs.    Finished extracting 29 of 43 (67.44%) HMMs.    Finished extracting 30 of 43 (69.77%) HMMs.    Finished extracting 31 of 43 (72.09%) HMMs.    Finished extracting 32 of 43 (74.42%) HMMs.    Finished extracting 33 of 43 (76.74%) HMMs.    Finished extracting 34 of 43 (79.07%) HMMs.    Finished extracting 35 of 43 (81.40%) HMMs.    Finished extracting 36 of 43 (83.72%) HMMs.    Finished extracting 37 of 43 (86.05%) HMMs.    Finished extracting 38 of 43 (88.37%) HMMs.    Finished extracting 39 of 43 (90.70%) HMMs.    Finished extracting 40 of 43 (93.02%) HMMs.    Finished extracting 41 of 43 (95.35%) HMMs.    Finished extracting 42 of 43 (97.67%) HMMs.    Finished extracting 43 of 43 (100.00%) HMMs.
[2023-10-24 17:43:04] INFO: Aligning 43 marker genes with 16 threads:
    Finished aligning 0 of 43 (0.00%) marker genes.    Finished aligning 1 of 43 (2.33%) marker genes.    Finished aligning 2 of 43 (4.65%) marker genes.    Finished aligning 3 of 43 (6.98%) marker genes.    Finished aligning 4 of 43 (9.30%) marker genes.    Finished aligning 5 of 43 (11.63%) marker genes.    Finished aligning 6 of 43 (13.95%) marker genes.    Finished aligning 7 of 43 (16.28%) marker genes.    Finished aligning 8 of 43 (18.60%) marker genes.    Finished aligning 9 of 43 (20.93%) marker genes.    Finished aligning 10 of 43 (23.26%) marker genes.    Finished aligning 11 of 43 (25.58%) marker genes.    Finished aligning 12 of 43 (27.91%) marker genes.    Finished aligning 13 of 43 (30.23%) marker genes.    Finished aligning 14 of 43 (32.56%) marker genes.    Finished aligning 15 of 43 (34.88%) marker genes.    Finished aligning 16 of 43 (37.21%) marker genes.    Finished aligning 17 of 43 (39.53%) marker genes.    Finished aligning 18 of 43 (41.86%) marker genes.    Finished aligning 19 of 43 (44.19%) marker genes.    Finished aligning 20 of 43 (46.51%) marker genes.    Finished aligning 21 of 43 (48.84%) marker genes.    Finished aligning 22 of 43 (51.16%) marker genes.    Finished aligning 23 of 43 (53.49%) marker genes.    Finished aligning 24 of 43 (55.81%) marker genes.    Finished aligning 25 of 43 (58.14%) marker genes.    Finished aligning 26 of 43 (60.47%) marker genes.    Finished aligning 27 of 43 (62.79%) marker genes.    Finished aligning 28 of 43 (65.12%) marker genes.    Finished aligning 29 of 43 (67.44%) marker genes.    Finished aligning 30 of 43 (69.77%) marker genes.    Finished aligning 31 of 43 (72.09%) marker genes.    Finished aligning 32 of 43 (74.42%) marker genes.    Finished aligning 33 of 43 (76.74%) marker genes.    Finished aligning 34 of 43 (79.07%) marker genes.    Finished aligning 35 of 43 (81.40%) marker genes.    Finished aligning 36 of 43 (83.72%) marker genes.    Finished aligning 37 of 43 (86.05%) marker genes.    Finished aligning 38 of 43 (88.37%) marker genes.    Finished aligning 39 of 43 (90.70%) marker genes.    Finished aligning 40 of 43 (93.02%) marker genes.    Finished aligning 41 of 43 (95.35%) marker genes.    Finished aligning 42 of 43 (97.67%) marker genes.    Finished aligning 43 of 43 (100.00%) marker genes.
[2023-10-24 17:43:04] INFO: Reading marker alignment files.
[2023-10-24 17:43:04] INFO: Concatenating alignments.
[2023-10-24 17:43:04] INFO: Placing 6 bins into the genome tree with pplacer (be patient).
[1;32mFunctional annotation of hits...[0m
0 1.6689300537109375e-06 0.00 q/s (% mem usage: 2.60, % mem avail: 97.41)
    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:43:40] INFO: Saving HMM info to file.
[2023-10-24 17:43:40] INFO: Calculating genome statistics for 3 bins with 16 threads:
    Finished processing 0 of 3 (0.00%) bins.    Finished processing 1 of 3 (33.33%) bins.    Finished processing 2 of 3 (66.67%) bins.    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:43:43] INFO: Extracting marker genes to align.
[2023-10-24 17:43:43] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.[2023-10-24 17:43:44] INFO: Extracting 43 HMMs with 16 threads:

    Finished extracting 0 of 43 (0.00%) HMMs.    Finished extracting 1 of 43 (2.33%) HMMs.    Finished extracting 2 of 43 (4.65%) HMMs.    Finished extracting 3 of 43 (6.98%) HMMs.    Finished extracting 4 of 43 (9.30%) HMMs.    Finished extracting 5 of 43 (11.63%) HMMs.    Finished extracting 6 of 43 (13.95%) HMMs.    Finished extracting 7 of 43 (16.28%) HMMs.    Finished extracting 8 of 43 (18.60%) HMMs.    Finished extracting 9 of 43 (20.93%) HMMs.    Finished extracting 10 of 43 (23.26%) HMMs.    Finished extracting 11 of 43 (25.58%) HMMs.    Finished extracting 12 of 43 (27.91%) HMMs.    Finished extracting 13 of 43 (30.23%) HMMs.    Finished extracting 14 of 43 (32.56%) HMMs.    Finished extracting 15 of 43 (34.88%) HMMs.    Finished extracting 16 of 43 (37.21%) HMMs.    Finished extracting 17 of 43 (39.53%) HMMs.    Finished extracting 18 of 43 (41.86%) HMMs.    Finished extracting 19 of 43 (44.19%) HMMs.    Finished extracting 20 of 43 (46.51%) HMMs.    Finished extracting 21 of 43 (48.84%) HMMs.    Finished extracting 22 of 43 (51.16%) HMMs.    Finished extracting 23 of 43 (53.49%) HMMs.    Finished extracting 24 of 43 (55.81%) HMMs.    Finished extracting 25 of 43 (58.14%) HMMs.    Finished extracting 26 of 43 (60.47%) HMMs.    Finished extracting 27 of 43 (62.79%) HMMs.    Finished extracting 28 of 43 (65.12%) HMMs.    Finished extracting 29 of 43 (67.44%) HMMs.    Finished extracting 30 of 43 (69.77%) HMMs.    Finished extracting 31 of 43 (72.09%) HMMs.    Finished extracting 32 of 43 (74.42%) HMMs.    Finished extracting 33 of 43 (76.74%) HMMs.    Finished extracting 34 of 43 (79.07%) HMMs.    Finished extracting 35 of 43 (81.40%) HMMs.    Finished extracting 36 of 43 (83.72%) HMMs.    Finished extracting 37 of 43 (86.05%) HMMs.    Finished extracting 38 of 43 (88.37%) HMMs.    Finished extracting 39 of 43 (90.70%) HMMs.    Finished extracting 40 of 43 (93.02%) HMMs.    Finished extracting 41 of 43 (95.35%) HMMs.    Finished extracting 42 of 43 (97.67%) HMMs.    Finished extracting 43 of 43 (100.00%) HMMs.
[2023-10-24 17:43:44] INFO: Aligning 43 marker genes with 16 threads:
    Finished aligning 0 of 43 (0.00%) marker genes.    Finished aligning 1 of 43 (2.33%) marker genes.    Finished aligning 2 of 43 (4.65%) marker genes.    Finished aligning 3 of 43 (6.98%) marker genes.    Finished aligning 4 of 43 (9.30%) marker genes.    Finished aligning 5 of 43 (11.63%) marker genes.    Finished aligning 6 of 43 (13.95%) marker genes.    Finished aligning 7 of 43 (16.28%) marker genes.    Finished aligning 8 of 43 (18.60%) marker genes.    Finished aligning 9 of 43 (20.93%) marker genes.    Finished aligning 10 of 43 (23.26%) marker genes.    Finished aligning 11 of 43 (25.58%) marker genes.    Finished aligning 12 of 43 (27.91%) marker genes.    Finished aligning 13 of 43 (30.23%) marker genes.    Finished aligning 14 of 43 (32.56%) marker genes.    Finished aligning 15 of 43 (34.88%) marker genes.    Finished aligning 16 of 43 (37.21%) marker genes.    Finished aligning 17 of 43 (39.53%) marker genes.    Finished aligning 18 of 43 (41.86%) marker genes.    Finished aligning 19 of 43 (44.19%) marker genes.    Finished aligning 20 of 43 (46.51%) marker genes.    Finished aligning 21 of 43 (48.84%) marker genes.    Finished aligning 22 of 43 (51.16%) marker genes.    Finished aligning 23 of 43 (53.49%) marker genes.    Finished aligning 24 of 43 (55.81%) marker genes.    Finished aligning 25 of 43 (58.14%) marker genes.    Finished aligning 26 of 43 (60.47%) marker genes.    Finished aligning 27 of 43 (62.79%) marker genes.    Finished aligning 28 of 43 (65.12%) marker genes.    Finished aligning 29 of 43 (67.44%) marker genes.    Finished aligning 30 of 43 (69.77%) marker genes.    Finished aligning 31 of 43 (72.09%) marker genes.    Finished aligning 32 of 43 (74.42%) marker genes.    Finished aligning 33 of 43 (76.74%) marker genes.    Finished aligning 34 of 43 (79.07%) marker genes.    Finished aligning 35 of 43 (81.40%) marker genes.    Finished aligning 36 of 43 (83.72%) marker genes.    Finished aligning 37 of 43 (86.05%) marker genes.    Finished aligning 38 of 43 (88.37%) marker genes.    Finished aligning 39 of 43 (90.70%) marker genes.    Finished aligning 40 of 43 (93.02%) marker genes.    Finished aligning 41 of 43 (95.35%) marker genes.    Finished aligning 42 of 43 (97.67%) marker genes.    Finished aligning 43 of 43 (100.00%) marker genes.
[2023-10-24 17:43:44] INFO: Reading marker alignment files.
[2023-10-24 17:43:44] INFO: Concatenating alignments.
[2023-10-24 17:43:44] INFO: Placing 3 bins into the genome tree with pplacer (be patient).
[2023-10-24 17:46:03] INFO: { Current stage: 0:05:42.423 || Total: 0:05:42.423 }
[2023-10-24 17:46:03] INFO: [CheckM - lineage_set] Inferring lineage-specific marker sets.
[2023-10-24 17:46:03] INFO: Reading HMM info from file.
[2023-10-24 17:46:03] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.[2023-10-24 17:46:03] INFO: Determining marker sets for each genome bin.

    Finished processing 1 of 3 (33.33%) bins (current: mag.tooShort).                                                                         Finished processing 2 of 3 (66.67%) bins (current: mag.unbinned).                                                                         Finished processing 3 of 3 (100.00%) bins (current: mag.1).[2023-10-24 17:46:04] INFO: Marker set written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/lineage.ms
[2023-10-24 17:46:04] INFO: { Current stage: 0:00:01.180 || Total: 0:05:43.603 }
[2023-10-24 17:46:04] INFO: [CheckM - analyze] Identifying marker genes in bins.
[2023-10-24 17:46:04] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:46:05] INFO: Identifying marker genes in 3 bins with 16 threads:

    Finished processing 0 of 3 (0.00%) bins.[1;34mTime to load the DB into memory: 159.4284269809723[0m
500 161.96970582008362 3.09 q/s (% mem usage: 41.70, % mem avail: 58.33)
1000 163.54278469085693 6.11 q/s (% mem usage: 41.70, % mem avail: 58.31)
1500 164.93870902061462 9.09 q/s (% mem usage: 41.70, % mem avail: 58.30)
2000 166.45296549797058 12.02 q/s (% mem usage: 41.70, % mem avail: 58.30)
2500 167.84364914894104 14.89 q/s (% mem usage: 41.70, % mem avail: 58.30)
3000 169.13010621070862 17.74 q/s (% mem usage: 41.70, % mem avail: 58.30)
3500 170.6207365989685 20.51 q/s (% mem usage: 41.70, % mem avail: 58.30)
    Finished processing 1 of 3 (33.33%) bins.4000 171.95572924613953 23.26 q/s (% mem usage: 41.70, % mem avail: 58.31)
    Finished processing 2 of 3 (66.67%) bins.4500 173.11986351013184 25.99 q/s (% mem usage: 41.70, % mem avail: 58.33)
5000 174.47796273231506 28.66 q/s (% mem usage: 41.70, % mem avail: 58.32)
    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:46:23] INFO: Saving HMM info to file.
[2023-10-24 17:46:23] INFO: { Current stage: 0:00:18.243 || Total: 0:06:01.847 }
[2023-10-24 17:46:23] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.[2023-10-24 17:46:23] INFO: Aligning marker genes with multiple hits in a single bin:

    Finished processing 0 of 3 (0.00%) bins.5500 175.79905676841736 31.29 q/s (% mem usage: 41.70, % mem avail: 58.34)
    Finished processing 1 of 3 (33.33%) bins.    Finished processing 2 of 3 (66.67%) bins.6000 177.11959314346313 33.88 q/s (% mem usage: 41.70, % mem avail: 58.30)
    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:46:25] INFO: { Current stage: 0:00:02.339 || Total: 0:06:04.186 }
[2023-10-24 17:46:25] INFO: Calculating genome statistics for 3 bins with 16 threads:
    Finished processing 0 of 3 (0.00%) bins.    Finished processing 1 of 3 (33.33%) bins.    Finished processing 2 of 3 (66.67%) bins.6500 178.49134874343872 36.42 q/s (% mem usage: 41.70, % mem avail: 58.26)
7000 179.68117928504944 38.96 q/s (% mem usage: 41.70, % mem avail: 58.26)
7500 180.97095942497253 41.44 q/s (% mem usage: 41.90, % mem avail: 58.05)
    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:46:29] INFO: { Current stage: 0:00:03.769 || Total: 0:06:07.955 }
[2023-10-24 17:46:29] INFO: [CheckM - qa] Tabulating genome statistics.
[2023-10-24 17:46:29] INFO: Calculating AAI between multi-copy marker genes.
[2023-10-24 17:46:29] INFO: Reading HMM info from file.
[2023-10-24 17:46:29] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.Bin Id	Marker lineage	# genomes	# markers	# marker sets	0	1	2	3	4	5+	Completeness	Contamination	Strain heterogeneity
mag.1	k__Bacteria (UID203)	5449	104	58	58	37	9	0	0	0	68.79	13.28	33.33
mag.tooShort	root (UID1)	5656	56	24	4	0	0	1	0	51	83.33	741.70	4.01
mag.unbinned	k__Bacteria (UID203)	5449	104	58	35	48	19	1	1	0	55.08	12.70	75.00
[2023-10-24 17:46:29] INFO: { Current stage: 0:00:00.481 || Total: 0:06:08.436 }

[Tue Oct 24 17:46:29 2023]
Finished job 108.
81 of 139 steps (58%) done

[Tue Oct 24 17:46:29 2023]
rule checkm_plots:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/metabat2_run.done, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/lineage.ms
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/checkm_plots.done
    jobid: 124
    wildcards: sample=S1


            checkm coding_plot --image_type pdf  -x fa /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/ 95 || true
            checkm marker_plot --image_type pdf  -x fa --dpi 400 /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/ || true
            checkm nx_plot --image_type pdf  -x fa /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/ || true
            touch /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/checkm_plots.done
            
8000 182.2956578731537 43.88 q/s (% mem usage: 41.60, % mem avail: 58.41)
[2023-10-24 17:46:31] INFO: CheckM v1.1.3
[2023-10-24 17:46:31] INFO: checkm coding_plot --image_type pdf -x fa /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/ 95
[2023-10-24 17:46:31] INFO: [CheckM - coding_plot] Creating coding density histogram and delta-CD plot.
[2023-10-24 17:46:31] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:46:31] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/mag.1.fa (1 of 3)
8500 183.60777354240417 46.29 q/s (% mem usage: 41.70, % mem avail: 58.30)
9000 185.01337265968323 48.65 q/s (% mem usage: 41.70, % mem avail: 58.33)
[2023-10-24 17:46:33] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/mag.1.coding_density_plots.pdf
[2023-10-24 17:46:33] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/mag.tooShort.fa (2 of 3)
9500 186.35623741149902 50.98 q/s (% mem usage: 41.80, % mem avail: 58.22)
10000 187.76407408714294 53.26 q/s (% mem usage: 41.90, % mem avail: 58.07)
[2023-10-24 17:46:36] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/mag.tooShort.coding_density_plots.pdf
[2023-10-24 17:46:36] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/mag.unbinned.fa (3 of 3)
10500 189.26786851882935 55.48 q/s (% mem usage: 41.90, % mem avail: 58.15)
11000 190.6496000289917 57.70 q/s (% mem usage: 41.90, % mem avail: 58.13)
[2023-10-24 17:46:38] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/mag.unbinned.coding_density_plots.pdf
[2023-10-24 17:46:38] INFO: { Current stage: 0:00:07.598 || Total: 0:00:07.598 }
[2023-10-24 17:46:39] INFO: CheckM v1.1.3
[2023-10-24 17:46:39] INFO: checkm marker_plot --image_type pdf -x fa --dpi 400 /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/
[2023-10-24 17:46:39] INFO: [CheckM - marker_plot] Creating marker gene position plot.
[2023-10-24 17:46:39] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:46:39] INFO: Plotting marker gene position plot for mag.1 (1 of 3)
11500 191.8834547996521 59.93 q/s (% mem usage: 41.60, % mem avail: 58.39)
[2023-10-24 17:46:39] INFO: Markers reside on 45 of 1,698 sequences which span 0.11 of 4.28 (2.7%) Mb

Unexpected error: <class 'AttributeError'>
Traceback (most recent call last):
  File "/usr/local/bin/checkm", line 611, in <module>
    checkmParser.parseOptions(args)
  File "/usr/local/lib/python3.7/dist-packages/checkm/main.py", line 885, in parseOptions
    self.markerPlot(options)
  File "/usr/local/lib/python3.7/dist-packages/checkm/main.py", line 603, in markerPlot
    bPlotted = plot.plot(f, markerGeneStats[binId], binStats[binId])
  File "/usr/local/lib/python3.7/dist-packages/checkm/plot/markerGenePosPlot.py", line 112, in plot
    yLabelBounds = self.yLabelExtents(yLabels, self.options.font_size)
  File "/usr/local/lib/python3.7/dist-packages/checkm/plot/AbstractPlot.py", line 124, in yLabelExtents
    bboxi = bbox.inverse_transformed(self.fig.transFigure)
AttributeError: 'Bbox' object has no attribute 'inverse_transformed'
[2023-10-24 17:46:40] INFO: CheckM v1.1.3
[2023-10-24 17:46:40] INFO: checkm nx_plot --image_type pdf -x fa /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/
[2023-10-24 17:46:40] INFO: [CheckM - nx_plot] Creating Nx-plots.
[2023-10-24 17:46:40] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:46:40] INFO: Plotting Nx-plot for mag.1 (1 of 3)
[2023-10-24 17:46:40] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/mag.1.nx_plot.pdf
[2023-10-24 17:46:40] INFO: Plotting Nx-plot for mag.tooShort (2 of 3)
12000 193.2323133945465 62.10 q/s (% mem usage: 41.70, % mem avail: 58.35)
[2023-10-24 17:46:41] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/mag.tooShort.nx_plot.pdf
[2023-10-24 17:46:41] INFO: Plotting Nx-plot for mag.unbinned (3 of 3)
[2023-10-24 17:46:41] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/mag.unbinned.nx_plot.pdf
[2023-10-24 17:46:41] INFO: { Current stage: 0:00:01.253 || Total: 0:00:01.253 }
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/metabat2_run.done.
[Tue Oct 24 17:46:42 2023]
Finished job 124.
82 of 139 steps (59%) done

[Tue Oct 24 17:46:42 2023]
rule checkm_qa:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/lineage.ms
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_qa.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tax.txt
    jobid: 107
    wildcards: sample=S1
    threads: 16

checkm qa -o 2 --tab_table -t 16 -f /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_qa.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/lineage.ms /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/ && checkm tree_qa -o 2 --tab_table -f /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tax.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/
12500 194.4831144809723 64.27 q/s (% mem usage: 41.60, % mem avail: 58.40)
[2023-10-24 17:46:42] INFO: CheckM v1.1.3
[2023-10-24 17:46:42] INFO: checkm qa -o 2 --tab_table -t 16 -f /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_qa.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/lineage.ms /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/
[2023-10-24 17:46:42] INFO: [CheckM - qa] Tabulating genome statistics.
[2023-10-24 17:46:42] INFO: Calculating AAI between multi-copy marker genes.
[2023-10-24 17:46:42] INFO: Reading HMM info from file.
[2023-10-24 17:46:42] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.[2023-10-24 17:46:43] INFO: QA information written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_qa.txt
[2023-10-24 17:46:43] INFO: { Current stage: 0:00:00.470 || Total: 0:00:00.470 }

13000 195.94832944869995 66.34 q/s (% mem usage: 41.60, % mem avail: 58.40)
[2023-10-24 17:46:44] INFO: CheckM v1.1.3
[2023-10-24 17:46:44] INFO: checkm tree_qa -o 2 --tab_table -f /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tax.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/
[2023-10-24 17:46:44] INFO: [CheckM - tree_qa] Assessing phylogenetic markers found in each bin.
[2023-10-24 17:46:44] INFO: Reading HMM info from file.
[2023-10-24 17:46:44] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.13500 197.24412608146667 68.44 q/s (% mem usage: 41.60, % mem avail: 58.39)
[2023-10-24 17:46:46] INFO: QA information written to: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tax.txt
[2023-10-24 17:46:46] INFO: { Current stage: 0:00:02.015 || Total: 0:00:02.015 }

[Tue Oct 24 17:46:46 2023]
Finished job 107.
83 of 139 steps (60%) done

[Tue Oct 24 17:46:46 2023]
rule join_profiles_tax:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tax.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_qa.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_profiles.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/tmp1.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/tmp2.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tmpsum.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_SUMMARY.txt
    jobid: 106
    wildcards: sample=S1

cut /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tax.txt -f1,5 > /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/tmp1.txt && cut /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_qa.txt -f1,6-11,13,15,17,19,23 > /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/tmp2.txt && paste /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/tmp1.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/tmp2.txt > /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tmpsum.txt && join /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_profiles.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tmpsum.txt -t $'\t' | cut -f 1,3,4,6,7-19 | sed 's/final.assembly: //g' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_SUMMARY.txt

[Tue Oct 24 17:46:46 2023]
rule taxbin_krona_txt:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_profiles.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tax.txt
    output: /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S1_4krona.txt
    jobid: 128
    wildcards: sample=S1

join /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_profiles.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tax.txt -t $'\t' | cut -f6,10,11 | sed -e 's/..__/\t/g' | sed -e 's/\tunresolved//g' | sed -e '1 s/^/#/' > /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S1_4krona.txt
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/tmp1.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/tmp2.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tmpsum.txt.
[Tue Oct 24 17:46:46 2023]
Finished job 106.
84 of 139 steps (60%) done
[Tue Oct 24 17:46:46 2023]
Finished job 128.
85 of 139 steps (61%) done

[Tue Oct 24 17:46:46 2023]
rule checkm_lineage_wf:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/metabat2_run.done
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/lineage.ms
    jobid: 120
    wildcards: sample=S28
    threads: 16

checkm lineage_wf --tab_table --nt --pplacer_threads 16 -t 16 -x fa /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/
14000 198.64598321914673 70.48 q/s (% mem usage: 41.60, % mem avail: 58.41)
[2023-10-24 17:46:47] INFO: CheckM v1.1.3
[2023-10-24 17:46:47] INFO: checkm lineage_wf --tab_table --nt --pplacer_threads 16 -t 16 -x fa /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/
[2023-10-24 17:46:47] INFO: [CheckM - tree] Placing bins in reference genome tree.
[2023-10-24 17:46:47] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:46:47] INFO: Identifying marker genes in 3 bins with 16 threads:
    Finished processing 0 of 3 (0.00%) bins.14500 200.14978194236755 72.45 q/s (% mem usage: 41.70, % mem avail: 58.31)
15000 201.65945434570312 74.38 q/s (% mem usage: 41.70, % mem avail: 58.26)
15500 203.18834280967712 76.28 q/s (% mem usage: 41.80, % mem avail: 58.21)
16000 204.53131794929504 78.23 q/s (% mem usage: 41.90, % mem avail: 58.14)
16500 206.03193926811218 80.08 q/s (% mem usage: 42.10, % mem avail: 57.85)
    Finished processing 1 of 3 (33.33%) bins.    Finished processing 2 of 3 (66.67%) bins.17000 207.43405938148499 81.95 q/s (% mem usage: 41.80, % mem avail: 58.17)
17500 208.80121231079102 83.81 q/s (% mem usage: 41.80, % mem avail: 58.17)
18000 210.15412068367004 85.65 q/s (% mem usage: 41.80, % mem avail: 58.17)
18500 211.56358242034912 87.44 q/s (% mem usage: 41.80, % mem avail: 58.17)
19000 213.03336191177368 89.19 q/s (% mem usage: 41.80, % mem avail: 58.17)
19500 214.38588571548462 90.96 q/s (% mem usage: 41.80, % mem avail: 58.17)
20000 216.00209999084473 92.59 q/s (% mem usage: 41.80, % mem avail: 58.17)
20500 217.49114322662354 94.26 q/s (% mem usage: 41.80, % mem avail: 58.17)
21000 218.8447082042694 95.96 q/s (% mem usage: 42.00, % mem avail: 58.03)
21500 220.48596239089966 97.51 q/s (% mem usage: 42.20, % mem avail: 57.76)
22000 222.04662561416626 99.08 q/s (% mem usage: 42.10, % mem avail: 57.92)
22500 223.54031085968018 100.65 q/s (% mem usage: 42.10, % mem avail: 57.87)
23000 225.17728519439697 102.14 q/s (% mem usage: 42.10, % mem avail: 57.88)
23500 226.69464206695557 103.66 q/s (% mem usage: 42.00, % mem avail: 58.05)
24000 228.16741943359375 105.19 q/s (% mem usage: 42.00, % mem avail: 58.05)
24500 229.6624002456665 106.68 q/s (% mem usage: 42.00, % mem avail: 58.05)
25000 231.25074410438538 108.11 q/s (% mem usage: 42.10, % mem avail: 57.91)
25500 232.8112256526947 109.53 q/s (% mem usage: 35.40, % mem avail: 64.61)
[2023-10-24 17:47:21] INFO: { Current stage: 0:05:44.080 || Total: 0:05:44.080 }
[2023-10-24 17:47:21] INFO: [CheckM - lineage_set] Inferring lineage-specific marker sets.
[2023-10-24 17:47:21] INFO: Reading HMM info from file.
[2023-10-24 17:47:21] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 6 (16.67%) bins.    Finished parsing hits for 2 of 6 (33.33%) bins.    Finished parsing hits for 3 of 6 (50.00%) bins.    Finished parsing hits for 4 of 6 (66.67%) bins.    Finished parsing hits for 5 of 6 (83.33%) bins.    Finished parsing hits for 6 of 6 (100.00%) bins.[2023-10-24 17:47:21] INFO: Determining marker sets for each genome bin.
26000 234.35099148750305 110.94 q/s (% mem usage: 24.00, % mem avail: 76.03)

    Finished processing 1 of 6 (16.67%) bins (current: mag.4).                                                                  Finished processing 2 of 6 (33.33%) bins (current: mag.2).                                                                  Finished processing 3 of 6 (50.00%) bins (current: mag.tooShort).                                                                         Finished processing 4 of 6 (66.67%) bins (current: mag.unbinned).                                                                         Finished processing 5 of 6 (83.33%) bins (current: mag.3).                                                                  Finished processing 6 of 6 (100.00%) bins (current: mag.1).[2023-10-24 17:47:22] INFO: Marker set written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/lineage.ms
[2023-10-24 17:47:22] INFO: { Current stage: 0:00:01.489 || Total: 0:05:45.569 }
[2023-10-24 17:47:22] INFO: [CheckM - analyze] Identifying marker genes in bins.
[2023-10-24 17:47:22] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:47:23] INFO: Identifying marker genes in 6 bins with 16 threads:

    Finished processing 0 of 6 (0.00%) bins.26500 235.9956750869751 112.29 q/s (% mem usage: 24.10, % mem avail: 75.93)
27000 237.68394470214844 113.60 q/s (% mem usage: 24.10, % mem avail: 75.92)
27500 239.22272944450378 114.96 q/s (% mem usage: 24.10, % mem avail: 75.93)
28000 240.70168948173523 116.33 q/s (% mem usage: 24.10, % mem avail: 75.92)
28500 242.25923132896423 117.64 q/s (% mem usage: 24.10, % mem avail: 75.92)
    Finished processing 1 of 6 (16.67%) bins.29000 243.75065755844116 118.97 q/s (% mem usage: 24.10, % mem avail: 75.94)
29500 245.2487494945526 120.29 q/s (% mem usage: 24.10, % mem avail: 75.94)
30000 246.91456532478333 121.50 q/s (% mem usage: 24.10, % mem avail: 75.93)
    Finished processing 2 of 6 (33.33%) bins.30500 248.382981300354 122.79 q/s (% mem usage: 24.10, % mem avail: 75.94)
31000 249.94132685661316 124.03 q/s (% mem usage: 24.00, % mem avail: 75.95)
31500 251.50774669647217 125.24 q/s (% mem usage: 24.10, % mem avail: 75.94)
32000 252.98690223693848 126.49 q/s (% mem usage: 24.10, % mem avail: 75.94)
32500 254.45305228233337 127.72 q/s (% mem usage: 24.10, % mem avail: 75.94)
33000 256.0933151245117 128.86 q/s (% mem usage: 24.10, % mem avail: 75.94)
33500 257.75158977508545 129.97 q/s (% mem usage: 24.10, % mem avail: 75.94)
34000 259.3026809692383 131.12 q/s (% mem usage: 24.10, % mem avail: 75.93)
34500 260.8983688354492 132.24 q/s (% mem usage: 24.10, % mem avail: 75.92)
35000 262.4107985496521 133.38 q/s (% mem usage: 24.10, % mem avail: 75.92)
35500 263.7483170032501 134.60 q/s (% mem usage: 24.10, % mem avail: 75.93)
36000 265.31544065475464 135.69 q/s (% mem usage: 24.10, % mem avail: 75.92)
36500 266.8862073421478 136.76 q/s (% mem usage: 24.10, % mem avail: 75.92)
37000 268.6211676597595 137.74 q/s (% mem usage: 24.10, % mem avail: 75.92)
    Finished processing 3 of 6 (50.00%) bins.37500 270.13534450531006 138.82 q/s (% mem usage: 24.10, % mem avail: 75.94)
38000 271.82134556770325 139.80 q/s (% mem usage: 24.00, % mem avail: 75.95)
38500 273.6504509449005 140.69 q/s (% mem usage: 24.10, % mem avail: 75.95)
39000 275.0172417163849 141.81 q/s (% mem usage: 24.10, % mem avail: 75.94)
39500 276.56158924102783 142.83 q/s (% mem usage: 24.10, % mem avail: 75.94)
40000 278.22961163520813 143.77 q/s (% mem usage: 24.10, % mem avail: 75.94)
40500 279.9038083553314 144.69 q/s (% mem usage: 24.10, % mem avail: 75.94)
41000 281.4815230369568 145.66 q/s (% mem usage: 24.10, % mem avail: 75.93)
41500 283.12868070602417 146.58 q/s (% mem usage: 24.10, % mem avail: 75.93)
    Finished processing 4 of 6 (66.67%) bins.42000 284.744038105011 147.50 q/s (% mem usage: 24.10, % mem avail: 75.94)
    Finished processing 5 of 6 (83.33%) bins.42500 286.1316964626312 148.53 q/s (% mem usage: 24.00, % mem avail: 75.96)
43000 287.68300580978394 149.47 q/s (% mem usage: 24.00, % mem avail: 75.95)
43500 289.30048179626465 150.36 q/s (% mem usage: 24.00, % mem avail: 75.95)
44000 290.97775411605835 151.21 q/s (% mem usage: 24.00, % mem avail: 75.95)
44500 292.4594888687134 152.16 q/s (% mem usage: 24.00, % mem avail: 75.96)
45000 293.9763367176056 153.07 q/s (% mem usage: 24.00, % mem avail: 75.96)
45500 295.5385024547577 153.96 q/s (% mem usage: 24.00, % mem avail: 75.95)
46000 297.19910168647766 154.78 q/s (% mem usage: 24.00, % mem avail: 75.95)
46500 298.7458574771881 155.65 q/s (% mem usage: 24.00, % mem avail: 75.96)
47000 300.36282539367676 156.48 q/s (% mem usage: 24.00, % mem avail: 75.96)
    Finished processing 6 of 6 (100.00%) bins.
[2023-10-24 17:48:29] INFO: Saving HMM info to file.
47500 301.93226313591003 157.32 q/s (% mem usage: 24.00, % mem avail: 76.02)
[2023-10-24 17:48:29] INFO: { Current stage: 0:01:06.804 || Total: 0:06:52.374 }
[2023-10-24 17:48:29] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 6 (16.67%) bins.    Finished parsing hits for 2 of 6 (33.33%) bins.    Finished parsing hits for 3 of 6 (50.00%) bins.    Finished parsing hits for 4 of 6 (66.67%) bins.    Finished parsing hits for 5 of 6 (83.33%) bins.    Finished parsing hits for 6 of 6 (100.00%) bins.[2023-10-24 17:48:30] INFO: Aligning marker genes with multiple hits in a single bin:

    Finished processing 0 of 6 (0.00%) bins.    Finished processing 1 of 6 (16.67%) bins.    Finished processing 2 of 6 (33.33%) bins.    Finished processing 3 of 6 (50.00%) bins.    Finished processing 4 of 6 (66.67%) bins.48000 303.55290699005127 158.13 q/s (% mem usage: 24.00, % mem avail: 75.97)
    Finished processing 5 of 6 (83.33%) bins.48500 305.04316544532776 158.99 q/s (% mem usage: 24.00, % mem avail: 75.99)
    Finished processing 6 of 6 (100.00%) bins.
[2023-10-24 17:48:32] INFO: { Current stage: 0:00:03.169 || Total: 0:06:55.543 }
[2023-10-24 17:48:32] INFO: Calculating genome statistics for 6 bins with 16 threads:
    Finished processing 0 of 6 (0.00%) bins.    Finished processing 1 of 6 (16.67%) bins.    Finished processing 2 of 6 (33.33%) bins.    Finished processing 3 of 6 (50.00%) bins.    Finished processing 4 of 6 (66.67%) bins.    Finished processing 5 of 6 (83.33%) bins.49000 306.5115656852722 159.86 q/s (% mem usage: 24.10, % mem avail: 75.89)
    Finished processing 6 of 6 (100.00%) bins.
[2023-10-24 17:48:35] INFO: { Current stage: 0:00:02.620 || Total: 0:06:58.163 }
[2023-10-24 17:48:35] INFO: [CheckM - qa] Tabulating genome statistics.
[2023-10-24 17:48:35] INFO: Calculating AAI between multi-copy marker genes.
[2023-10-24 17:48:35] INFO: Reading HMM info from file.
[2023-10-24 17:48:35] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 6 (16.67%) bins.    Finished parsing hits for 2 of 6 (33.33%) bins.49500 308.14279532432556 160.64 q/s (% mem usage: 24.10, % mem avail: 75.91)
    Finished parsing hits for 3 of 6 (50.00%) bins.    Finished parsing hits for 4 of 6 (66.67%) bins.    Finished parsing hits for 5 of 6 (83.33%) bins.    Finished parsing hits for 6 of 6 (100.00%) bins.Bin Id	Marker lineage	# genomes	# markers	# marker sets	0	1	2	3	4	5+	Completeness	Contamination	Strain heterogeneity
mag.1	o__Lactobacillales (UID544)	293	475	267	3	472	0	0	0	0	99.25	0.00	0.00
mag.2	o__Lactobacillales (UID355)	490	334	183	5	321	8	0	0	0	99.00	2.55	0.00
mag.3	f__Pasteurellaceae (UID4932)	83	765	438	454	299	12	0	0	0	40.00	0.92	16.67
mag.4	k__Bacteria (UID203)	5449	101	58	96	5	0	0	0	0	6.90	0.00	0.00
mag.tooShort	root (UID1)	5656	56	24	2	3	0	1	2	48	91.67	892.83	3.07
mag.unbinned	f__Neisseriaceae (UID3890)	69	657	443	354	226	70	7	0	0	42.85	10.54	3.30
[2023-10-24 17:48:36] INFO: { Current stage: 0:00:01.103 || Total: 0:06:59.267 }

[Tue Oct 24 17:48:36 2023]
Finished job 114.
86 of 139 steps (62%) done

[Tue Oct 24 17:48:36 2023]
rule checkm_qa:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/lineage.ms
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_qa.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tax.txt
    jobid: 113
    wildcards: sample=S6
    threads: 16

checkm qa -o 2 --tab_table -t 16 -f /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_qa.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/lineage.ms /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/ && checkm tree_qa -o 2 --tab_table -f /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tax.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/
50000 309.6700687408447 161.46 q/s (% mem usage: 24.00, % mem avail: 75.96)
[2023-10-24 17:48:37] INFO: CheckM v1.1.3
[2023-10-24 17:48:37] INFO: checkm qa -o 2 --tab_table -t 16 -f /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_qa.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/lineage.ms /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/
[2023-10-24 17:48:37] INFO: [CheckM - qa] Tabulating genome statistics.
[2023-10-24 17:48:37] INFO: Calculating AAI between multi-copy marker genes.
[2023-10-24 17:48:37] INFO: Reading HMM info from file.
[2023-10-24 17:48:37] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 6 (16.67%) bins.    Finished parsing hits for 2 of 6 (33.33%) bins.    Finished parsing hits for 3 of 6 (50.00%) bins.    Finished parsing hits for 4 of 6 (66.67%) bins.    Finished parsing hits for 5 of 6 (83.33%) bins.    Finished parsing hits for 6 of 6 (100.00%) bins.[2023-10-24 17:48:38] INFO: QA information written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_qa.txt
[2023-10-24 17:48:38] INFO: { Current stage: 0:00:01.167 || Total: 0:00:01.167 }

50500 311.081595659256 162.34 q/s (% mem usage: 24.00, % mem avail: 75.98)
[2023-10-24 17:48:39] INFO: CheckM v1.1.3
[2023-10-24 17:48:39] INFO: checkm tree_qa -o 2 --tab_table -f /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tax.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/
[2023-10-24 17:48:39] INFO: [CheckM - tree_qa] Assessing phylogenetic markers found in each bin.
[2023-10-24 17:48:39] INFO: Reading HMM info from file.
[2023-10-24 17:48:39] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 6 (16.67%) bins.    Finished parsing hits for 2 of 6 (33.33%) bins.    Finished parsing hits for 3 of 6 (50.00%) bins.    Finished parsing hits for 4 of 6 (66.67%) bins.    Finished parsing hits for 5 of 6 (83.33%) bins.    Finished parsing hits for 6 of 6 (100.00%) bins.51000 312.4772574901581 163.21 q/s (% mem usage: 24.00, % mem avail: 75.96)
[2023-10-24 17:48:41] INFO: QA information written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tax.txt
[2023-10-24 17:48:41] INFO: { Current stage: 0:00:02.157 || Total: 0:00:02.157 }

51500 314.04629373550415 163.99 q/s (% mem usage: 24.10, % mem avail: 75.92)
[Tue Oct 24 17:48:41 2023]
Finished job 113.
87 of 139 steps (63%) done

[Tue Oct 24 17:48:41 2023]
rule checkm_plots:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/metabat2_run.done, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/lineage.ms
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/checkm_plots.done
    jobid: 125
    wildcards: sample=S6


            checkm coding_plot --image_type pdf  -x fa /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/ 95 || true
            checkm marker_plot --image_type pdf  -x fa --dpi 400 /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/ || true
            checkm nx_plot --image_type pdf  -x fa /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/ || true
            touch /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/checkm_plots.done
            

[Tue Oct 24 17:48:41 2023]
rule join_profiles_tax:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tax.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_qa.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_profiles.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/tmp1.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/tmp2.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tmpsum.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_SUMMARY.txt
    jobid: 112
    wildcards: sample=S6

cut /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tax.txt -f1,5 > /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/tmp1.txt && cut /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_qa.txt -f1,6-11,13,15,17,19,23 > /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/tmp2.txt && paste /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/tmp1.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/tmp2.txt > /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tmpsum.txt && join /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_profiles.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tmpsum.txt -t $'\t' | cut -f 1,3,4,6,7-19 | sed 's/final.assembly: //g' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_SUMMARY.txt

[Tue Oct 24 17:48:41 2023]
rule taxbin_krona_txt:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_profiles.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tax.txt
    output: /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S6_4krona.txt
    jobid: 129
    wildcards: sample=S6

join /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_profiles.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tax.txt -t $'\t' | cut -f6,10,11 | sed -e 's/..__/\t/g' | sed -e 's/\tunresolved//g' | sed -e '1 s/^/#/' > /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S6_4krona.txt
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/tmp1.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/tmp2.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tmpsum.txt.
[Tue Oct 24 17:48:41 2023]
Finished job 112.
88 of 139 steps (63%) done
[Tue Oct 24 17:48:41 2023]
Finished job 129.
89 of 139 steps (64%) done
[2023-10-24 17:48:42] INFO: CheckM v1.1.3
[2023-10-24 17:48:42] INFO: checkm coding_plot --image_type pdf -x fa /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/ 95
[2023-10-24 17:48:42] INFO: [CheckM - coding_plot] Creating coding density histogram and delta-CD plot.
[2023-10-24 17:48:42] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:48:42] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/mag.1.fa (1 of 6)
52000 315.34784507751465 164.90 q/s (% mem usage: 24.20, % mem avail: 75.79)
52500 316.72157192230225 165.76 q/s (% mem usage: 24.10, % mem avail: 75.92)
[2023-10-24 17:48:44] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.1.coding_density_plots.pdf
[2023-10-24 17:48:44] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/mag.2.fa (2 of 6)
53000 318.24139380455017 166.54 q/s (% mem usage: 24.10, % mem avail: 75.86)
[2023-10-24 17:48:47] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.2.coding_density_plots.pdf
[2023-10-24 17:48:47] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/mag.3.fa (3 of 6)
53500 319.6210284233093 167.39 q/s (% mem usage: 24.20, % mem avail: 75.84)
54000 320.98389291763306 168.23 q/s (% mem usage: 24.20, % mem avail: 75.84)
[2023-10-24 17:48:49] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.3.coding_density_plots.pdf
[2023-10-24 17:48:49] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/mag.4.fa (4 of 6)
54500 322.5307273864746 168.98 q/s (% mem usage: 24.20, % mem avail: 75.84)
[2023-10-24 17:48:50] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.4.coding_density_plots.pdf
[2023-10-24 17:48:50] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/mag.tooShort.fa (5 of 6)
55000 324.07941365242004 169.71 q/s (% mem usage: 24.30, % mem avail: 75.67)
55500 325.4678444862366 170.52 q/s (% mem usage: 24.30, % mem avail: 75.70)
[2023-10-24 17:48:53] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.tooShort.coding_density_plots.pdf
[2023-10-24 17:48:53] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/mag.unbinned.fa (6 of 6)
56000 326.895370721817 171.31 q/s (% mem usage: 24.20, % mem avail: 75.81)
[2023-10-24 17:48:56] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.unbinned.coding_density_plots.pdf
[2023-10-24 17:48:56] INFO: { Current stage: 0:00:13.382 || Total: 0:00:13.382 }
/usr/local/lib/python3.7/dist-packages/checkm/plot/codingDensityPlots.py:180: UserWarning: FixedFormatter should only be used together with FixedLocator
  axesDeltaCD.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/codingDensityPlots.py:180: UserWarning: FixedFormatter should only be used together with FixedLocator
  axesDeltaCD.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/codingDensityPlots.py:180: UserWarning: FixedFormatter should only be used together with FixedLocator
  axesDeltaCD.set_yticklabels(kbpLabels)
56500 328.31568241119385 172.09 q/s (% mem usage: 24.20, % mem avail: 75.82)
[2023-10-24 17:48:57] INFO: CheckM v1.1.3
[2023-10-24 17:48:57] INFO: checkm marker_plot --image_type pdf -x fa --dpi 400 /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/
[2023-10-24 17:48:57] INFO: [CheckM - marker_plot] Creating marker gene position plot.
[2023-10-24 17:48:57] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:48:57] INFO: Plotting marker gene position plot for mag.1 (1 of 6)
[2023-10-24 17:48:57] INFO: Markers reside on 42 of 47 sequences which span 1.98 of 2.04 (97.5%) Mb

Unexpected error: <class 'AttributeError'>
Traceback (most recent call last):
  File "/usr/local/bin/checkm", line 611, in <module>
    checkmParser.parseOptions(args)
  File "/usr/local/lib/python3.7/dist-packages/checkm/main.py", line 885, in parseOptions
    self.markerPlot(options)
  File "/usr/local/lib/python3.7/dist-packages/checkm/main.py", line 603, in markerPlot
    bPlotted = plot.plot(f, markerGeneStats[binId], binStats[binId])
  File "/usr/local/lib/python3.7/dist-packages/checkm/plot/markerGenePosPlot.py", line 112, in plot
    yLabelBounds = self.yLabelExtents(yLabels, self.options.font_size)
  File "/usr/local/lib/python3.7/dist-packages/checkm/plot/AbstractPlot.py", line 124, in yLabelExtents
    bboxi = bbox.inverse_transformed(self.fig.transFigure)
AttributeError: 'Bbox' object has no attribute 'inverse_transformed'
57000 329.7852461338043 172.84 q/s (% mem usage: 24.00, % mem avail: 75.97)
[2023-10-24 17:48:58] INFO: CheckM v1.1.3
[2023-10-24 17:48:58] INFO: checkm nx_plot --image_type pdf -x fa /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/
[2023-10-24 17:48:58] INFO: [CheckM - nx_plot] Creating Nx-plots.
[2023-10-24 17:48:58] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:48:58] INFO: Plotting Nx-plot for mag.1 (1 of 6)
[2023-10-24 17:48:58] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.1.nx_plot.pdf
[2023-10-24 17:48:58] INFO: Plotting Nx-plot for mag.2 (2 of 6)
[2023-10-24 17:48:58] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.2.nx_plot.pdf
[2023-10-24 17:48:58] INFO: Plotting Nx-plot for mag.3 (3 of 6)
[2023-10-24 17:48:58] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.3.nx_plot.pdf
[2023-10-24 17:48:58] INFO: Plotting Nx-plot for mag.4 (4 of 6)
[2023-10-24 17:48:58] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.4.nx_plot.pdf
[2023-10-24 17:48:58] INFO: Plotting Nx-plot for mag.tooShort (5 of 6)
57500 331.21749997138977 173.60 q/s (% mem usage: 24.10, % mem avail: 75.91)
[2023-10-24 17:48:59] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.tooShort.nx_plot.pdf
[2023-10-24 17:48:59] INFO: Plotting Nx-plot for mag.unbinned (6 of 6)
[2023-10-24 17:48:59] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/mag.unbinned.nx_plot.pdf
[2023-10-24 17:48:59] INFO: { Current stage: 0:00:01.530 || Total: 0:00:01.530 }
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/metabat2_run.done.
[Tue Oct 24 17:48:59 2023]
Finished job 125.
90 of 139 steps (65%) done
58000 332.6968204975128 174.33 q/s (% mem usage: 24.00, % mem avail: 75.99)
58500 334.0527398586273 175.12 q/s (% mem usage: 24.00, % mem avail: 75.99)
59000 335.45978236198425 175.88 q/s (% mem usage: 24.00, % mem avail: 75.99)
59500 336.84583139419556 176.64 q/s (% mem usage: 24.00, % mem avail: 75.99)
60000 338.30162596702576 177.36 q/s (% mem usage: 24.00, % mem avail: 75.99)
60500 339.8248779773712 178.03 q/s (% mem usage: 24.00, % mem avail: 75.99)
61000 341.30860328674316 178.72 q/s (% mem usage: 24.00, % mem avail: 75.99)
61500 342.73144459724426 179.44 q/s (% mem usage: 24.00, % mem avail: 75.99)
62000 344.14569425582886 180.16 q/s (% mem usage: 24.00, % mem avail: 75.99)
62500 345.53648018836975 180.88 q/s (% mem usage: 24.00, % mem avail: 75.99)
63000 346.89736700057983 181.61 q/s (% mem usage: 24.00, % mem avail: 75.99)
63500 348.3491313457489 182.29 q/s (% mem usage: 24.00, % mem avail: 75.99)
64000 350.00413632392883 182.85 q/s (% mem usage: 24.00, % mem avail: 75.99)
64500 351.5092132091522 183.49 q/s (% mem usage: 24.00, % mem avail: 75.99)
65000 352.87830352783203 184.20 q/s (% mem usage: 24.00, % mem avail: 75.99)
65500 354.3497095108032 184.85 q/s (% mem usage: 24.00, % mem avail: 75.99)
66000 355.8804416656494 185.46 q/s (% mem usage: 24.00, % mem avail: 75.99)
66500 357.3683259487152 186.08 q/s (% mem usage: 24.00, % mem avail: 75.99)
67000 358.72132897377014 186.77 q/s (% mem usage: 24.00, % mem avail: 75.99)
67500 360.1944670677185 187.40 q/s (% mem usage: 24.00, % mem avail: 75.99)
68000 361.57960271835327 188.06 q/s (% mem usage: 24.00, % mem avail: 75.99)
68500 363.07808232307434 188.66 q/s (% mem usage: 24.00, % mem avail: 75.99)
69000 364.6021180152893 189.25 q/s (% mem usage: 24.00, % mem avail: 75.99)
69500 366.0674877166748 189.86 q/s (% mem usage: 24.00, % mem avail: 75.99)
70000 367.5084066390991 190.47 q/s (% mem usage: 24.00, % mem avail: 75.99)
70500 369.02245593070984 191.05 q/s (% mem usage: 24.00, % mem avail: 75.99)
71000 370.42171907424927 191.67 q/s (% mem usage: 24.00, % mem avail: 75.99)
71500 371.8427755832672 192.29 q/s (% mem usage: 24.00, % mem avail: 75.99)
72000 373.2214517593384 192.91 q/s (% mem usage: 24.00, % mem avail: 75.99)
72500 374.6900999546051 193.49 q/s (% mem usage: 24.00, % mem avail: 75.99)
73000 376.1828956604004 194.05 q/s (% mem usage: 24.00, % mem avail: 75.99)
73500 377.5322918891907 194.69 q/s (% mem usage: 24.00, % mem avail: 75.99)
74000 378.9703052043915 195.27 q/s (% mem usage: 24.00, % mem avail: 75.99)
74500 380.3852083683014 195.85 q/s (% mem usage: 24.00, % mem avail: 75.99)
75000 381.7413580417633 196.47 q/s (% mem usage: 24.00, % mem avail: 75.99)
75500 382.95817494392395 197.15 q/s (% mem usage: 24.00, % mem avail: 75.99)
76000 384.3715126514435 197.73 q/s (% mem usage: 24.00, % mem avail: 75.99)
76500 385.8725869655609 198.25 q/s (% mem usage: 23.90, % mem avail: 76.06)
77000 387.27692127227783 198.82 q/s (% mem usage: 24.00, % mem avail: 76.03)
77500 388.7353913784027 199.36 q/s (% mem usage: 24.00, % mem avail: 76.03)
78000 390.1485550403595 199.92 q/s (% mem usage: 24.00, % mem avail: 76.03)
    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:49:58] INFO: Saving HMM info to file.
[2023-10-24 17:49:58] INFO: Calculating genome statistics for 3 bins with 16 threads:
    Finished processing 0 of 3 (0.00%) bins.    Finished processing 1 of 3 (33.33%) bins.    Finished processing 2 of 3 (66.67%) bins.78500 391.57988142967224 200.47 q/s (% mem usage: 23.70, % mem avail: 76.25)
79000 393.009957075119 201.01 q/s (% mem usage: 23.90, % mem avail: 76.12)
    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:50:01] INFO: Extracting marker genes to align.
[2023-10-24 17:50:01] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.[2023-10-24 17:50:02] INFO: Extracting 43 HMMs with 16 threads:

    Finished extracting 0 of 43 (0.00%) HMMs.    Finished extracting 1 of 43 (2.33%) HMMs.    Finished extracting 2 of 43 (4.65%) HMMs.    Finished extracting 3 of 43 (6.98%) HMMs.    Finished extracting 4 of 43 (9.30%) HMMs.    Finished extracting 5 of 43 (11.63%) HMMs.    Finished extracting 6 of 43 (13.95%) HMMs.    Finished extracting 7 of 43 (16.28%) HMMs.    Finished extracting 8 of 43 (18.60%) HMMs.    Finished extracting 9 of 43 (20.93%) HMMs.    Finished extracting 10 of 43 (23.26%) HMMs.    Finished extracting 11 of 43 (25.58%) HMMs.    Finished extracting 12 of 43 (27.91%) HMMs.    Finished extracting 13 of 43 (30.23%) HMMs.    Finished extracting 14 of 43 (32.56%) HMMs.    Finished extracting 15 of 43 (34.88%) HMMs.    Finished extracting 16 of 43 (37.21%) HMMs.    Finished extracting 17 of 43 (39.53%) HMMs.79500 394.25149273872375 201.65 q/s (% mem usage: 23.70, % mem avail: 76.29)
    Finished extracting 18 of 43 (41.86%) HMMs.    Finished extracting 19 of 43 (44.19%) HMMs.    Finished extracting 20 of 43 (46.51%) HMMs.    Finished extracting 21 of 43 (48.84%) HMMs.    Finished extracting 22 of 43 (51.16%) HMMs.    Finished extracting 23 of 43 (53.49%) HMMs.    Finished extracting 24 of 43 (55.81%) HMMs.    Finished extracting 25 of 43 (58.14%) HMMs.    Finished extracting 26 of 43 (60.47%) HMMs.    Finished extracting 27 of 43 (62.79%) HMMs.    Finished extracting 28 of 43 (65.12%) HMMs.    Finished extracting 29 of 43 (67.44%) HMMs.    Finished extracting 30 of 43 (69.77%) HMMs.    Finished extracting 31 of 43 (72.09%) HMMs.    Finished extracting 32 of 43 (74.42%) HMMs.    Finished extracting 33 of 43 (76.74%) HMMs.    Finished extracting 34 of 43 (79.07%) HMMs.    Finished extracting 35 of 43 (81.40%) HMMs.    Finished extracting 36 of 43 (83.72%) HMMs.    Finished extracting 37 of 43 (86.05%) HMMs.    Finished extracting 38 of 43 (88.37%) HMMs.    Finished extracting 39 of 43 (90.70%) HMMs.    Finished extracting 40 of 43 (93.02%) HMMs.    Finished extracting 41 of 43 (95.35%) HMMs.    Finished extracting 42 of 43 (97.67%) HMMs.    Finished extracting 43 of 43 (100.00%) HMMs.
[2023-10-24 17:50:02] INFO: Aligning 43 marker genes with 16 threads:
    Finished aligning 0 of 43 (0.00%) marker genes.    Finished aligning 1 of 43 (2.33%) marker genes.    Finished aligning 2 of 43 (4.65%) marker genes.    Finished aligning 3 of 43 (6.98%) marker genes.    Finished aligning 4 of 43 (9.30%) marker genes.    Finished aligning 5 of 43 (11.63%) marker genes.    Finished aligning 6 of 43 (13.95%) marker genes.    Finished aligning 7 of 43 (16.28%) marker genes.    Finished aligning 8 of 43 (18.60%) marker genes.    Finished aligning 9 of 43 (20.93%) marker genes.    Finished aligning 10 of 43 (23.26%) marker genes.    Finished aligning 11 of 43 (25.58%) marker genes.    Finished aligning 12 of 43 (27.91%) marker genes.    Finished aligning 13 of 43 (30.23%) marker genes.    Finished aligning 14 of 43 (32.56%) marker genes.    Finished aligning 15 of 43 (34.88%) marker genes.    Finished aligning 16 of 43 (37.21%) marker genes.    Finished aligning 17 of 43 (39.53%) marker genes.    Finished aligning 18 of 43 (41.86%) marker genes.    Finished aligning 19 of 43 (44.19%) marker genes.    Finished aligning 20 of 43 (46.51%) marker genes.    Finished aligning 21 of 43 (48.84%) marker genes.    Finished aligning 22 of 43 (51.16%) marker genes.    Finished aligning 23 of 43 (53.49%) marker genes.    Finished aligning 24 of 43 (55.81%) marker genes.    Finished aligning 25 of 43 (58.14%) marker genes.    Finished aligning 26 of 43 (60.47%) marker genes.    Finished aligning 27 of 43 (62.79%) marker genes.    Finished aligning 28 of 43 (65.12%) marker genes.    Finished aligning 29 of 43 (67.44%) marker genes.    Finished aligning 30 of 43 (69.77%) marker genes.    Finished aligning 31 of 43 (72.09%) marker genes.    Finished aligning 32 of 43 (74.42%) marker genes.    Finished aligning 33 of 43 (76.74%) marker genes.    Finished aligning 34 of 43 (79.07%) marker genes.    Finished aligning 35 of 43 (81.40%) marker genes.    Finished aligning 36 of 43 (83.72%) marker genes.    Finished aligning 37 of 43 (86.05%) marker genes.    Finished aligning 38 of 43 (88.37%) marker genes.    Finished aligning 39 of 43 (90.70%) marker genes.    Finished aligning 40 of 43 (93.02%) marker genes.    Finished aligning 41 of 43 (95.35%) marker genes.    Finished aligning 42 of 43 (97.67%) marker genes.    Finished aligning 43 of 43 (100.00%) marker genes.
[2023-10-24 17:50:02] INFO: Reading marker alignment files.
[2023-10-24 17:50:02] INFO: Concatenating alignments.
[2023-10-24 17:50:02] INFO: Placing 3 bins into the genome tree with pplacer (be patient).
80000 395.8751175403595 202.08 q/s (% mem usage: 23.70, % mem avail: 76.29)
80500 397.3092620372772 202.61 q/s (% mem usage: 23.70, % mem avail: 76.27)
81000 398.72551250457764 203.15 q/s (% mem usage: 23.80, % mem avail: 76.20)
81500 400.12696647644043 203.69 q/s (% mem usage: 23.90, % mem avail: 76.14)
82000 401.58734703063965 204.19 q/s (% mem usage: 23.90, % mem avail: 76.09)
82500 403.087824344635 204.67 q/s (% mem usage: 23.90, % mem avail: 76.08)
83000 404.40553069114685 205.24 q/s (% mem usage: 23.90, % mem avail: 76.06)
83500 405.92024326324463 205.71 q/s (% mem usage: 24.00, % mem avail: 76.04)
84000 407.46253776550293 206.15 q/s (% mem usage: 24.00, % mem avail: 76.03)
84500 409.07053089141846 206.57 q/s (% mem usage: 24.00, % mem avail: 76.01)
85000 410.6317939758301 207.00 q/s (% mem usage: 24.00, % mem avail: 75.99)
85500 412.08424043655396 207.48 q/s (% mem usage: 24.00, % mem avail: 75.97)
86000 413.4330801963806 208.01 q/s (% mem usage: 24.00, % mem avail: 75.96)
86500 414.86818504333496 208.50 q/s (% mem usage: 24.10, % mem avail: 75.94)
87000 416.2678654193878 209.00 q/s (% mem usage: 24.20, % mem avail: 75.83)
87500 417.71615076065063 209.47 q/s (% mem usage: 24.50, % mem avail: 75.52)
88000 419.11102628707886 209.97 q/s (% mem usage: 24.70, % mem avail: 75.28)
88500 420.51167702674866 210.46 q/s (% mem usage: 25.00, % mem avail: 75.04)
89000 422.0804543495178 210.86 q/s (% mem usage: 25.20, % mem avail: 74.79)
89500 423.46254229545593 211.35 q/s (% mem usage: 25.40, % mem avail: 74.55)
90000 424.89607405662537 211.82 q/s (% mem usage: 25.70, % mem avail: 74.33)
90500 426.3414189815521 212.27 q/s (% mem usage: 25.90, % mem avail: 74.08)
91000 427.96965861320496 212.63 q/s (% mem usage: 26.20, % mem avail: 73.82)
91500 429.4076626300812 213.08 q/s (% mem usage: 26.40, % mem avail: 73.58)
92000 430.81931233406067 213.55 q/s (% mem usage: 26.70, % mem avail: 73.35)
92500 432.41753673553467 213.91 q/s (% mem usage: 26.90, % mem avail: 73.08)
93000 433.8335313796997 214.37 q/s (% mem usage: 27.10, % mem avail: 72.85)
93500 435.33019948005676 214.78 q/s (% mem usage: 27.40, % mem avail: 72.60)
94000 436.9322566986084 215.14 q/s (% mem usage: 27.70, % mem avail: 72.34)
94500 438.3687491416931 215.57 q/s (% mem usage: 27.90, % mem avail: 72.10)
95000 439.7615919113159 216.03 q/s (% mem usage: 28.10, % mem avail: 71.88)
95500 441.4268982410431 216.34 q/s (% mem usage: 28.40, % mem avail: 71.60)
96000 442.6730754375458 216.86 q/s (% mem usage: 28.60, % mem avail: 71.40)
96500 444.18686175346375 217.25 q/s (% mem usage: 28.90, % mem avail: 71.14)
97000 445.4665503501892 217.75 q/s (% mem usage: 29.10, % mem avail: 70.94)
97500 446.9703984260559 218.14 q/s (% mem usage: 29.30, % mem avail: 70.69)
98000 448.5808186531067 218.47 q/s (% mem usage: 29.60, % mem avail: 70.43)
98500 449.9472370147705 218.91 q/s (% mem usage: 29.80, % mem avail: 70.20)
99000 451.3756101131439 219.33 q/s (% mem usage: 30.00, % mem avail: 69.97)
99500 452.8397901058197 219.72 q/s (% mem usage: 30.30, % mem avail: 69.72)
100000 454.30007553100586 220.12 q/s (% mem usage: 30.50, % mem avail: 69.48)
100500 455.74723196029663 220.52 q/s (% mem usage: 30.80, % mem avail: 69.24)
101000 457.20961570739746 220.91 q/s (% mem usage: 31.00, % mem avail: 69.00)
101500 458.5885672569275 221.33 q/s (% mem usage: 31.20, % mem avail: 68.77)
102000 459.9435935020447 221.77 q/s (% mem usage: 31.50, % mem avail: 68.54)
102500 461.46402072906494 222.12 q/s (% mem usage: 31.70, % mem avail: 68.30)
103000 463.02539348602295 222.45 q/s (% mem usage: 32.00, % mem avail: 68.03)
103500 464.56031703948975 222.79 q/s (% mem usage: 32.20, % mem avail: 67.78)
104000 466.0476701259613 223.15 q/s (% mem usage: 32.50, % mem avail: 67.54)
104500 467.6168794631958 223.47 q/s (% mem usage: 32.70, % mem avail: 67.27)
105000 469.05725026130676 223.85 q/s (% mem usage: 33.00, % mem avail: 67.04)
105500 470.6824016571045 224.14 q/s (% mem usage: 33.20, % mem avail: 66.77)
106000 472.1326336860657 224.51 q/s (% mem usage: 33.50, % mem avail: 66.53)
106500 473.66189551353455 224.84 q/s (% mem usage: 33.70, % mem avail: 66.27)
107000 475.0631866455078 225.23 q/s (% mem usage: 34.00, % mem avail: 66.05)
107500 476.74064445495605 225.49 q/s (% mem usage: 34.20, % mem avail: 65.76)
108000 478.29189372062683 225.80 q/s (% mem usage: 34.50, % mem avail: 65.50)
108500 479.77000403404236 226.15 q/s (% mem usage: 34.70, % mem avail: 65.26)
109000 481.19184041023254 226.52 q/s (% mem usage: 35.00, % mem avail: 65.02)
109500 482.6545720100403 226.87 q/s (% mem usage: 35.20, % mem avail: 64.78)
110000 484.09794330596924 227.23 q/s (% mem usage: 35.50, % mem avail: 64.54)
110500 485.5267231464386 227.59 q/s (% mem usage: 35.70, % mem avail: 64.30)
111000 487.1074137687683 227.88 q/s (% mem usage: 35.90, % mem avail: 64.06)
111500 488.623375415802 228.19 q/s (% mem usage: 36.20, % mem avail: 63.84)
112000 490.1830892562866 228.49 q/s (% mem usage: 36.40, % mem avail: 63.61)
112500 491.67334485054016 228.81 q/s (% mem usage: 36.60, % mem avail: 63.39)
113000 493.19328212738037 229.12 q/s (% mem usage: 36.80, % mem avail: 63.16)
113500 494.64076113700867 229.46 q/s (% mem usage: 37.10, % mem avail: 62.95)
114000 496.0692808628082 229.81 q/s (% mem usage: 37.30, % mem avail: 62.74)
114500 497.582665681839 230.11 q/s (% mem usage: 37.50, % mem avail: 62.51)
115000 499.14905071258545 230.39 q/s (% mem usage: 37.70, % mem avail: 62.28)
115500 500.69576692581177 230.68 q/s (% mem usage: 37.90, % mem avail: 62.05)
116000 502.1674790382385 231.00 q/s (% mem usage: 38.20, % mem avail: 61.84)
116500 503.7187569141388 231.28 q/s (% mem usage: 38.40, % mem avail: 61.61)
117000 505.2503664493561 231.57 q/s (% mem usage: 38.60, % mem avail: 61.38)
117500 506.7418746948242 231.87 q/s (% mem usage: 38.80, % mem avail: 61.16)
118000 508.0770161151886 232.25 q/s (% mem usage: 39.00, % mem avail: 60.97)
118500 509.5589175224304 232.55 q/s (% mem usage: 39.30, % mem avail: 60.75)
119000 511.03546023368835 232.86 q/s (% mem usage: 39.50, % mem avail: 60.53)
119500 512.5953960418701 233.13 q/s (% mem usage: 39.70, % mem avail: 60.30)
120000 514.0255568027496 233.45 q/s (% mem usage: 39.90, % mem avail: 60.09)
120500 515.5939614772797 233.71 q/s (% mem usage: 40.10, % mem avail: 59.86)
121000 517.0176842212677 234.03 q/s (% mem usage: 40.40, % mem avail: 59.64)
121500 518.4560759067535 234.35 q/s (% mem usage: 40.60, % mem avail: 59.43)
122000 519.7897505760193 234.71 q/s (% mem usage: 40.80, % mem avail: 59.24)
122500 521.3391649723053 234.97 q/s (% mem usage: 41.00, % mem avail: 59.01)
123000 522.8482792377472 235.25 q/s (% mem usage: 41.20, % mem avail: 58.78)
123500 524.4005603790283 235.51 q/s (% mem usage: 41.40, % mem avail: 58.55)
124000 525.9132483005524 235.78 q/s (% mem usage: 41.70, % mem avail: 58.34)
124500 527.4260094165802 236.05 q/s (% mem usage: 41.70, % mem avail: 58.34)
125000 529.0117778778076 236.29 q/s (% mem usage: 41.70, % mem avail: 58.34)
125500 530.5266761779785 236.56 q/s (% mem usage: 41.70, % mem avail: 58.34)
126000 532.1206884384155 236.79 q/s (% mem usage: 41.70, % mem avail: 58.34)
126500 533.4935431480408 237.12 q/s (% mem usage: 41.70, % mem avail: 58.34)
127000 534.9958124160767 237.39 q/s (% mem usage: 41.70, % mem avail: 58.34)
127500 536.5127944946289 237.65 q/s (% mem usage: 41.70, % mem avail: 58.34)
128000 537.864629983902 237.98 q/s (% mem usage: 41.70, % mem avail: 58.34)
128500 539.4001388549805 238.23 q/s (% mem usage: 41.70, % mem avail: 58.34)
129000 540.8275277614594 238.52 q/s (% mem usage: 41.70, % mem avail: 58.34)
129500 542.2279269695282 238.83 q/s (% mem usage: 41.70, % mem avail: 58.34)
130000 543.7273836135864 239.09 q/s (% mem usage: 41.70, % mem avail: 58.34)
130500 545.2357261180878 239.35 q/s (% mem usage: 41.70, % mem avail: 58.34)
131000 546.536051273346 239.69 q/s (% mem usage: 41.70, % mem avail: 58.34)
131500 547.8839921951294 240.01 q/s (% mem usage: 41.70, % mem avail: 58.34)
132000 549.2310247421265 240.34 q/s (% mem usage: 41.70, % mem avail: 58.34)
132500 550.7606081962585 240.58 q/s (% mem usage: 41.70, % mem avail: 58.34)
133000 552.1128854751587 240.89 q/s (% mem usage: 41.70, % mem avail: 58.34)
133500 553.5576884746552 241.17 q/s (% mem usage: 41.70, % mem avail: 58.34)
134000 554.9822509288788 241.45 q/s (% mem usage: 41.70, % mem avail: 58.34)
134500 556.5320770740509 241.68 q/s (% mem usage: 41.70, % mem avail: 58.34)
135000 558.0130693912506 241.93 q/s (% mem usage: 41.70, % mem avail: 58.34)
135500 559.4626133441925 242.20 q/s (% mem usage: 41.70, % mem avail: 58.34)
136000 560.9861125946045 242.43 q/s (% mem usage: 41.70, % mem avail: 58.34)
136500 562.5349187850952 242.65 q/s (% mem usage: 41.70, % mem avail: 58.34)
137000 563.9626884460449 242.92 q/s (% mem usage: 41.70, % mem avail: 58.34)
137500 565.3713281154633 243.20 q/s (% mem usage: 41.70, % mem avail: 58.34)
138000 566.781867980957 243.48 q/s (% mem usage: 41.70, % mem avail: 58.34)
138500 568.184877872467 243.76 q/s (% mem usage: 41.70, % mem avail: 58.34)
139000 569.552568435669 244.05 q/s (% mem usage: 41.70, % mem avail: 58.34)
139500 570.873496055603 244.36 q/s (% mem usage: 41.70, % mem avail: 58.34)
140000 572.3401334285736 244.61 q/s (% mem usage: 41.70, % mem avail: 58.34)
140500 573.6435446739197 244.93 q/s (% mem usage: 41.70, % mem avail: 58.34)
141000 575.1208670139313 245.17 q/s (% mem usage: 41.70, % mem avail: 58.34)
141500 576.6909682750702 245.37 q/s (% mem usage: 41.70, % mem avail: 58.34)
142000 578.0700607299805 245.64 q/s (% mem usage: 41.70, % mem avail: 58.34)
142500 579.5361983776093 245.89 q/s (% mem usage: 41.70, % mem avail: 58.34)
143000 580.9909975528717 246.13 q/s (% mem usage: 41.70, % mem avail: 58.34)
143500 582.4540700912476 246.37 q/s (% mem usage: 41.70, % mem avail: 58.34)
144000 583.8880519866943 246.62 q/s (% mem usage: 41.70, % mem avail: 58.34)
144500 585.2060024738312 246.92 q/s (% mem usage: 41.70, % mem avail: 58.34)
145000 586.6503629684448 247.17 q/s (% mem usage: 41.70, % mem avail: 58.34)
145281 597.6458888053894 243.09 q/s (% mem usage: 41.60, % mem avail: 58.41)
#  emapper-2.1.6
# emapper.py  -i /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa -o annots --output_dir /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ --cpu 16 --itype proteins --block_size 4 --index_chunks 2 --data_dir /mnt/EFS/dbs/wgsa2/eggnog_data --override --temp_dir /nephele_data/tmp/ --scratch_dir /nephele_data/tmp/ --dbmem
[1;33m  /usr/local/lib/python3.7/dist-packages/eggnogmapper/bin/diamond blastp -d /mnt/EFS/dbs/wgsa2/eggnog_data/eggnog_proteins.dmnd -q /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa --threads 16 -o /nephele_data/tmp/annots.emapper.hits  --sensitive --iterate -e 0.001 --block-size 4.0 -c 2 --top 3  --outfmt 6 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore qcovhsp scovhsp[0m
Loading source DB...
[31mWarning: this can take a few minutes and load up to 45GB to RAM. Using --dbmem is recommended to annotate a large number of sequences.[0m
 Copying result file /nephele_data/tmp/annots.emapper.hits from scratch to /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations
 Copying result file /nephele_data/tmp/annots.emapper.seed_orthologs from scratch to /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations
 Copying result file /nephele_data/tmp/annots.emapper.annotations from scratch to /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations
[31mData in /nephele_data/tmp will be not removed. Please, clear it manually.[0m
[32mDone[0m
   /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.hits
   /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.seed_orthologs
   /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.annotations

================================================================================
CITATION:
If you use this software, please cite:

[1] eggNOG-mapper v2: functional annotation, orthology assignments, and domain 
      prediction at the metagenomic scale. Carlos P. Cantalapiedra, 
      Ana Hernandez-Plaza, Ivica Letunic, Peer Bork, Jaime Huerta-Cepas. 2021.
      Molecular Biology and Evolution, msab293, https://doi.org/10.1093/molbev/msab293

[2] eggNOG 5.0: a hierarchical, functionally and phylogenetically annotated
      orthology resource based on 5090 organisms and 2502 viruses. Jaime
      Huerta-Cepas, Damian Szklarczyk, Davide Heller, Ana Hernandez-Plaza,
      Sofia K Forslund, Helen Cook, Daniel R Mende, Ivica Letunic, Thomas
      Rattei, Lars J Jensen, Christian von Mering and Peer Bork. Nucleic Acids
      Research, Volume 47, Issue D1, 8 January 2019, Pages D309-D314,
      https://doi.org/10.1093/nar/gky1085 

[3] Sensitive protein alignments at tree-of-life scale using DIAMOND.
       Buchfink B, Reuter K, Drost HG. 2021.
       Nature Methods 18, 366–368 (2021). https://doi.org/10.1038/s41592-021-01101-x

e.g. Functional annotation was performed using emapper-2.1.6 [1]
 based on eggNOG orthology data [2]. Sequence searches were performed using [3].


================================================================================

Total hits processed: 145281
Total time: 1227 secs
FINISHED
[Tue Oct 24 17:53:28 2023]
Finished job 54.
91 of 139 steps (65%) done

[Tue Oct 24 17:53:28 2023]
rule tax_classification_genes:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.fna
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_taxREPORT.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_classLOG.txt
    jobid: 93
    wildcards: sample=S6
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --threads 16  --db /mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 --confidence 0.05 /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.fna --memory-mapping --output /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt --report /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_taxREPORT.txt 2>> /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_classLOG.txt

[Tue Oct 24 17:53:28 2023]
rule gene_annotation_grep:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.annotations
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.COG.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.KEGGmap.txt
    jobid: 53
    wildcards: sample=S1


        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.annotations | cut -f 1,11 | sed -e 's/\t-//g' | grep -e $'\t' | awk '{n=split($2,s,",");for (i=1;i<=n;i++) {$2=s[i];print}}' | sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.txt || true
        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.annotations | cut -f 1,5 > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.COG.txt || true
        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.annotations | cut -f1,12 | grep "ko:" | sed 's/ko://g' | awk '{n=split($2,s,",");for (i=1;i<=n;i++) {$2=s[i];print}}' | sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.txt || true
        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.emapper.annotations | cut -f1,13 | grep "ko" | sed 's/,map.*//g' | sed 's/ko/map/g' | awk '{n=split($2,s,",");for (i=1;i<=n;i++) {$2=s[i];print}}' | sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.KEGGmap.txt || true
        
[Tue Oct 24 17:53:28 2023]
Finished job 53.
92 of 139 steps (66%) done

[Tue Oct 24 17:53:28 2023]
rule gene_annot_iTPMs:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_ABUNtab.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt
    jobid: 82
    wildcards: sample=S1


        awk -v OFS="\t" 'NR==FNR { id[$1]=$0; next } ($1 in id){ print $2, id[$1]}'  /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_ABUNtab.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.txt | sed '1s/^/#KO\tnodeID\tlen\treads\tcov\tiRPK\tiTPM\n/' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt
        awk -v OFS="\t" 'NR==FNR { id[$1]=$0; next } ($1 in id){ print $2, id[$1]}'  /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_ABUNtab.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.txt | sed '1s/^/#KO\tnodeID\tlen\treads\tcov\tiRPK\tiTPM\n/' > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt        
        

[Tue Oct 24 17:53:28 2023]
rule gene_annot_seqExtract:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.fna, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.faa, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.fna, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.faa, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.fna
    jobid: 78
    wildcards: sample=S1


        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.txt > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.faa
        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.fna /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.txt > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.fna
        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.faa /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.txt > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.faa
        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes.fna /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.txt > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.fna
        

[Tue Oct 24 17:53:28 2023]
rule copy_annotation_file:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_ABUNtab.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_TPM.txt
    jobid: 52
    wildcards: sample=S1

[Tue Oct 24 17:53:29 2023]
Finished job 82.
93 of 139 steps (67%) done

[Tue Oct 24 17:53:29 2023]
rule gene_annot_geneTPMs:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/tmp_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/S1_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/tmp_geneTPMtab.ec.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/S1_geneTPMtab.ec.txt
    jobid: 81
    wildcards: sample=S1


        cut -f1,6 /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt | sed $'s/#KO.*//g' | awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/calc_geneTPM.awk > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/tmp_geneTPMtab.ko.txt
        awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/join2files_f2.awk /usr/local/src/nephele2/pipelines/wgsa/KO_list.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/tmp_geneTPMtab.ko.txt |         sed '1s/^/#KO\tgeneTPM\tgeneNAME\n/'> /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/S1_geneTPMtab.ko.txt

        cut -f1,6 /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt | sed $'s/#EC.*//g' | awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/calc_geneTPM.awk > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/tmp_geneTPMtab.ec.txt
        awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/join2files_f2.awk /usr/local/src/nephele2/pipelines/wgsa/EC_list.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/tmp_geneTPMtab.ec.txt |         sed '1s/^/#EC\tgeneTPM\tgeneNAME\n/'> /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/S1_geneTPMtab.ec.txt
        
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/tmp_geneTPMtab.ko.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/tmp_geneTPMtab.ec.txt.
[Tue Oct 24 17:53:29 2023]
Finished job 81.
94 of 139 steps (68%) done
[Tue Oct 24 17:53:29 2023]
Finished job 78.
95 of 139 steps (68%) done
[Tue Oct 24 17:53:29 2023]
Finished job 93.
96 of 139 steps (69%) done

[Tue Oct 24 17:53:29 2023]
rule tax_classification_scaffolds:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_taxREPORT.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAXclassLOG.txt
    jobid: 103
    wildcards: sample=S6
    threads: 16
    resources: mem_gb=186

kraken2 --use-names --db /mnt/EFS/dbs/wgsa2/classification_db/plusPFV_Mar2023 --confidence 0.05 --memory-mapping --threads 16 /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly.fasta --output /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_klog.txt --report /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_taxREPORT.txt 2>> /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAXclassLOG.txt

[Tue Oct 24 17:53:29 2023]
rule tax_genes_ABUNtabtax:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_ABUNtab.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt
    jobid: 92
    wildcards: sample=S6

cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt | sed -e 's/ (taxid /\t/g' | sed -e 's/)$//g' | sort | sed '1s/^/#contigName\tTAXname\tTAXid\n/' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt &&paste /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_ABUNtab.txt <(cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt) > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt 
[33mJob counts:
	count	jobs
	1	copy_annotation_file
	1[0m
[33mcp /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt && cut -f 1,5 /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_ABUNtab.txt > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_TPM.txt[0m
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_klog.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_tmptax.txt.
[Tue Oct 24 17:53:30 2023]
Finished job 92.
97 of 139 steps (70%) done

[Tue Oct 24 17:53:30 2023]
rule tax_genes_4krona:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt
    output: /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S6_4krona.txt
    jobid: 98
    wildcards: sample=S6

cut -f6-8 /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt | awk -F'\t' 'NR>1{k = $3; sum[k]+= $1; name[k]=$2} END { print; for (k in sum) print sum[k], name[k], k}' OFS="	" |sed -e '1 s/^/#iTPM\tTAXname\tTAXid\n/' > /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S6_4krona.txt
[Tue Oct 24 17:53:30 2023]
Finished job 98.
98 of 139 steps (71%) done

[Tue Oct 24 17:53:30 2023]
rule kt_tax_html:
    input: /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S1_4krona.txt, /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S6_4krona.txt, /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S28_4krona.txt
    output: /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/TAXplots_genesTAX_RefDB.html
    jobid: 96

ktImportTaxonomy /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S1_4krona.txt /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S6_4krona.txt /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S28_4krona.txt -m 1 -q 2 -t 3 -d 10 -tax /mnt/EFS/dbs/wgsa2/KronaTools_taxonomy/ -o /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/TAXplots_genesTAX_RefDB.html
[Tue Oct 24 17:53:30 2023]
Finished job 52.
99 of 139 steps (71%) done

[Tue Oct 24 17:53:30 2023]
rule run_min_path:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_report.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.details.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.minpath.log.txt
    jobid: 57
    wildcards: sample=S1


        if [ -s /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt ]; then
            python3 /usr/local/src/MinPath/MinPath.py -any /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt -map /mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-ko2map-092022.txt -report /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_report.txt -details /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.details.txt >> /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.minpath.log.txt
        else
            echo "The input file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt is empty, so run_min_path will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_report.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.details.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.minpath.log.txt
        fi
        
   [ WARNING ]  Score column already in use; not reading scores.
[Tue Oct 24 17:53:31 2023]
Finished job 103.
100 of 139 steps (72%) done

[Tue Oct 24 17:53:31 2023]
rule generate_scafftax:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_klog.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_scaffCoverage.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_scaffCovr+tax.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt
    jobid: 102
    wildcards: sample=S6

cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_klog.txt | sed -e 's/ (taxid /\t/g' | sed -e 's/)$//g' | sort | sed '1s/^/#contigName\tTAXname\tTAXid\n/' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt && paste /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_scaffCoverage.txt <(cut -f2-3 /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt) > /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_scaffCovr+tax.txt

[Tue Oct 24 17:53:31 2023]
rule gene_annotation:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.hits, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.seed_orthologs, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.annotations
    jobid: 68
    wildcards: sample=S28
    threads: 16
    resources: mem_gb=186

emapper.py -i /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa -o annots --output_dir /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ --cpu 16 --itype proteins --block_size 4 --index_chunks 2 --data_dir /mnt/EFS/dbs/wgsa2/eggnog_data --override --temp_dir /nephele_data/tmp/  --scratch_dir /nephele_data/tmp/ --dbmem
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_klog.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAXtmp_tax.txt.
[Tue Oct 24 17:53:32 2023]
Finished job 102.
101 of 139 steps (73%) done
   [ WARNING ]  The following taxonomy IDs were not found in the local
                database and were set to root (if they were recently added to
                NCBI, use updateTaxonomy.sh to update the local database):
                2930219 2898796 2854261 2829812 2948573 2908096 2934158 2892440
                2819619 2989816 2885633 2912188 2992805 3003262 2986828 3020829
                2906077 2944234 2856555 2860286 2933797 2956784 2905121 3025666
                2986835 2949635 2973976 3020908 2831890 2932268 2995171 2897181
                3031852 2897335 2961597
Loading taxonomy...
Importing /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S1_4krona.txt...
Importing /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S6_4krona.txt...
Importing /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/bin/S28_4krona.txt...
Writing /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/TAXplots_genesTAX_RefDB.html...
[Tue Oct 24 17:53:33 2023]
Finished job 96.
102 of 139 steps (73%) done
[Tue Oct 24 17:53:49 2023]
Finished job 57.
103 of 139 steps (74%) done

[Tue Oct 24 17:53:49 2023]
rule create_pathways_report:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_report.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.report.txt
    jobid: 56
    wildcards: sample=S1


        if [ -s /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_report.txt ]; then
            grep 'minpath\ 1' /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_report.txt > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.report.txt
        else
            echo "The input file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_report.txt is empty, so create_pathways_report will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.report.txt
        fi
        
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_report.txt.
[Tue Oct 24 17:53:49 2023]
Finished job 56.
104 of 139 steps (75%) done

[Tue Oct 24 17:53:49 2023]
rule run_genes2krona:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_TPM.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.report.txt
    output: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_4kr.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/S1_4krona.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S1_4krona.txt
    jobid: 51
    wildcards: sample=S1


        if [ -s /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt -a -s /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_TPM.txt -a -s /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.report.txt ]; then
            python3 /usr/local/src/nephele2/pipelines/wgsa/genes2KronaTable.py -i /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt            -m /mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-ko2map-092022.txt -H /mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-HRCHY-092022.txt -n S1 -c /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_TPM.txt            -l /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/ko2gg.report.txt -o /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_4kr.txt &&            sed '1s/^/#/' /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_4kr.txt > /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/S1_4krona.txt &&            cp /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/S1_4krona.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S1_4krona.txt
        else
            echo "One of the input file is empty, so run_genes2krona will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_4kr.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/S1_4krona.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S1_4krona.txt
        fi
        
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_TPM.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_annots.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/tmp_4kr.txt.
[Tue Oct 24 17:53:50 2023]
Finished job 51.
105 of 139 steps (76%) done

[Tue Oct 24 17:53:50 2023]
rule pwy_biom_per_sample:
    input: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S1_4krona.txt
    output: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_4biom.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_json.biom
    jobid: 72
    wildcards: sample=S1


        if [ -s /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S1_4krona.txt ]; then
            sed 's/\t/;/g' /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S1_4krona.txt | sed 's/;/\t/1' | nl -n ln |sed '1s/^/\t/' | sed '1s/1\s\+\t#/\t/' | sed 's/\s\+\t/\t/g' | sed '1s/LINEAGE/Taxonomy/' | sed -e '1s/Level.*/Taxonomy/' > /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_4biom.txt
            biom convert -i /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_4biom.txt -o /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_json.biom --to-json --table-type='Pathway table' --process-obs-metadata taxonomy || touch /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_json.biom
        else
            echo "The input file /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S1_4krona.txt is empty, so pwy_biom_per_sample will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_4biom.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_json.biom
        fi
        
Removing temporary output file /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_4biom.txt.
[Tue Oct 24 17:53:50 2023]
Finished job 72.
106 of 139 steps (76%) done
[2023-10-24 17:54:19] INFO: { Current stage: 0:07:31.886 || Total: 0:07:31.886 }
[2023-10-24 17:54:19] INFO: [CheckM - lineage_set] Inferring lineage-specific marker sets.
[2023-10-24 17:54:19] INFO: Reading HMM info from file.
[2023-10-24 17:54:19] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.[2023-10-24 17:54:19] INFO: Determining marker sets for each genome bin.

    Finished processing 1 of 3 (33.33%) bins (current: mag.tooShort).                                                                         Finished processing 2 of 3 (66.67%) bins (current: mag.unbinned).                                                                         Finished processing 3 of 3 (100.00%) bins (current: mag.1).[2023-10-24 17:54:20] INFO: Marker set written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/lineage.ms
[2023-10-24 17:54:20] INFO: { Current stage: 0:00:01.028 || Total: 0:07:32.915 }
[2023-10-24 17:54:20] INFO: [CheckM - analyze] Identifying marker genes in bins.
[2023-10-24 17:54:20] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:54:20] INFO: Identifying marker genes in 3 bins with 16 threads:

    Finished processing 0 of 3 (0.00%) bins.    Finished processing 1 of 3 (33.33%) bins.    Finished processing 2 of 3 (66.67%) bins.    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:55:33] INFO: Saving HMM info to file.
[2023-10-24 17:55:33] INFO: { Current stage: 0:01:13.257 || Total: 0:08:46.172 }
[2023-10-24 17:55:33] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.[2023-10-24 17:55:33] INFO: Aligning marker genes with multiple hits in a single bin:

    Finished processing 0 of 3 (0.00%) bins.    Finished processing 1 of 3 (33.33%) bins.    Finished processing 2 of 3 (66.67%) bins.    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:55:36] INFO: { Current stage: 0:00:03.280 || Total: 0:08:49.452 }
[2023-10-24 17:55:36] INFO: Calculating genome statistics for 3 bins with 16 threads:
    Finished processing 0 of 3 (0.00%) bins.    Finished processing 1 of 3 (33.33%) bins.    Finished processing 2 of 3 (66.67%) bins.    Finished processing 3 of 3 (100.00%) bins.
[2023-10-24 17:55:39] INFO: { Current stage: 0:00:02.935 || Total: 0:08:52.388 }
[2023-10-24 17:55:39] INFO: [CheckM - qa] Tabulating genome statistics.
[2023-10-24 17:55:39] INFO: Calculating AAI between multi-copy marker genes.
[2023-10-24 17:55:39] INFO: Reading HMM info from file.
[2023-10-24 17:55:39] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.Bin Id	Marker lineage	# genomes	# markers	# marker sets	0	1	2	3	4	5+	Completeness	Contamination	Strain heterogeneity
mag.1	g__Staphylococcus (UID301)	45	940	178	12	927	1	0	0	0	98.24	0.08	0.00
mag.tooShort	root (UID1)	5656	56	24	2	0	3	0	0	51	91.67	943.52	4.68
mag.unbinned	f__Streptococcaceae (UID545)	240	523	282	261	192	63	6	1	0	48.14	15.87	4.60
[2023-10-24 17:55:40] INFO: { Current stage: 0:00:00.785 || Total: 0:08:53.174 }

[Tue Oct 24 17:55:40 2023]
Finished job 120.
107 of 139 steps (77%) done

[Tue Oct 24 17:55:40 2023]
rule checkm_qa:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/lineage.ms
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_qa.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tax.txt
    jobid: 119
    wildcards: sample=S28
    threads: 16

checkm qa -o 2 --tab_table -t 16 -f /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_qa.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/lineage.ms /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/ && checkm tree_qa -o 2 --tab_table -f /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tax.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/

[Tue Oct 24 17:55:40 2023]
rule checkm_plots:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/metabat2_run.done, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/lineage.ms
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/checkm_plots.done
    jobid: 126
    wildcards: sample=S28


            checkm coding_plot --image_type pdf  -x fa /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/ 95 || true
            checkm marker_plot --image_type pdf  -x fa --dpi 400 /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/ || true
            checkm nx_plot --image_type pdf  -x fa /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/ || true
            touch /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/checkm_plots.done
            
[2023-10-24 17:55:41] INFO: CheckM v1.1.3
[2023-10-24 17:55:41] INFO: checkm qa -o 2 --tab_table -t 16 -f /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_qa.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/lineage.ms /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/
[2023-10-24 17:55:41] INFO: [CheckM - qa] Tabulating genome statistics.
[2023-10-24 17:55:41] INFO: Calculating AAI between multi-copy marker genes.
[2023-10-24 17:55:41] INFO: CheckM v1.1.3
[2023-10-24 17:55:41] INFO: checkm coding_plot --image_type pdf -x fa /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/ 95
[2023-10-24 17:55:41] INFO: [CheckM - coding_plot] Creating coding density histogram and delta-CD plot.
[2023-10-24 17:55:41] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:55:41] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/mag.1.fa (1 of 3)
[2023-10-24 17:55:41] INFO: Reading HMM info from file.
[2023-10-24 17:55:41] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.[2023-10-24 17:55:42] INFO: QA information written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_qa.txt
[2023-10-24 17:55:42] INFO: { Current stage: 0:00:00.750 || Total: 0:00:00.750 }

[2023-10-24 17:55:42] INFO: CheckM v1.1.3
[2023-10-24 17:55:42] INFO: checkm tree_qa -o 2 --tab_table -f /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tax.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/
[2023-10-24 17:55:42] INFO: [CheckM - tree_qa] Assessing phylogenetic markers found in each bin.
[2023-10-24 17:55:42] INFO: Reading HMM info from file.
[2023-10-24 17:55:42] INFO: Parsing HMM hits to marker genes:
    Finished parsing hits for 1 of 3 (33.33%) bins.    Finished parsing hits for 2 of 3 (66.67%) bins.    Finished parsing hits for 3 of 3 (100.00%) bins.[2023-10-24 17:55:43] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/mag.1.coding_density_plots.pdf
[2023-10-24 17:55:43] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/mag.tooShort.fa (2 of 3)
[2023-10-24 17:55:45] INFO: QA information written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tax.txt
[2023-10-24 17:55:45] INFO: { Current stage: 0:00:02.023 || Total: 0:00:02.023 }

[Tue Oct 24 17:55:45 2023]
Finished job 119.
108 of 139 steps (78%) done

[Tue Oct 24 17:55:45 2023]
Job 131: rule make_biom
        Making biom file from 'Taxonomy (contained)' column in output of checkm tree_qa,
        'final.assembly: mapped reads' column in checkm profiles, and metadata.
        metadata: /nephele_data/inputs/wgsa_example_mapping_corrected.txt
        input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_profiles.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_profiles.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_profiles.txt /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_tax.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_tax.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tax.txt
        output: /nephele_data/outputs/TAXprofiles/MAGs_TAX/MAG-based_Counts+TAX.biom
        jobid: 131

[Tue Oct 24 17:55:45 2023]
rule join_profiles_tax:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tax.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_qa.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_profiles.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/tmp1.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/tmp2.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tmpsum.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_SUMMARY.txt
    jobid: 118
    wildcards: sample=S28

cut /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tax.txt -f1,5 > /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/tmp1.txt && cut /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_qa.txt -f1,6-11,13,15,17,19,23 > /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/tmp2.txt && paste /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/tmp1.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/tmp2.txt > /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tmpsum.txt && join /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_profiles.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tmpsum.txt -t $'\t' | cut -f 1,3,4,6,7-19 | sed 's/final.assembly: //g' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_SUMMARY.txt

[Tue Oct 24 17:55:45 2023]
rule taxbin_krona_txt:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_profiles.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tax.txt
    output: /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S28_4krona.txt
    jobid: 130
    wildcards: sample=S28

join /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_profiles.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tax.txt -t $'\t' | cut -f6,10,11 | sed -e 's/..__/\t/g' | sed -e 's/\tunresolved//g' | sed -e '1 s/^/#/' > /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S28_4krona.txt
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/tmp1.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/tmp2.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_tmpsum.txt.
[Tue Oct 24 17:55:45 2023]
Finished job 118.
109 of 139 steps (78%) done
[Tue Oct 24 17:55:45 2023]
Finished job 130.
110 of 139 steps (79%) done

[Tue Oct 24 17:55:45 2023]
rule taxbin_krona_html:
    input: /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S1_4krona.txt, /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S6_4krona.txt, /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S28_4krona.txt
    output: /nephele_data/outputs/TAXprofiles/MAGs_TAX/TAXplots_MAGx.html
    jobid: 127

ktImportText /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S1_4krona.txt /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S6_4krona.txt /nephele_data/outputs/TAXprofiles/MAGs_TAX/bin/S28_4krona.txt -o /nephele_data/outputs/TAXprofiles/MAGs_TAX/TAXplots_MAGx.html
Writing /nephele_data/outputs/TAXprofiles/MAGs_TAX/TAXplots_MAGx.html...
[Tue Oct 24 17:55:45 2023]
Finished job 127.
111 of 139 steps (80%) done
[33mJob counts:
	count	jobs
	1	make_biom
	1[0m
[Tue Oct 24 17:55:46 2023]
Finished job 131.
112 of 139 steps (81%) done
[2023-10-24 17:55:47] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/mag.tooShort.coding_density_plots.pdf
[2023-10-24 17:55:47] INFO: Plotting coding density plots for /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/mag.unbinned.fa (3 of 3)
[2023-10-24 17:55:49] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/mag.unbinned.coding_density_plots.pdf
[2023-10-24 17:55:49] INFO: { Current stage: 0:00:08.045 || Total: 0:00:08.045 }
/usr/local/lib/python3.7/dist-packages/checkm/plot/codingDensityPlots.py:180: UserWarning: FixedFormatter should only be used together with FixedLocator
  axesDeltaCD.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/codingDensityPlots.py:180: UserWarning: FixedFormatter should only be used together with FixedLocator
  axesDeltaCD.set_yticklabels(kbpLabels)
[2023-10-24 17:55:50] INFO: CheckM v1.1.3
[2023-10-24 17:55:50] INFO: checkm marker_plot --image_type pdf -x fa --dpi 400 /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/
[2023-10-24 17:55:50] INFO: [CheckM - marker_plot] Creating marker gene position plot.
[2023-10-24 17:55:50] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:55:50] INFO: Plotting marker gene position plot for mag.1 (1 of 3)
[2023-10-24 17:55:50] INFO: Markers reside on 90 of 127 sequences which span 2.27 of 2.55 (89.2%) Mb

Unexpected error: <class 'AttributeError'>
Traceback (most recent call last):
  File "/usr/local/bin/checkm", line 611, in <module>
    checkmParser.parseOptions(args)
  File "/usr/local/lib/python3.7/dist-packages/checkm/main.py", line 885, in parseOptions
    self.markerPlot(options)
  File "/usr/local/lib/python3.7/dist-packages/checkm/main.py", line 603, in markerPlot
    bPlotted = plot.plot(f, markerGeneStats[binId], binStats[binId])
  File "/usr/local/lib/python3.7/dist-packages/checkm/plot/markerGenePosPlot.py", line 112, in plot
    yLabelBounds = self.yLabelExtents(yLabels, self.options.font_size)
  File "/usr/local/lib/python3.7/dist-packages/checkm/plot/AbstractPlot.py", line 124, in yLabelExtents
    bboxi = bbox.inverse_transformed(self.fig.transFigure)
AttributeError: 'Bbox' object has no attribute 'inverse_transformed'
[2023-10-24 17:55:51] INFO: CheckM v1.1.3
[2023-10-24 17:55:51] INFO: checkm nx_plot --image_type pdf -x fa /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/ /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/
[2023-10-24 17:55:51] INFO: [CheckM - nx_plot] Creating Nx-plots.
[2023-10-24 17:55:51] WARNING: Skipping bin mag.lowDepth.fa as it has a size of 0 bytes.
[2023-10-24 17:55:51] INFO: Plotting Nx-plot for mag.1 (1 of 3)
[2023-10-24 17:55:51] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/mag.1.nx_plot.pdf
[2023-10-24 17:55:51] INFO: Plotting Nx-plot for mag.tooShort (2 of 3)
[2023-10-24 17:55:52] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/mag.tooShort.nx_plot.pdf
[2023-10-24 17:55:52] INFO: Plotting Nx-plot for mag.unbinned (3 of 3)
[2023-10-24 17:55:52] INFO: Plot written to: /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/mag.unbinned.nx_plot.pdf
[2023-10-24 17:55:52] INFO: { Current stage: 0:00:01.114 || Total: 0:00:01.114 }
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
/usr/local/lib/python3.7/dist-packages/checkm/plot/nxPlot.py:83: UserWarning: FixedFormatter should only be used together with FixedLocator
  axes.set_yticklabels(kbpLabels)
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/metabat2_run.done.
[Tue Oct 24 17:55:52 2023]
Finished job 126.
113 of 139 steps (81%) done
[1;32mFunctional annotation of hits...[0m
0 2.6226043701171875e-06 0.00 q/s (% mem usage: 1.50, % mem avail: 98.54)
[1;34mTime to load the DB into memory: 160.1423933506012[0m
500 165.13705825805664 3.03 q/s (% mem usage: 23.60, % mem avail: 76.35)
1000 168.02945184707642 5.95 q/s (% mem usage: 23.60, % mem avail: 76.35)
1500 170.98814582824707 8.77 q/s (% mem usage: 23.60, % mem avail: 76.35)
2000 173.01380133628845 11.56 q/s (% mem usage: 23.60, % mem avail: 76.35)
2500 174.43494057655334 14.33 q/s (% mem usage: 23.60, % mem avail: 76.35)
3000 176.79836773872375 16.97 q/s (% mem usage: 23.60, % mem avail: 76.35)
3500 179.75538420677185 19.47 q/s (% mem usage: 23.60, % mem avail: 76.35)
4000 182.48937463760376 21.92 q/s (% mem usage: 23.60, % mem avail: 76.35)
4500 185.36399793624878 24.28 q/s (% mem usage: 23.60, % mem avail: 76.35)
5000 188.33407473564148 26.55 q/s (% mem usage: 23.60, % mem avail: 76.35)
5500 191.247168302536 28.76 q/s (% mem usage: 23.60, % mem avail: 76.35)
6000 194.00210738182068 30.93 q/s (% mem usage: 23.60, % mem avail: 76.35)
6500 196.48067712783813 33.08 q/s (% mem usage: 23.60, % mem avail: 76.35)
7000 199.38227319717407 35.11 q/s (% mem usage: 23.60, % mem avail: 76.35)
7500 202.10686922073364 37.11 q/s (% mem usage: 23.60, % mem avail: 76.35)
8000 205.03582644462585 39.02 q/s (% mem usage: 23.60, % mem avail: 76.35)
8500 207.89507961273193 40.89 q/s (% mem usage: 23.60, % mem avail: 76.35)
9000 210.34514617919922 42.79 q/s (% mem usage: 23.60, % mem avail: 76.35)
9500 213.1254026889801 44.57 q/s (% mem usage: 23.60, % mem avail: 76.35)
10000 215.62018465995789 46.38 q/s (% mem usage: 23.60, % mem avail: 76.35)
10500 218.14828038215637 48.13 q/s (% mem usage: 23.60, % mem avail: 76.35)
11000 220.90309190750122 49.80 q/s (% mem usage: 23.60, % mem avail: 76.35)
11500 223.598247051239 51.43 q/s (% mem usage: 23.60, % mem avail: 76.35)
12000 226.06659722328186 53.08 q/s (% mem usage: 23.60, % mem avail: 76.35)
12500 228.8919186592102 54.61 q/s (% mem usage: 23.60, % mem avail: 76.35)
13000 231.691508769989 56.11 q/s (% mem usage: 23.60, % mem avail: 76.35)
13500 234.51031708717346 57.57 q/s (% mem usage: 23.60, % mem avail: 76.35)
14000 237.77380800247192 58.88 q/s (% mem usage: 23.70, % mem avail: 76.35)
14500 241.0925371646881 60.14 q/s (% mem usage: 23.70, % mem avail: 76.35)
15000 243.76352524757385 61.54 q/s (% mem usage: 23.70, % mem avail: 76.35)
15500 246.41940093040466 62.90 q/s (% mem usage: 23.70, % mem avail: 76.35)
16000 249.22169971466064 64.20 q/s (% mem usage: 23.70, % mem avail: 76.35)
16500 251.61936736106873 65.58 q/s (% mem usage: 23.70, % mem avail: 76.35)
17000 254.5604567527771 66.78 q/s (% mem usage: 23.70, % mem avail: 76.35)
17500 257.3268668651581 68.01 q/s (% mem usage: 23.70, % mem avail: 76.35)
18000 260.15194964408875 69.19 q/s (% mem usage: 23.70, % mem avail: 76.35)
18500 262.65630292892456 70.43 q/s (% mem usage: 23.70, % mem avail: 76.35)
19000 265.529324054718 71.56 q/s (% mem usage: 23.70, % mem avail: 76.35)
19500 268.49402236938477 72.63 q/s (% mem usage: 23.70, % mem avail: 76.35)
20000 271.4442639350891 73.68 q/s (% mem usage: 23.70, % mem avail: 76.35)
20500 274.152996301651 74.78 q/s (% mem usage: 23.70, % mem avail: 76.35)
21000 277.0731384754181 75.79 q/s (% mem usage: 23.70, % mem avail: 76.35)
21500 279.9883589744568 76.79 q/s (% mem usage: 23.70, % mem avail: 76.35)
22000 282.77413034439087 77.80 q/s (% mem usage: 23.60, % mem avail: 76.35)
22500 285.7219932079315 78.75 q/s (% mem usage: 23.70, % mem avail: 76.35)
23000 288.5498733520508 79.71 q/s (% mem usage: 23.60, % mem avail: 76.35)
23500 291.1074628829956 80.73 q/s (% mem usage: 23.70, % mem avail: 76.35)
24000 293.80429458618164 81.69 q/s (% mem usage: 23.70, % mem avail: 76.35)
24500 296.5584647655487 82.61 q/s (% mem usage: 23.60, % mem avail: 76.35)
25000 299.3364722728729 83.52 q/s (% mem usage: 23.60, % mem avail: 76.35)
25500 302.14322209358215 84.40 q/s (% mem usage: 23.60, % mem avail: 76.35)
26000 305.0195462703705 85.24 q/s (% mem usage: 23.60, % mem avail: 76.35)
26500 307.7078812122345 86.12 q/s (% mem usage: 23.60, % mem avail: 76.35)
27000 310.5492744445801 86.94 q/s (% mem usage: 23.60, % mem avail: 76.35)
27500 313.32270765304565 87.77 q/s (% mem usage: 23.60, % mem avail: 76.35)
28000 315.9795310497284 88.61 q/s (% mem usage: 23.60, % mem avail: 76.35)
28500 318.50975251197815 89.48 q/s (% mem usage: 23.60, % mem avail: 76.35)
29000 321.35252237319946 90.24 q/s (% mem usage: 23.60, % mem avail: 76.35)
29500 324.42284202575684 90.93 q/s (% mem usage: 23.60, % mem avail: 76.35)
30000 327.0769798755646 91.72 q/s (% mem usage: 23.60, % mem avail: 76.35)
30500 329.69430565834045 92.51 q/s (% mem usage: 23.60, % mem avail: 76.35)
31000 332.3597903251648 93.27 q/s (% mem usage: 23.60, % mem avail: 76.35)
31500 335.28969955444336 93.95 q/s (% mem usage: 23.60, % mem avail: 76.35)
32000 338.06736755371094 94.66 q/s (% mem usage: 23.60, % mem avail: 76.35)
32500 340.9473810195923 95.32 q/s (% mem usage: 23.60, % mem avail: 76.35)
33000 343.4673194885254 96.08 q/s (% mem usage: 23.60, % mem avail: 76.35)
33500 346.32693219184875 96.73 q/s (% mem usage: 23.60, % mem avail: 76.35)
34000 348.9732325077057 97.43 q/s (% mem usage: 23.60, % mem avail: 76.35)
34500 351.44509983062744 98.17 q/s (% mem usage: 23.60, % mem avail: 76.35)
35000 354.21455788612366 98.81 q/s (% mem usage: 23.60, % mem avail: 76.35)
35500 357.0492699146271 99.43 q/s (% mem usage: 23.60, % mem avail: 76.35)
36000 359.80178022384644 100.06 q/s (% mem usage: 23.60, % mem avail: 76.35)
36500 362.4960927963257 100.69 q/s (% mem usage: 23.60, % mem avail: 76.35)
37000 365.3520586490631 101.27 q/s (% mem usage: 23.60, % mem avail: 76.35)
37500 368.4237985610962 101.78 q/s (% mem usage: 23.60, % mem avail: 76.35)
38000 371.0339398384094 102.42 q/s (% mem usage: 23.60, % mem avail: 76.35)
38500 374.11209416389465 102.91 q/s (% mem usage: 23.60, % mem avail: 76.35)
39000 376.863650560379 103.49 q/s (% mem usage: 23.60, % mem avail: 76.35)
39500 379.7604947090149 104.01 q/s (% mem usage: 23.60, % mem avail: 76.35)
40000 382.4952449798584 104.58 q/s (% mem usage: 23.60, % mem avail: 76.35)
40500 385.4211492538452 105.08 q/s (% mem usage: 23.60, % mem avail: 76.35)
41000 388.250123500824 105.60 q/s (% mem usage: 23.60, % mem avail: 76.35)
41500 391.2810492515564 106.06 q/s (% mem usage: 23.60, % mem avail: 76.35)
42000 393.7665274143219 106.66 q/s (% mem usage: 23.60, % mem avail: 76.35)
42500 396.77677369117737 107.11 q/s (% mem usage: 23.60, % mem avail: 76.35)
43000 399.7742826938629 107.56 q/s (% mem usage: 23.60, % mem avail: 76.35)
43500 402.53383016586304 108.07 q/s (% mem usage: 23.60, % mem avail: 76.35)
44000 405.55172991752625 108.49 q/s (% mem usage: 23.60, % mem avail: 76.35)
44500 408.42498874664307 108.96 q/s (% mem usage: 23.60, % mem avail: 76.35)
45000 411.2901086807251 109.41 q/s (% mem usage: 23.60, % mem avail: 76.35)
45500 414.2000391483307 109.85 q/s (% mem usage: 23.60, % mem avail: 76.35)
46000 416.98409152030945 110.32 q/s (% mem usage: 23.60, % mem avail: 76.35)
46500 420.07150530815125 110.70 q/s (% mem usage: 23.60, % mem avail: 76.35)
47000 422.83065390586853 111.16 q/s (% mem usage: 23.60, % mem avail: 76.35)
47500 425.6992516517639 111.58 q/s (% mem usage: 23.60, % mem avail: 76.35)
48000 428.2416522502899 112.09 q/s (% mem usage: 23.60, % mem avail: 76.35)
48500 431.11634731292725 112.50 q/s (% mem usage: 23.60, % mem avail: 76.35)
49000 434.2704048156738 112.83 q/s (% mem usage: 23.60, % mem avail: 76.35)
49500 437.15140891075134 113.23 q/s (% mem usage: 23.60, % mem avail: 76.35)
50000 439.8702337741852 113.67 q/s (% mem usage: 23.60, % mem avail: 76.35)
50500 442.7437286376953 114.06 q/s (% mem usage: 23.60, % mem avail: 76.35)
51000 445.6787106990814 114.43 q/s (% mem usage: 23.60, % mem avail: 76.35)
51500 448.7124147415161 114.77 q/s (% mem usage: 23.60, % mem avail: 76.35)
52000 451.52731466293335 115.16 q/s (% mem usage: 23.60, % mem avail: 76.35)
52500 453.93854808807373 115.65 q/s (% mem usage: 23.60, % mem avail: 76.35)
53000 456.9865765571594 115.98 q/s (% mem usage: 23.60, % mem avail: 76.35)
53500 459.6578743457794 116.39 q/s (% mem usage: 23.60, % mem avail: 76.35)
54000 462.60339546203613 116.73 q/s (% mem usage: 23.60, % mem avail: 76.35)
54500 465.36379885673523 117.11 q/s (% mem usage: 23.60, % mem avail: 76.35)
55000 468.23711919784546 117.46 q/s (% mem usage: 23.60, % mem avail: 76.35)
55500 471.3007781505585 117.76 q/s (% mem usage: 23.60, % mem avail: 76.35)
56000 473.93975949287415 118.16 q/s (% mem usage: 23.60, % mem avail: 76.35)
56500 476.5589656829834 118.56 q/s (% mem usage: 23.60, % mem avail: 76.35)
57000 479.17148447036743 118.96 q/s (% mem usage: 23.60, % mem avail: 76.35)
57500 481.95104789733887 119.31 q/s (% mem usage: 23.60, % mem avail: 76.35)
58000 484.90037870407104 119.61 q/s (% mem usage: 23.60, % mem avail: 76.35)
58500 487.6586048603058 119.96 q/s (% mem usage: 23.60, % mem avail: 76.35)
59000 490.5797452926636 120.27 q/s (% mem usage: 23.60, % mem avail: 76.35)
59500 493.3805613517761 120.60 q/s (% mem usage: 23.60, % mem avail: 76.35)
60000 496.2588291168213 120.90 q/s (% mem usage: 23.60, % mem avail: 76.35)
60500 499.05701756477356 121.23 q/s (% mem usage: 23.60, % mem avail: 76.35)
61000 502.00429916381836 121.51 q/s (% mem usage: 23.60, % mem avail: 76.35)
61500 504.8417649269104 121.82 q/s (% mem usage: 23.60, % mem avail: 76.35)
62000 507.5491306781769 122.16 q/s (% mem usage: 23.60, % mem avail: 76.35)
62500 510.37620997428894 122.46 q/s (% mem usage: 23.60, % mem avail: 76.35)
63000 513.205774307251 122.76 q/s (% mem usage: 23.60, % mem avail: 76.35)
63500 516.1144351959229 123.03 q/s (% mem usage: 23.60, % mem avail: 76.35)
64000 518.9513020515442 123.33 q/s (% mem usage: 23.60, % mem avail: 76.35)
64500 521.7587997913361 123.62 q/s (% mem usage: 23.60, % mem avail: 76.35)
65000 524.6801526546478 123.88 q/s (% mem usage: 23.60, % mem avail: 76.35)
65500 527.4111866950989 124.19 q/s (% mem usage: 23.60, % mem avail: 76.35)
66000 530.128401517868 124.50 q/s (% mem usage: 23.60, % mem avail: 76.35)
66500 532.986962556839 124.77 q/s (% mem usage: 23.60, % mem avail: 76.35)
67000 535.9128949642181 125.02 q/s (% mem usage: 23.60, % mem avail: 76.35)
67500 538.8315668106079 125.27 q/s (% mem usage: 23.60, % mem avail: 76.35)
68000 541.6339917182922 125.55 q/s (% mem usage: 23.60, % mem avail: 76.35)
68500 544.3546242713928 125.84 q/s (% mem usage: 23.60, % mem avail: 76.35)
69000 547.4094622135162 126.05 q/s (% mem usage: 23.60, % mem avail: 76.35)
69500 550.1837570667267 126.32 q/s (% mem usage: 23.60, % mem avail: 76.35)
70000 553.0795042514801 126.56 q/s (% mem usage: 23.60, % mem avail: 76.35)
70500 555.6276390552521 126.88 q/s (% mem usage: 23.60, % mem avail: 76.35)
71000 558.3727369308472 127.16 q/s (% mem usage: 23.60, % mem avail: 76.35)
71500 561.2257022857666 127.40 q/s (% mem usage: 23.60, % mem avail: 76.35)
72000 564.1026694774628 127.64 q/s (% mem usage: 23.60, % mem avail: 76.35)
72500 567.1686413288116 127.83 q/s (% mem usage: 23.60, % mem avail: 76.35)
73000 569.948851108551 128.08 q/s (% mem usage: 23.60, % mem avail: 76.35)
73500 573.0456228256226 128.26 q/s (% mem usage: 23.60, % mem avail: 76.35)
74000 575.8768405914307 128.50 q/s (% mem usage: 23.60, % mem avail: 76.35)
74500 578.7836937904358 128.72 q/s (% mem usage: 23.60, % mem avail: 76.35)
75000 581.7461953163147 128.92 q/s (% mem usage: 23.60, % mem avail: 76.35)
75500 584.5869390964508 129.15 q/s (% mem usage: 23.60, % mem avail: 76.35)
76000 587.6222901344299 129.33 q/s (% mem usage: 23.60, % mem avail: 76.35)
76500 590.3485517501831 129.58 q/s (% mem usage: 23.60, % mem avail: 76.35)
77000 593.0591900348663 129.84 q/s (% mem usage: 23.60, % mem avail: 76.35)
77500 595.6887881755829 130.10 q/s (% mem usage: 23.60, % mem avail: 76.35)
78000 598.3855998516083 130.35 q/s (% mem usage: 23.60, % mem avail: 76.35)
78500 601.0244400501251 130.61 q/s (% mem usage: 23.60, % mem avail: 76.35)
79000 603.8869957923889 130.82 q/s (% mem usage: 23.60, % mem avail: 76.35)
79500 606.9082169532776 130.99 q/s (% mem usage: 23.60, % mem avail: 76.35)
80000 609.6879377365112 131.21 q/s (% mem usage: 23.60, % mem avail: 76.35)
80500 612.6350381374359 131.40 q/s (% mem usage: 23.60, % mem avail: 76.35)
81000 615.506742477417 131.60 q/s (% mem usage: 23.60, % mem avail: 76.35)
81500 618.4866013526917 131.77 q/s (% mem usage: 23.60, % mem avail: 76.35)
82000 621.461097240448 131.95 q/s (% mem usage: 23.60, % mem avail: 76.35)
82500 624.3614819049835 132.13 q/s (% mem usage: 23.60, % mem avail: 76.35)
83000 627.2613642215729 132.32 q/s (% mem usage: 23.60, % mem avail: 76.35)
83500 629.8490467071533 132.57 q/s (% mem usage: 23.60, % mem avail: 76.35)
84000 632.6211535930634 132.78 q/s (% mem usage: 23.60, % mem avail: 76.35)
84500 635.584878206253 132.95 q/s (% mem usage: 23.60, % mem avail: 76.35)
85000 638.665424823761 133.09 q/s (% mem usage: 23.60, % mem avail: 76.35)
85500 641.3781852722168 133.31 q/s (% mem usage: 23.60, % mem avail: 76.35)
86000 644.2060890197754 133.50 q/s (% mem usage: 23.60, % mem avail: 76.35)
86500 647.0047807693481 133.69 q/s (% mem usage: 23.60, % mem avail: 76.35)
87000 649.981458902359 133.85 q/s (% mem usage: 23.60, % mem avail: 76.35)
87500 652.6765530109406 134.06 q/s (% mem usage: 23.60, % mem avail: 76.35)
88000 655.5245258808136 134.24 q/s (% mem usage: 23.60, % mem avail: 76.35)
88500 658.6426723003387 134.37 q/s (% mem usage: 23.60, % mem avail: 76.35)
89000 661.2195637226105 134.60 q/s (% mem usage: 23.60, % mem avail: 76.35)
89500 663.822526216507 134.83 q/s (% mem usage: 23.60, % mem avail: 76.35)
90000 666.5150830745697 135.03 q/s (% mem usage: 23.60, % mem avail: 76.35)
90500 669.3218460083008 135.21 q/s (% mem usage: 23.60, % mem avail: 76.35)
91000 672.2571642398834 135.36 q/s (% mem usage: 23.60, % mem avail: 76.35)
91500 675.198935508728 135.52 q/s (% mem usage: 23.60, % mem avail: 76.35)
92000 678.1157279014587 135.67 q/s (% mem usage: 23.60, % mem avail: 76.35)
92500 681.0695154666901 135.82 q/s (% mem usage: 23.60, % mem avail: 76.35)
93000 683.9703538417816 135.97 q/s (% mem usage: 23.60, % mem avail: 76.35)
93500 686.8492529392242 136.13 q/s (% mem usage: 23.60, % mem avail: 76.35)
94000 689.5956115722656 136.31 q/s (% mem usage: 23.60, % mem avail: 76.35)
94500 692.3153722286224 136.50 q/s (% mem usage: 23.60, % mem avail: 76.35)
95000 695.1451799869537 136.66 q/s (% mem usage: 23.60, % mem avail: 76.35)
95500 698.0369601249695 136.81 q/s (% mem usage: 23.60, % mem avail: 76.35)
96000 700.8123059272766 136.98 q/s (% mem usage: 23.60, % mem avail: 76.35)
96500 703.7903764247894 137.11 q/s (% mem usage: 23.60, % mem avail: 76.35)
97000 706.7406053543091 137.25 q/s (% mem usage: 23.60, % mem avail: 76.35)
97500 709.5223755836487 137.42 q/s (% mem usage: 23.60, % mem avail: 76.35)
98000 712.4222040176392 137.56 q/s (% mem usage: 23.60, % mem avail: 76.35)
98500 715.1901988983154 137.73 q/s (% mem usage: 23.60, % mem avail: 76.35)
99000 718.3232252597809 137.82 q/s (% mem usage: 23.60, % mem avail: 76.35)
99500 721.435736656189 137.92 q/s (% mem usage: 23.60, % mem avail: 76.35)
100000 724.4191339015961 138.04 q/s (% mem usage: 23.60, % mem avail: 76.35)
100500 727.4347925186157 138.16 q/s (% mem usage: 23.60, % mem avail: 76.35)
101000 730.4019751548767 138.28 q/s (% mem usage: 23.60, % mem avail: 76.35)
101500 733.475460767746 138.38 q/s (% mem usage: 23.60, % mem avail: 76.35)
102000 736.3855888843536 138.51 q/s (% mem usage: 23.60, % mem avail: 76.35)
102500 739.274427652359 138.65 q/s (% mem usage: 23.60, % mem avail: 76.35)
103000 742.2515308856964 138.77 q/s (% mem usage: 23.60, % mem avail: 76.35)
103500 745.1065104007721 138.91 q/s (% mem usage: 23.60, % mem avail: 76.35)
104000 748.1418242454529 139.01 q/s (% mem usage: 23.60, % mem avail: 76.35)
104500 750.9855237007141 139.15 q/s (% mem usage: 23.60, % mem avail: 76.35)
104993 763.8390402793884 137.45 q/s (% mem usage: 23.60, % mem avail: 76.42)
#  emapper-2.1.6
# emapper.py  -i /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa -o annots --output_dir /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ --cpu 16 --itype proteins --block_size 4 --index_chunks 2 --data_dir /mnt/EFS/dbs/wgsa2/eggnog_data --override --temp_dir /nephele_data/tmp/ --scratch_dir /nephele_data/tmp/ --dbmem
[1;33m  /usr/local/lib/python3.7/dist-packages/eggnogmapper/bin/diamond blastp -d /mnt/EFS/dbs/wgsa2/eggnog_data/eggnog_proteins.dmnd -q /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa --threads 16 -o /nephele_data/tmp/annots.emapper.hits  --sensitive --iterate -e 0.001 --block-size 4.0 -c 2 --top 3  --outfmt 6 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore qcovhsp scovhsp[0m
Loading source DB...
[31mWarning: this can take a few minutes and load up to 45GB to RAM. Using --dbmem is recommended to annotate a large number of sequences.[0m
 Copying result file /nephele_data/tmp/annots.emapper.hits from scratch to /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations
 Copying result file /nephele_data/tmp/annots.emapper.seed_orthologs from scratch to /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations
 Copying result file /nephele_data/tmp/annots.emapper.annotations from scratch to /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations
[31mData in /nephele_data/tmp will be not removed. Please, clear it manually.[0m
[32mDone[0m
   /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.hits
   /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.seed_orthologs
   /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.annotations

================================================================================
CITATION:
If you use this software, please cite:

[1] eggNOG-mapper v2: functional annotation, orthology assignments, and domain 
      prediction at the metagenomic scale. Carlos P. Cantalapiedra, 
      Ana Hernandez-Plaza, Ivica Letunic, Peer Bork, Jaime Huerta-Cepas. 2021.
      Molecular Biology and Evolution, msab293, https://doi.org/10.1093/molbev/msab293

[2] eggNOG 5.0: a hierarchical, functionally and phylogenetically annotated
      orthology resource based on 5090 organisms and 2502 viruses. Jaime
      Huerta-Cepas, Damian Szklarczyk, Davide Heller, Ana Hernandez-Plaza,
      Sofia K Forslund, Helen Cook, Daniel R Mende, Ivica Letunic, Thomas
      Rattei, Lars J Jensen, Christian von Mering and Peer Bork. Nucleic Acids
      Research, Volume 47, Issue D1, 8 January 2019, Pages D309-D314,
      https://doi.org/10.1093/nar/gky1085 

[3] Sensitive protein alignments at tree-of-life scale using DIAMOND.
       Buchfink B, Reuter K, Drost HG. 2021.
       Nature Methods 18, 366–368 (2021). https://doi.org/10.1038/s41592-021-01101-x

e.g. Functional annotation was performed using emapper-2.1.6 [1]
 based on eggNOG orthology data [2]. Sequence searches were performed using [3].


================================================================================

Total hits processed: 104993
Total time: 1220 secs
FINISHED
[Tue Oct 24 18:13:54 2023]
Finished job 68.
114 of 139 steps (82%) done

[Tue Oct 24 18:13:54 2023]
rule gene_annotation:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.hits, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.seed_orthologs, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.annotations
    jobid: 61
    wildcards: sample=S6
    threads: 16
    resources: mem_gb=186

emapper.py -i /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa -o annots --output_dir /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ --cpu 16 --itype proteins --block_size 4 --index_chunks 2 --data_dir /mnt/EFS/dbs/wgsa2/eggnog_data --override --temp_dir /nephele_data/tmp/  --scratch_dir /nephele_data/tmp/ --dbmem

[Tue Oct 24 18:13:54 2023]
rule gene_annotation_grep:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.annotations
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.COG.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.KEGGmap.txt
    jobid: 67
    wildcards: sample=S28


        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.annotations | cut -f 1,11 | sed -e 's/\t-//g' | grep -e $'\t' | awk '{n=split($2,s,",");for (i=1;i<=n;i++) {$2=s[i];print}}' | sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.txt || true
        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.annotations | cut -f 1,5 > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.COG.txt || true
        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.annotations | cut -f1,12 | grep "ko:" | sed 's/ko://g' | awk '{n=split($2,s,",");for (i=1;i<=n;i++) {$2=s[i];print}}' | sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.txt || true
        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.emapper.annotations | cut -f1,13 | grep "ko" | sed 's/,map.*//g' | sed 's/ko/map/g' | awk '{n=split($2,s,",");for (i=1;i<=n;i++) {$2=s[i];print}}' | sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.KEGGmap.txt || true
        
[Tue Oct 24 18:13:55 2023]
Finished job 67.
115 of 139 steps (83%) done

[Tue Oct 24 18:13:55 2023]
rule gene_annot_iTPMs:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_ABUNtab.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt
    jobid: 86
    wildcards: sample=S28


        awk -v OFS="\t" 'NR==FNR { id[$1]=$0; next } ($1 in id){ print $2, id[$1]}'  /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_ABUNtab.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.txt | sed '1s/^/#KO\tnodeID\tlen\treads\tcov\tiRPK\tiTPM\n/' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt
        awk -v OFS="\t" 'NR==FNR { id[$1]=$0; next } ($1 in id){ print $2, id[$1]}'  /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_ABUNtab.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.txt | sed '1s/^/#KO\tnodeID\tlen\treads\tcov\tiRPK\tiTPM\n/' > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt        
        

[Tue Oct 24 18:13:55 2023]
rule gene_annot_seqExtract:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.fna, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.faa, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.fna, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.faa, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.fna
    jobid: 80
    wildcards: sample=S28


        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.txt > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.faa
        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.fna /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.txt > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.fna
        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.faa /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.txt > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.faa
        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes.fna /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.txt > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.fna
        

[Tue Oct 24 18:13:55 2023]
rule copy_annotation_file:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_ABUNtab.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_TPM.txt
    jobid: 66
    wildcards: sample=S28

[Tue Oct 24 18:13:55 2023]
Finished job 86.
116 of 139 steps (83%) done

[Tue Oct 24 18:13:55 2023]
rule gene_annot_geneTPMs:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/tmp_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/S28_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/tmp_geneTPMtab.ec.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/S28_geneTPMtab.ec.txt
    jobid: 85
    wildcards: sample=S28


        cut -f1,6 /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt | sed $'s/#KO.*//g' | awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/calc_geneTPM.awk > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/tmp_geneTPMtab.ko.txt
        awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/join2files_f2.awk /usr/local/src/nephele2/pipelines/wgsa/KO_list.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/tmp_geneTPMtab.ko.txt |         sed '1s/^/#KO\tgeneTPM\tgeneNAME\n/'> /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/S28_geneTPMtab.ko.txt

        cut -f1,6 /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt | sed $'s/#EC.*//g' | awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/calc_geneTPM.awk > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/tmp_geneTPMtab.ec.txt
        awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/join2files_f2.awk /usr/local/src/nephele2/pipelines/wgsa/EC_list.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/tmp_geneTPMtab.ec.txt |         sed '1s/^/#EC\tgeneTPM\tgeneNAME\n/'> /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/S28_geneTPMtab.ec.txt
        
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/tmp_geneTPMtab.ko.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/tmp_geneTPMtab.ec.txt.
[Tue Oct 24 18:13:55 2023]
Finished job 85.
117 of 139 steps (84%) done
[Tue Oct 24 18:13:55 2023]
Finished job 80.
118 of 139 steps (85%) done
[33mJob counts:
	count	jobs
	1	copy_annotation_file
	1[0m
[33mcp /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt && cut -f 1,5 /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_ABUNtab.txt > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_TPM.txt[0m
[Tue Oct 24 18:13:56 2023]
Finished job 66.
119 of 139 steps (86%) done

[Tue Oct 24 18:13:56 2023]
rule run_min_path:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_report.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.details.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.minpath.log.txt
    jobid: 71
    wildcards: sample=S28


        if [ -s /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt ]; then
            python3 /usr/local/src/MinPath/MinPath.py -any /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt -map /mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-ko2map-092022.txt -report /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_report.txt -details /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.details.txt >> /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.minpath.log.txt
        else
            echo "The input file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt is empty, so run_min_path will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_report.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.details.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.minpath.log.txt
        fi
        
[Tue Oct 24 18:14:12 2023]
Finished job 71.
120 of 139 steps (86%) done

[Tue Oct 24 18:14:12 2023]
rule create_pathways_report:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_report.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.report.txt
    jobid: 70
    wildcards: sample=S28


        if [ -s /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_report.txt ]; then
            grep 'minpath\ 1' /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_report.txt > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.report.txt
        else
            echo "The input file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_report.txt is empty, so create_pathways_report will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.report.txt
        fi
        
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_report.txt.
[Tue Oct 24 18:14:13 2023]
Finished job 70.
121 of 139 steps (87%) done

[Tue Oct 24 18:14:13 2023]
rule run_genes2krona:
    input: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_TPM.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.report.txt
    output: /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_4kr.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/S28_4krona.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S28_4krona.txt
    jobid: 65
    wildcards: sample=S28


        if [ -s /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt -a -s /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_TPM.txt -a -s /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.report.txt ]; then
            python3 /usr/local/src/nephele2/pipelines/wgsa/genes2KronaTable.py -i /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt            -m /mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-ko2map-092022.txt -H /mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-HRCHY-092022.txt -n S28 -c /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_TPM.txt            -l /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/ko2gg.report.txt -o /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_4kr.txt &&            sed '1s/^/#/' /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_4kr.txt > /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/S28_4krona.txt &&            cp /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/S28_4krona.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S28_4krona.txt
        else
            echo "One of the input file is empty, so run_genes2krona will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_4kr.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/S28_4krona.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S28_4krona.txt
        fi
        
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_TPM.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_annots.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/tmp_4kr.txt.
[Tue Oct 24 18:14:13 2023]
Finished job 65.
122 of 139 steps (88%) done

[Tue Oct 24 18:14:13 2023]
rule pwy_biom_per_sample:
    input: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S28_4krona.txt
    output: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_4biom.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_json.biom
    jobid: 74
    wildcards: sample=S28


        if [ -s /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S28_4krona.txt ]; then
            sed 's/\t/;/g' /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S28_4krona.txt | sed 's/;/\t/1' | nl -n ln |sed '1s/^/\t/' | sed '1s/1\s\+\t#/\t/' | sed 's/\s\+\t/\t/g' | sed '1s/LINEAGE/Taxonomy/' | sed -e '1s/Level.*/Taxonomy/' > /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_4biom.txt
            biom convert -i /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_4biom.txt -o /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_json.biom --to-json --table-type='Pathway table' --process-obs-metadata taxonomy || touch /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_json.biom
        else
            echo "The input file /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S28_4krona.txt is empty, so pwy_biom_per_sample will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_4biom.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_json.biom
        fi
        
Removing temporary output file /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_4biom.txt.
[Tue Oct 24 18:14:14 2023]
Finished job 74.
123 of 139 steps (88%) done
[1;32mFunctional annotation of hits...[0m
0 2.384185791015625e-06 0.00 q/s (% mem usage: 1.50, % mem avail: 98.53)
[1;34mTime to load the DB into memory: 166.73057198524475[0m
500 170.82879376411438 2.93 q/s (% mem usage: 23.60, % mem avail: 76.35)
1000 173.6503610610962 5.76 q/s (% mem usage: 23.60, % mem avail: 76.35)
1500 175.99221444129944 8.52 q/s (% mem usage: 23.60, % mem avail: 76.35)
2000 180.03976798057556 11.11 q/s (% mem usage: 23.70, % mem avail: 76.35)
2500 182.9340455532074 13.67 q/s (% mem usage: 23.70, % mem avail: 76.35)
3000 185.83845686912537 16.14 q/s (% mem usage: 23.70, % mem avail: 76.35)
3500 188.54016995429993 18.56 q/s (% mem usage: 23.60, % mem avail: 76.35)
4000 190.57526874542236 20.99 q/s (% mem usage: 23.60, % mem avail: 76.35)
4500 191.63558506965637 23.48 q/s (% mem usage: 23.60, % mem avail: 76.35)
5000 192.33693981170654 26.00 q/s (% mem usage: 23.60, % mem avail: 76.35)
5500 193.0147421360016 28.50 q/s (% mem usage: 23.60, % mem avail: 76.35)
6000 193.72482061386108 30.97 q/s (% mem usage: 23.60, % mem avail: 76.35)
6500 194.42007660865784 33.43 q/s (% mem usage: 23.60, % mem avail: 76.35)
7000 195.06640481948853 35.89 q/s (% mem usage: 23.70, % mem avail: 76.35)
7500 195.9385483264923 38.28 q/s (% mem usage: 23.60, % mem avail: 76.35)
8000 196.87396502494812 40.64 q/s (% mem usage: 23.60, % mem avail: 76.35)
8500 197.9108111858368 42.95 q/s (% mem usage: 23.60, % mem avail: 76.35)
9000 199.07359766960144 45.21 q/s (% mem usage: 23.60, % mem avail: 76.35)
9500 200.52988266944885 47.37 q/s (% mem usage: 23.60, % mem avail: 76.35)
10000 201.87523579597473 49.54 q/s (% mem usage: 23.60, % mem avail: 76.35)
10500 203.08403277397156 51.70 q/s (% mem usage: 23.60, % mem avail: 76.35)
11000 204.58385372161865 53.77 q/s (% mem usage: 23.60, % mem avail: 76.35)
11500 206.02298998832703 55.82 q/s (% mem usage: 23.60, % mem avail: 76.35)
12000 207.43256497383118 57.85 q/s (% mem usage: 23.60, % mem avail: 76.35)
12500 208.98277640342712 59.81 q/s (% mem usage: 23.60, % mem avail: 76.35)
13000 210.37264490127563 61.80 q/s (% mem usage: 23.60, % mem avail: 76.35)
13500 211.96066117286682 63.69 q/s (% mem usage: 23.60, % mem avail: 76.35)
14000 213.6080482006073 65.54 q/s (% mem usage: 23.60, % mem avail: 76.35)
14500 215.26175546646118 67.36 q/s (% mem usage: 23.60, % mem avail: 76.35)
15000 217.02864050865173 69.12 q/s (% mem usage: 23.70, % mem avail: 76.35)
15500 218.51097559928894 70.93 q/s (% mem usage: 23.70, % mem avail: 76.35)
16000 220.26199054718018 72.64 q/s (% mem usage: 23.70, % mem avail: 76.35)
16500 221.93243670463562 74.35 q/s (% mem usage: 23.70, % mem avail: 76.35)
17000 223.7249710559845 75.99 q/s (% mem usage: 23.70, % mem avail: 76.35)
17500 225.48823761940002 77.61 q/s (% mem usage: 23.70, % mem avail: 76.35)
18000 227.2614004611969 79.20 q/s (% mem usage: 23.70, % mem avail: 76.35)
18500 228.943687915802 80.81 q/s (% mem usage: 23.70, % mem avail: 76.35)
19000 230.57189321517944 82.40 q/s (% mem usage: 23.70, % mem avail: 76.35)
19500 232.23207712173462 83.97 q/s (% mem usage: 23.60, % mem avail: 76.35)
20000 234.06942105293274 85.44 q/s (% mem usage: 23.60, % mem avail: 76.35)
20500 235.90365362167358 86.90 q/s (% mem usage: 23.70, % mem avail: 76.35)
21000 237.8718752861023 88.28 q/s (% mem usage: 23.70, % mem avail: 76.35)
21500 239.70448851585388 89.69 q/s (% mem usage: 23.70, % mem avail: 76.35)
22000 241.74703550338745 91.00 q/s (% mem usage: 23.70, % mem avail: 76.35)
22500 243.4342873096466 92.43 q/s (% mem usage: 23.70, % mem avail: 76.35)
23000 244.98410654067993 93.88 q/s (% mem usage: 23.70, % mem avail: 76.35)
23500 246.82014155387878 95.21 q/s (% mem usage: 23.60, % mem avail: 76.35)
24000 248.5118908882141 96.57 q/s (% mem usage: 23.60, % mem avail: 76.35)
24500 250.36983251571655 97.86 q/s (% mem usage: 23.60, % mem avail: 76.35)
25000 252.2245705127716 99.12 q/s (% mem usage: 23.60, % mem avail: 76.35)
25500 254.16021537780762 100.33 q/s (% mem usage: 23.60, % mem avail: 76.35)
26000 256.07371950149536 101.53 q/s (% mem usage: 23.60, % mem avail: 76.35)
26500 257.9817066192627 102.72 q/s (% mem usage: 23.60, % mem avail: 76.35)
27000 259.88191986083984 103.89 q/s (% mem usage: 23.60, % mem avail: 76.35)
27500 261.8604805469513 105.02 q/s (% mem usage: 23.70, % mem avail: 76.35)
28000 263.95644640922546 106.08 q/s (% mem usage: 23.70, % mem avail: 76.35)
28500 265.7637960910797 107.24 q/s (% mem usage: 23.60, % mem avail: 76.35)
29000 267.66945481300354 108.34 q/s (% mem usage: 23.60, % mem avail: 76.35)
29500 269.70844650268555 109.38 q/s (% mem usage: 23.60, % mem avail: 76.35)
30000 271.4608597755432 110.51 q/s (% mem usage: 23.60, % mem avail: 76.35)
30500 273.250590801239 111.62 q/s (% mem usage: 23.70, % mem avail: 76.35)
31000 275.1913022994995 112.65 q/s (% mem usage: 23.60, % mem avail: 76.35)
31500 277.32489252090454 113.59 q/s (% mem usage: 23.60, % mem avail: 76.35)
32000 279.23447847366333 114.60 q/s (% mem usage: 23.70, % mem avail: 76.35)
32500 281.0450654029846 115.64 q/s (% mem usage: 23.70, % mem avail: 76.35)
33000 283.0047688484192 116.61 q/s (% mem usage: 23.70, % mem avail: 76.35)
33500 284.898779630661 117.59 q/s (% mem usage: 23.70, % mem avail: 76.35)
34000 286.65861415863037 118.61 q/s (% mem usage: 23.70, % mem avail: 76.35)
34500 288.7101275920868 119.50 q/s (% mem usage: 23.60, % mem avail: 76.35)
35000 290.86158776283264 120.33 q/s (% mem usage: 23.70, % mem avail: 76.35)
35500 292.74253582954407 121.27 q/s (% mem usage: 23.70, % mem avail: 76.35)
36000 294.6224980354309 122.19 q/s (% mem usage: 23.70, % mem avail: 76.35)
36500 296.3882749080658 123.15 q/s (% mem usage: 23.70, % mem avail: 76.35)
37000 298.41464853286743 123.99 q/s (% mem usage: 23.70, % mem avail: 76.35)
37500 300.32427287101746 124.87 q/s (% mem usage: 23.70, % mem avail: 76.35)
38000 302.5259931087494 125.61 q/s (% mem usage: 23.70, % mem avail: 76.35)
38500 304.6585943698883 126.37 q/s (% mem usage: 23.70, % mem avail: 76.35)
39000 306.6879258155823 127.17 q/s (% mem usage: 23.70, % mem avail: 76.35)
39500 308.5785119533539 128.01 q/s (% mem usage: 23.70, % mem avail: 76.35)
40000 310.4489426612854 128.85 q/s (% mem usage: 23.70, % mem avail: 76.35)
40500 312.11329984664917 129.76 q/s (% mem usage: 23.60, % mem avail: 76.35)
41000 314.1037018299103 130.53 q/s (% mem usage: 23.60, % mem avail: 76.35)
41500 316.1083552837372 131.28 q/s (% mem usage: 23.60, % mem avail: 76.35)
42000 318.0936498641968 132.04 q/s (% mem usage: 23.60, % mem avail: 76.35)
42500 319.9314045906067 132.84 q/s (% mem usage: 23.60, % mem avail: 76.35)
43000 322.0521819591522 133.52 q/s (% mem usage: 23.70, % mem avail: 76.35)
43500 323.802209854126 134.34 q/s (% mem usage: 23.70, % mem avail: 76.35)
44000 325.6413559913635 135.12 q/s (% mem usage: 23.70, % mem avail: 76.35)
44500 327.773234128952 135.76 q/s (% mem usage: 23.60, % mem avail: 76.35)
45000 329.4606444835663 136.59 q/s (% mem usage: 23.60, % mem avail: 76.35)
45500 331.4008057117462 137.30 q/s (% mem usage: 23.60, % mem avail: 76.35)
46000 333.2293601036072 138.04 q/s (% mem usage: 23.70, % mem avail: 76.35)
46500 334.91753220558167 138.84 q/s (% mem usage: 23.70, % mem avail: 76.35)
47000 336.94015550613403 139.49 q/s (% mem usage: 23.70, % mem avail: 76.35)
47500 339.00908398628235 140.11 q/s (% mem usage: 23.60, % mem avail: 76.35)
48000 341.0203869342804 140.75 q/s (% mem usage: 23.70, % mem avail: 76.35)
48500 343.0044300556183 141.40 q/s (% mem usage: 23.70, % mem avail: 76.34)
49000 344.8902726173401 142.07 q/s (% mem usage: 23.70, % mem avail: 76.33)
49500 346.5538868904114 142.83 q/s (% mem usage: 23.70, % mem avail: 76.34)
50000 348.6679515838623 143.40 q/s (% mem usage: 23.70, % mem avail: 76.33)
50500 350.74323415756226 143.98 q/s (% mem usage: 23.70, % mem avail: 76.35)
51000 352.51025342941284 144.68 q/s (% mem usage: 23.70, % mem avail: 76.35)
51500 354.4112479686737 145.31 q/s (% mem usage: 23.70, % mem avail: 76.35)
52000 356.49310398101807 145.87 q/s (% mem usage: 23.70, % mem avail: 76.35)
52500 358.4652352333069 146.46 q/s (% mem usage: 23.70, % mem avail: 76.35)
53000 360.42721605300903 147.05 q/s (% mem usage: 23.70, % mem avail: 76.35)
53500 362.4349706172943 147.61 q/s (% mem usage: 23.70, % mem avail: 76.35)
54000 364.52592945098877 148.14 q/s (% mem usage: 23.70, % mem avail: 76.35)
54500 366.57083678245544 148.68 q/s (% mem usage: 23.70, % mem avail: 76.35)
55000 368.9590027332306 149.07 q/s (% mem usage: 23.70, % mem avail: 76.35)
55500 370.99371695518494 149.60 q/s (% mem usage: 23.70, % mem avail: 76.35)
56000 373.2343978881836 150.04 q/s (% mem usage: 23.70, % mem avail: 76.35)
56500 375.19142150878906 150.59 q/s (% mem usage: 23.70, % mem avail: 76.35)
57000 377.1438400745392 151.14 q/s (% mem usage: 23.70, % mem avail: 76.35)
57500 379.1677074432373 151.65 q/s (% mem usage: 23.70, % mem avail: 76.35)
58000 381.2065703868866 152.15 q/s (% mem usage: 23.70, % mem avail: 76.35)
58500 383.6194407939911 152.49 q/s (% mem usage: 23.70, % mem avail: 76.35)
59000 385.6650068759918 152.98 q/s (% mem usage: 23.70, % mem avail: 76.35)
59500 387.7894685268402 153.43 q/s (% mem usage: 23.70, % mem avail: 76.35)
60000 389.98496317863464 153.85 q/s (% mem usage: 23.70, % mem avail: 76.35)
60500 392.0607087612152 154.31 q/s (% mem usage: 23.70, % mem avail: 76.35)
61000 394.38746976852417 154.67 q/s (% mem usage: 23.70, % mem avail: 76.35)
61500 396.6059811115265 155.07 q/s (% mem usage: 23.70, % mem avail: 76.35)
62000 398.62588381767273 155.53 q/s (% mem usage: 23.70, % mem avail: 76.35)
62500 400.72256302833557 155.97 q/s (% mem usage: 23.70, % mem avail: 76.35)
63000 402.89337182044983 156.37 q/s (% mem usage: 23.70, % mem avail: 76.35)
63500 404.93322348594666 156.82 q/s (% mem usage: 23.70, % mem avail: 76.35)
64000 407.1160101890564 157.20 q/s (% mem usage: 23.70, % mem avail: 76.35)
64500 409.15628933906555 157.64 q/s (% mem usage: 23.70, % mem avail: 76.35)
65000 411.2259130477905 158.06 q/s (% mem usage: 23.70, % mem avail: 76.35)
65500 413.31766414642334 158.47 q/s (% mem usage: 23.70, % mem avail: 76.35)
66000 415.57847356796265 158.81 q/s (% mem usage: 23.70, % mem avail: 76.35)
66500 417.7344172000885 159.19 q/s (% mem usage: 23.70, % mem avail: 76.35)
67000 419.9570572376251 159.54 q/s (% mem usage: 23.70, % mem avail: 76.35)
67500 421.84930181503296 160.01 q/s (% mem usage: 23.70, % mem avail: 76.35)
68000 423.7634358406067 160.47 q/s (% mem usage: 23.70, % mem avail: 76.35)
68500 425.93484926223755 160.82 q/s (% mem usage: 23.70, % mem avail: 76.35)
69000 427.96339416503906 161.23 q/s (% mem usage: 23.70, % mem avail: 76.35)
69500 430.10306572914124 161.59 q/s (% mem usage: 23.70, % mem avail: 76.35)
70000 432.24896454811096 161.94 q/s (% mem usage: 23.70, % mem avail: 76.35)
70500 434.2712049484253 162.34 q/s (% mem usage: 23.70, % mem avail: 76.35)
71000 436.51570534706116 162.65 q/s (% mem usage: 23.70, % mem avail: 76.35)
71500 438.3619644641876 163.11 q/s (% mem usage: 23.70, % mem avail: 76.35)
72000 440.5100688934326 163.45 q/s (% mem usage: 23.70, % mem avail: 76.35)
72500 442.45515179634094 163.86 q/s (% mem usage: 23.70, % mem avail: 76.35)
73000 444.52642369270325 164.22 q/s (% mem usage: 23.70, % mem avail: 76.35)
73500 446.62089228630066 164.57 q/s (% mem usage: 23.70, % mem avail: 76.35)
74000 448.64730501174927 164.94 q/s (% mem usage: 23.70, % mem avail: 76.35)
74500 450.8122854232788 165.26 q/s (% mem usage: 23.70, % mem avail: 76.35)
75000 453.1054344177246 165.52 q/s (% mem usage: 23.70, % mem avail: 76.35)
75500 455.0693869590759 165.91 q/s (% mem usage: 23.70, % mem avail: 76.35)
76000 457.2601752281189 166.21 q/s (% mem usage: 23.70, % mem avail: 76.35)
76500 459.11645460128784 166.62 q/s (% mem usage: 23.70, % mem avail: 76.35)
77000 461.21840500831604 166.95 q/s (% mem usage: 23.70, % mem avail: 76.35)
77500 463.3381311893463 167.26 q/s (% mem usage: 23.70, % mem avail: 76.35)
78000 465.53946352005005 167.55 q/s (% mem usage: 23.70, % mem avail: 76.35)
78500 467.7108898162842 167.84 q/s (% mem usage: 23.70, % mem avail: 76.35)
79000 469.982351064682 168.09 q/s (% mem usage: 23.70, % mem avail: 76.35)
79500 472.07942962646484 168.40 q/s (% mem usage: 23.70, % mem avail: 76.35)
80000 474.2920410633087 168.67 q/s (% mem usage: 23.70, % mem avail: 76.35)
80500 476.42075514793396 168.97 q/s (% mem usage: 23.70, % mem avail: 76.35)
81000 478.4726424217224 169.29 q/s (% mem usage: 23.70, % mem avail: 76.35)
81500 480.7109303474426 169.54 q/s (% mem usage: 23.70, % mem avail: 76.35)
82000 482.8623571395874 169.82 q/s (% mem usage: 23.70, % mem avail: 76.35)
82500 485.11358094215393 170.06 q/s (% mem usage: 23.70, % mem avail: 76.35)
83000 487.4454593658447 170.28 q/s (% mem usage: 23.70, % mem avail: 76.35)
83500 489.426372051239 170.61 q/s (% mem usage: 23.70, % mem avail: 76.35)
84000 491.4862084388733 170.91 q/s (% mem usage: 23.70, % mem avail: 76.35)
84500 493.4432678222656 171.25 q/s (% mem usage: 23.70, % mem avail: 76.35)
85000 495.44057273864746 171.56 q/s (% mem usage: 23.70, % mem avail: 76.35)
85500 497.4054911136627 171.89 q/s (% mem usage: 23.70, % mem avail: 76.35)
86000 499.6134583950043 172.13 q/s (% mem usage: 23.70, % mem avail: 76.35)
86500 501.78358817100525 172.39 q/s (% mem usage: 23.70, % mem avail: 76.35)
87000 503.7140681743622 172.72 q/s (% mem usage: 23.70, % mem avail: 76.35)
87500 505.6913721561432 173.03 q/s (% mem usage: 23.70, % mem avail: 76.35)
88000 507.5917160511017 173.37 q/s (% mem usage: 23.70, % mem avail: 76.35)
88500 509.5629620552063 173.68 q/s (% mem usage: 23.70, % mem avail: 76.35)
89000 511.61128401756287 173.96 q/s (% mem usage: 23.70, % mem avail: 76.35)
89500 513.974737405777 174.13 q/s (% mem usage: 23.70, % mem avail: 76.35)
90000 516.1453478336334 174.37 q/s (% mem usage: 23.70, % mem avail: 76.35)
90500 518.12384557724 174.67 q/s (% mem usage: 23.70, % mem avail: 76.35)
91000 520.14777302742 174.95 q/s (% mem usage: 23.70, % mem avail: 76.35)
91500 522.0850858688354 175.26 q/s (% mem usage: 23.70, % mem avail: 76.35)
92000 523.844468832016 175.62 q/s (% mem usage: 23.70, % mem avail: 76.35)
92500 525.9508163928986 175.87 q/s (% mem usage: 23.70, % mem avail: 76.35)
93000 528.038355588913 176.12 q/s (% mem usage: 23.70, % mem avail: 76.35)
93500 530.0327746868134 176.40 q/s (% mem usage: 23.70, % mem avail: 76.35)
94000 532.1634526252747 176.64 q/s (% mem usage: 23.70, % mem avail: 76.35)
94500 534.2630124092102 176.88 q/s (% mem usage: 23.70, % mem avail: 76.35)
95000 536.0389337539673 177.23 q/s (% mem usage: 23.70, % mem avail: 76.35)
95500 538.0868198871613 177.48 q/s (% mem usage: 23.70, % mem avail: 76.35)
96000 540.2537884712219 177.69 q/s (% mem usage: 23.70, % mem avail: 76.35)
96500 542.440221786499 177.90 q/s (% mem usage: 23.70, % mem avail: 76.35)
97000 544.4653401374817 178.16 q/s (% mem usage: 23.70, % mem avail: 76.35)
97500 546.4998078346252 178.41 q/s (% mem usage: 23.70, % mem avail: 76.35)
97553 556.6699318885803 175.24 q/s (% mem usage: 23.60, % mem avail: 76.41)
#  emapper-2.1.6
# emapper.py  -i /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa -o annots --output_dir /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ --cpu 16 --itype proteins --block_size 4 --index_chunks 2 --data_dir /mnt/EFS/dbs/wgsa2/eggnog_data --override --temp_dir /nephele_data/tmp/ --scratch_dir /nephele_data/tmp/ --dbmem
[1;33m  /usr/local/lib/python3.7/dist-packages/eggnogmapper/bin/diamond blastp -d /mnt/EFS/dbs/wgsa2/eggnog_data/eggnog_proteins.dmnd -q /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa --threads 16 -o /nephele_data/tmp/annots.emapper.hits  --sensitive --iterate -e 0.001 --block-size 4.0 -c 2 --top 3  --outfmt 6 qseqid sseqid pident length mismatch gapopen qstart qend sstart send evalue bitscore qcovhsp scovhsp[0m
Loading source DB...
[31mWarning: this can take a few minutes and load up to 45GB to RAM. Using --dbmem is recommended to annotate a large number of sequences.[0m
 Copying result file /nephele_data/tmp/annots.emapper.hits from scratch to /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations
 Copying result file /nephele_data/tmp/annots.emapper.seed_orthologs from scratch to /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations
 Copying result file /nephele_data/tmp/annots.emapper.annotations from scratch to /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations
[31mData in /nephele_data/tmp will be not removed. Please, clear it manually.[0m
[32mDone[0m
   /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.hits
   /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.seed_orthologs
   /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.annotations

================================================================================
CITATION:
If you use this software, please cite:

[1] eggNOG-mapper v2: functional annotation, orthology assignments, and domain 
      prediction at the metagenomic scale. Carlos P. Cantalapiedra, 
      Ana Hernandez-Plaza, Ivica Letunic, Peer Bork, Jaime Huerta-Cepas. 2021.
      Molecular Biology and Evolution, msab293, https://doi.org/10.1093/molbev/msab293

[2] eggNOG 5.0: a hierarchical, functionally and phylogenetically annotated
      orthology resource based on 5090 organisms and 2502 viruses. Jaime
      Huerta-Cepas, Damian Szklarczyk, Davide Heller, Ana Hernandez-Plaza,
      Sofia K Forslund, Helen Cook, Daniel R Mende, Ivica Letunic, Thomas
      Rattei, Lars J Jensen, Christian von Mering and Peer Bork. Nucleic Acids
      Research, Volume 47, Issue D1, 8 January 2019, Pages D309-D314,
      https://doi.org/10.1093/nar/gky1085 

[3] Sensitive protein alignments at tree-of-life scale using DIAMOND.
       Buchfink B, Reuter K, Drost HG. 2021.
       Nature Methods 18, 366–368 (2021). https://doi.org/10.1038/s41592-021-01101-x

e.g. Functional annotation was performed using emapper-2.1.6 [1]
 based on eggNOG orthology data [2]. Sequence searches were performed using [3].


================================================================================

Total hits processed: 97553
Total time: 1002 secs
FINISHED
[Tue Oct 24 18:30:39 2023]
Finished job 61.
124 of 139 steps (89%) done

[Tue Oct 24 18:30:39 2023]
rule gene_annotation_grep:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.annotations
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.COG.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.KEGGmap.txt
    jobid: 60
    wildcards: sample=S6


        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.annotations | cut -f 1,11 | sed -e 's/\t-//g' | grep -e $'\t' | awk '{n=split($2,s,",");for (i=1;i<=n;i++) {$2=s[i];print}}' | sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.txt || true
        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.annotations | cut -f 1,5 > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.COG.txt || true
        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.annotations | cut -f1,12 | grep "ko:" | sed 's/ko://g' | awk '{n=split($2,s,",");for (i=1;i<=n;i++) {$2=s[i];print}}' | sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.txt || true
        grep "NODE_" /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.emapper.annotations | cut -f1,13 | grep "ko" | sed 's/,map.*//g' | sed 's/ko/map/g' | awk '{n=split($2,s,",");for (i=1;i<=n;i++) {$2=s[i];print}}' | sed -e 's/\s/\t/g' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.KEGGmap.txt || true
        
[Tue Oct 24 18:30:39 2023]
Finished job 60.
125 of 139 steps (90%) done

[Tue Oct 24 18:30:39 2023]
rule copy_annotation_file:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_ABUNtab.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_TPM.txt
    jobid: 59
    wildcards: sample=S6

[Tue Oct 24 18:30:39 2023]
rule gene_annot_seqExtract:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.fna, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.faa, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.fna, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.faa, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.fna
    jobid: 79
    wildcards: sample=S6


        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.txt > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.faa
        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.fna /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.txt > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.fna
        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.faa /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.txt > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.faa
        seqtk subseq /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes.fna /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.txt > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.fna
        

[Tue Oct 24 18:30:39 2023]
rule gene_annot_iTPMs:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_ABUNtab.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt
    jobid: 84
    wildcards: sample=S6


        awk -v OFS="\t" 'NR==FNR { id[$1]=$0; next } ($1 in id){ print $2, id[$1]}'  /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_ABUNtab.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.txt | sed '1s/^/#KO\tnodeID\tlen\treads\tcov\tiRPK\tiTPM\n/' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt
        awk -v OFS="\t" 'NR==FNR { id[$1]=$0; next } ($1 in id){ print $2, id[$1]}'  /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_ABUNtab.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.txt | sed '1s/^/#KO\tnodeID\tlen\treads\tcov\tiRPK\tiTPM\n/' > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt        
        
[Tue Oct 24 18:30:40 2023]
Finished job 84.
126 of 139 steps (91%) done

[Tue Oct 24 18:30:40 2023]
rule gene_annot_geneTPMs:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/tmp_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/S6_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/tmp_geneTPMtab.ec.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/S6_geneTPMtab.ec.txt
    jobid: 83
    wildcards: sample=S6


        cut -f1,6 /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ANNOTgenes_ABUNtab.ko.txt | sed $'s/#KO.*//g' | awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/calc_geneTPM.awk > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/tmp_geneTPMtab.ko.txt
        awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/join2files_f2.awk /usr/local/src/nephele2/pipelines/wgsa/KO_list.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/tmp_geneTPMtab.ko.txt |         sed '1s/^/#KO\tgeneTPM\tgeneNAME\n/'> /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/S6_geneTPMtab.ko.txt

        cut -f1,6 /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/ANNOTgenes_ABUNtab.ec.txt | sed $'s/#EC.*//g' | awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/calc_geneTPM.awk > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/tmp_geneTPMtab.ec.txt
        awk -F'\t' -f /usr/local/src/nephele2/pipelines/wgsa/join2files_f2.awk /usr/local/src/nephele2/pipelines/wgsa/EC_list.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/tmp_geneTPMtab.ec.txt |         sed '1s/^/#EC\tgeneTPM\tgeneNAME\n/'> /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/S6_geneTPMtab.ec.txt
        
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/tmp_geneTPMtab.ko.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/tmp_geneTPMtab.ec.txt.
[Tue Oct 24 18:30:40 2023]
Finished job 83.
127 of 139 steps (91%) done

[Tue Oct 24 18:30:40 2023]
rule cp_geneTPM_files:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/S1_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/S6_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/S28_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/S1_geneTPMtab.ec.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/S6_geneTPMtab.ec.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/S28_geneTPMtab.ec.txt
    output: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/genebin/S1_geneTPMtab.ko.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/genebin/S6_geneTPMtab.ko.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/genebin/S28_geneTPMtab.ko.txt
    jobid: 134

[Tue Oct 24 18:30:40 2023]
Finished job 79.
128 of 139 steps (92%) done
[33mJob counts:
	count	jobs
	1	copy_annotation_file
	1[0m
[33mcp /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt && cut -f 1,5 /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_ABUNtab.txt > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_TPM.txt[0m
[Tue Oct 24 18:30:40 2023]
Finished job 59.
129 of 139 steps (93%) done

[Tue Oct 24 18:30:40 2023]
rule run_min_path:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_report.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.details.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.minpath.log.txt
    jobid: 64
    wildcards: sample=S6


        if [ -s /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt ]; then
            python3 /usr/local/src/MinPath/MinPath.py -any /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt -map /mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-ko2map-092022.txt -report /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_report.txt -details /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.details.txt >> /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.minpath.log.txt
        else
            echo "The input file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt is empty, so run_min_path will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_report.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.details.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.minpath.log.txt
        fi
        
[33mJob counts:
	count	jobs
	1	cp_geneTPM_files
	1[0m
[33mcp /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/S1_geneTPMtab.ko.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/S6_geneTPMtab.ko.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/S28_geneTPMtab.ko.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/genebin/[0m
[Tue Oct 24 18:30:41 2023]
Finished job 134.
130 of 139 steps (94%) done
[Tue Oct 24 18:30:57 2023]
Finished job 64.
131 of 139 steps (94%) done

[Tue Oct 24 18:30:57 2023]
rule create_pathways_report:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_report.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.report.txt
    jobid: 63
    wildcards: sample=S6


        if [ -s /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_report.txt ]; then
            grep 'minpath\ 1' /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_report.txt > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.report.txt
        else
            echo "The input file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_report.txt is empty, so create_pathways_report will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.report.txt
        fi
        
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_report.txt.
[Tue Oct 24 18:30:57 2023]
Finished job 63.
132 of 139 steps (95%) done

[Tue Oct 24 18:30:57 2023]
rule run_genes2krona:
    input: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_TPM.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.report.txt
    output: /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_4kr.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/S6_4krona.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S6_4krona.txt
    jobid: 58
    wildcards: sample=S6


        if [ -s /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt -a -s /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_TPM.txt -a -s /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.report.txt ]; then
            python3 /usr/local/src/nephele2/pipelines/wgsa/genes2KronaTable.py -i /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt            -m /mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-ko2map-092022.txt -H /mnt/EFS/dbs/wgsa2/minpath_data/KEGG_myfiles_0922/KEGG-HRCHY-092022.txt -n S6 -c /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_TPM.txt            -l /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/ko2gg.report.txt -o /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_4kr.txt &&            sed '1s/^/#/' /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_4kr.txt > /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/S6_4krona.txt &&            cp /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/S6_4krona.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S6_4krona.txt
        else
            echo "One of the input file is empty, so run_genes2krona will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_4kr.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/S6_4krona.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S6_4krona.txt
        fi
        
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_annots.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_TPM.txt.
Removing temporary output file /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/tmp_4kr.txt.
[Tue Oct 24 18:30:57 2023]
Finished job 58.
133 of 139 steps (96%) done

[Tue Oct 24 18:30:57 2023]
rule pwy_biom_per_sample:
    input: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S6_4krona.txt
    output: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_4biom.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_json.biom
    jobid: 73
    wildcards: sample=S6


        if [ -s /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S6_4krona.txt ]; then
            sed 's/\t/;/g' /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S6_4krona.txt | sed 's/;/\t/1' | nl -n ln |sed '1s/^/\t/' | sed '1s/1\s\+\t#/\t/' | sed 's/\s\+\t/\t/g' | sed '1s/LINEAGE/Taxonomy/' | sed -e '1s/Level.*/Taxonomy/' > /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_4biom.txt
            biom convert -i /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_4biom.txt -o /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_json.biom --to-json --table-type='Pathway table' --process-obs-metadata taxonomy || touch /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_json.biom
        else
            echo "The input file /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S6_4krona.txt is empty, so pwy_biom_per_sample will not run. All output file(s) from this step are empty."
            touch /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_4biom.txt /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_json.biom
        fi
        

[Tue Oct 24 18:30:57 2023]
rule PWY_collation:
    input: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S1_4krona.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S6_4krona.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/S28_4krona.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/genebin/S1_geneTPMtab.ko.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/genebin/S6_geneTPMtab.ko.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/genebin/S28_geneTPMtab.ko.txt
    output: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/SccList.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts+PWY+allTiers.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts+PWY.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_allTiers.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts+allTiers.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_PWY.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_geneTPMtable.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/PWY_collation.log
    jobid: 133

find /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin//*.txt -type f -empty -delete && find /nephele_data/outputs/PWYprofiles/keggPWYs.MP/genebin//*.txt -type f -empty -delete && ls -1 /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/ | xargs basename -a -s _4krona.txt > /nephele_data/outputs/PWYprofiles/keggPWYs.MP/SccList.txt && head /nephele_data/outputs/PWYprofiles/keggPWYs.MP/SccList.txt &&Rscript /usr/local/src/nephele2/pipelines/wgsa/TableMerging_PWY_v4.R --binDIR /nephele_data/outputs/PWYprofiles/keggPWYs.MP/pwybin/ --sccList /nephele_data/outputs/PWYprofiles/keggPWYs.MP/SccList.txt --outdir /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/ --genesDIR /nephele_data/outputs/PWYprofiles/keggPWYs.MP/genebin/ 2>&1 >/nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/PWY_collation.log

[Tue Oct 24 18:30:57 2023]
rule krona_import_text:
    input: /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/S1_4krona.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/S6_4krona.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/S28_4krona.txt
    output: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/PWYplots_ko2gg.html
    jobid: 50

ktImportText /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/pathways/S1_4krona.txt /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/pathways/S6_4krona.txt /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/pathways/S28_4krona.txt -o /nephele_data/outputs/PWYprofiles/keggPWYs.MP/PWYplots_ko2gg.html
S1
S28
S6
Writing /nephele_data/outputs/PWYprofiles/keggPWYs.MP/PWYplots_ko2gg.html...
[Tue Oct 24 18:30:57 2023]
Finished job 50.
134 of 139 steps (96%) done
Removing temporary output file /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_4biom.txt.
[Tue Oct 24 18:30:58 2023]
Finished job 73.
135 of 139 steps (97%) done
Warning message:
In dir.create(output$dir) :
  '/nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables' already exists
Removing temporary output file /nephele_data/outputs/PWYprofiles/keggPWYs.MP/SccList.txt.
[Tue Oct 24 18:31:00 2023]
Finished job 133.
136 of 139 steps (98%) done

[Tue Oct 24 18:31:00 2023]
rule PWY_collation_biom:
    input: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts+allTiers.txt, /nephele_data/inputs/wgsa_example_mapping_corrected.txt
    output: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts+allTiers_json.biom, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/tmp_.txt
    jobid: 132

sed '1s/allTiers/Taxonomy/' /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts+allTiers.txt > /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/tmp_.txt && biom convert -i /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/tmp_.txt -m <(sed '1s/^/#/' /nephele_data/inputs/wgsa_example_mapping_corrected.txt) -o /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts+allTiers_json.biom --to-json --table-type='Pathway table' --process-obs-metadata taxonomy

[Tue Oct 24 18:31:00 2023]
rule PWY_diversity_plots:
    input: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts+PWY.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_PWY.txt, /nephele_data/inputs/wgsa_example_mapping_corrected.txt
    output: /nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/tmp_mapping_file.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/PWY_diversity_plots.done
    jobid: 137


            sed 's/^#//g' /nephele_data/inputs/wgsa_example_mapping_corrected.txt > /nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/tmp_mapping_file.txt
            Rscript /usr/local/src/nephele2/pipelines/wgsa/DiversityPlots_PWY_v3.R --wdir /nephele_data/tmp/ --indir /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/ --mfile /nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/tmp_mapping_file.txt --outdir /nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/ || echo "ERROR: Failed to generate PWY_diversity_plots"
            touch /nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/PWY_diversity_plots.done
            
Removing temporary output file /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/tmp_.txt.
[Tue Oct 24 18:31:00 2023]
Finished job 132.
137 of 139 steps (99%) done
Loading required package: data.table
Loading required package: fossil
Loading required package: sp
Loading required package: maps
Loading required package: shapefiles
Loading required package: foreign

Attaching package: ‘shapefiles’

The following objects are masked from ‘package:foreign’:

    read.dbf, write.dbf

Loading required package: ggplot2
Loading required package: vegan
Loading required package: permute
Loading required package: lattice
This is vegan 2.5-7
Loading required package: ampvis2
Loading required package: tidyverse
── Attaching packages ─────────────────────────────────────── tidyverse 1.3.1 ──
✔ tibble  3.1.6     ✔ dplyr   1.0.7
✔ tidyr   1.1.4     ✔ stringr 1.4.0
✔ readr   2.1.1     ✔ forcats 0.5.1
✔ purrr   0.3.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::between()   masks data.table::between()
✖ dplyr::filter()    masks stats::filter()
✖ dplyr::first()     masks data.table::first()
✖ dplyr::lag()       masks stats::lag()
✖ dplyr::last()      masks data.table::last()
✖ purrr::map()       masks maps::map()
✖ purrr::transpose() masks data.table::transpose()
Loading required package: S4Vectors
Loading required package: stats4
Loading required package: BiocGenerics

Attaching package: ‘BiocGenerics’

The following objects are masked from ‘package:dplyr’:

    combine, intersect, setdiff, union

The following objects are masked from ‘package:stats’:

    IQR, mad, sd, var, xtabs

The following objects are masked from ‘package:base’:

    anyDuplicated, append, as.data.frame, basename, cbind, colnames,
    dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
    grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,
    order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
    rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,
    union, unique, unsplit, which.max, which.min


Attaching package: ‘S4Vectors’

The following objects are masked from ‘package:dplyr’:

    first, rename

The following object is masked from ‘package:tidyr’:

    expand

The following objects are masked from ‘package:data.table’:

    first, second

The following objects are masked from ‘package:base’:

    expand.grid, I, unname

All packages loaded successfully
[1] "------> start of PWY Diversity Plots <------"
[1] "------> docopt settings ------"
[1] "Usage: DiversityPlots_v3.R [options]\n  --help            show this screen.\n  --wdir PATH       give path to working dir /project main dir  [default: pwd ].\n  --indir PATH      give path to input files directory [default: profiles/merged_tables ].\n  --mfile NAME      give name of mapping file [default: mapping.txt ].\n  --outdir NAME     give path & name of output directory to create [default: pwd/profiles/DiversityPlots]."
List of 10
 $ --help  : logi FALSE
 $ --wdir  : chr "/nephele_data/tmp/"
 $ --indir : chr "/nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/"
 $ --mfile : chr "/nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/tmp_mapping_file.txt"
 $ --outdir: chr "/nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/"
 $ help    : logi FALSE
 $ wdir    : chr "/nephele_data/tmp/"
 $ indir   : chr "/nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/"
 $ mfile   : chr "/nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/tmp_mapping_file.txt"
 $ outdir  : chr "/nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/"
NULL
[1] "-----------> docopt settings------^^^^"
Warning message:
In dir.create(path$outdir) :
  '/nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots' already exists
[1] "-----------> reading in mapping file:"
Warning message:
In tables$meta <- read.table(paste0(args$mfile), header = T, sep = "\t",  :
  Coercing LHS to a list
    SampleID                       ForwardFastqFile
S1        S1 S1_GItract_camiHiSeq_sub1M_R1.fastq.gz
S28      S28   S28_Skin_camiHiSeq_sub1M_R1.fastq.gz
S6        S6    S6_Oral_camiHiSeq_sub1M_R1.fastq.gz
                          ReverseFastqFile TreatmentGroup
S1  S1_GItract_camiHiSeq_sub1M_R2.fastq.gz          Stool
S28   S28_Skin_camiHiSeq_sub1M_R2.fastq.gz           Skin
S6     S6_Oral_camiHiSeq_sub1M_R2.fastq.gz           Skin
[1] "-----------> done importing mapping file^^^"
[1] "-----------> prepping AMPVIS2 object"
                 Phylum                 Order                  Species       S1
PWY1 Cellular Processes Cell growth and death                Apoptosis 32.73810
PWY2 Cellular Processes Cell growth and death          Apoptosis - fly 37.26923
PWY3 Cellular Processes Cell growth and death Cell cycle - Caulobacter 24.93737
PWY4 Cellular Processes Cell growth and death          Meiosis - yeast 29.48333
PWY5 Cellular Processes         Cell motility     Bacterial chemotaxis 23.11006
PWY6 Cellular Processes         Cell motility       Flagellar assembly 29.94087
          S28        S6
PWY1 89.37500  8.866667
PWY2 28.58654 12.490476
PWY3 29.92903 30.398184
PWY4 32.60000  0.000000
PWY5 20.49675 23.345358
PWY6 21.72049 30.417200
Warning message:
Could not find a column named OTU/ASV in otutable, using rownames as OTU ID's 
[1] "-----------> making PCOA plot"
0 OTU's have been filtered.
null device 
          1 
[1] "-----------> making nMDS plot"
0 OTU's have been filtered.
null device 
          1 
Warning messages:
1: In vegan::metaMDS(data$abund, distance = distmeasure, trace = FALSE,  :
  stress is (nearly) zero: you may have insufficient data
2: In postMDS(out$points, dis, plot = max(0, plot - 1), ...) :
  skipping half-change scaling: too few points below threshold
[1] "-----------> making heatmap profile graph"
null device 
          1 
Warning message:
The data has already been normalised. Setting normalise = TRUE (the default) will normalise the data again and the relative abundance information about the original data of which the provided data is a subset will be lost. 
Removing temporary output file /nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/tmp_mapping_file.txt.
[Tue Oct 24 18:31:05 2023]
Finished job 137.
138 of 139 steps (99%) done

[Tue Oct 24 18:31:05 2023]
localrule all:
    input: /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/TAXplots_readsTAX_RefDB.html, /nephele_data/outputs/asmbMetaSpades/S1_asmb/add_de_replication_stats.done, /nephele_data/outputs/asmbMetaSpades/S6_asmb/add_de_replication_stats.done, /nephele_data/outputs/asmbMetaSpades/S28_asmb/add_de_replication_stats.done, /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_depths.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_depths.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_depths.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/final.assembly_scaffCoverage.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/final.assembly_scaffCoverage.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/final.assembly_scaffCoverage.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/PREDgenes_stats.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/PREDgenes_stats.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/PREDgenes_stats.txt, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/PWYplots_ko2gg.html, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S1_json.biom, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S6_json.biom, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/bioms/S28_json.biom, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S1_json.biom, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S6_json.biom, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/bioms/S28_json.biom, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.faa, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.faa, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.faa, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ko.fna, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ko.fna, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ko.fna, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.faa, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.faa, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.faa, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/annots.ec.fna, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/annots.ec.fna, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/annots.ec.fna, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/S1_geneTPMtab.ec.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/S6_geneTPMtab.ec.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/S28_geneTPMtab.ec.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/annotations/S1_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/annotations/S6_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/annotations/S28_geneTPMtab.ko.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/AMRs/AMRs.faa, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/AMRs/AMRs.faa, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/AMRs/AMRs.faa, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/AMRs/AMRs_info.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/AMRs/AMRs_info.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/AMRs/AMRs_info.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/genes/genesTAX_RefDB/geneTAX_ABUNtab+tax.txt, /nephele_data/outputs/TAXprofiles/geneTAX_RefDB/TAXplots_genesTAX_RefDB.html, /nephele_data/outputs/asmbMetaSpades/S1_asmb/scaffTAX_RefDB/scaffTAX_scaffCovr+tax.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/scaffTAX_RefDB/scaffTAX_scaffCovr+tax.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/scaffTAX_RefDB/scaffTAX_scaffCovr+tax.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/mag_SUMMARY.txt, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/mag_SUMMARY.txt, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/mag_SUMMARY.txt, /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/checkm_plots.done, /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/checkm_plots.done, /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/checkm_plots.done, /nephele_data/outputs/TAXprofiles/MAGs_TAX/TAXplots_MAGx.html, /nephele_data/outputs/TAXprofiles/MAGs_TAX/MAG-based_Counts+TAX.biom, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/merged_tables/merged_Counts+allTiers_json.biom, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+Lineage_json.biom, /nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/PWY_diversity_plots.done, /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/TAX_diversity_plots.done
    jobid: 0

[Tue Oct 24 18:31:05 2023]
Finished job 0.
139 of 139 steps (100%) done
Complete log: /nephele_data/tmp/.snakemake/log/2023-10-24T171819.971089.snakemake.log

    set +o pipefail
    echo "Cleaning output..."
    rm -rf /nephele_data/outputs/asmbMetaSpades/S1_asmb/*.bt2 /nephele_data/outputs/asmbMetaSpades/S6_asmb/*.bt2 /nephele_data/outputs/asmbMetaSpades/S28_asmb/*.bt2 /nephele_data/outputs/asmbMetaSpades/S1_asmb/*.done /nephele_data/outputs/asmbMetaSpades/S6_asmb/*.done /nephele_data/outputs/asmbMetaSpades/S28_asmb/*.done /nephele_data/outputs/asmbMetaSpades/S1_asmb/MAGs/magsQA/QCplots/*.done /nephele_data/outputs/asmbMetaSpades/S6_asmb/MAGs/magsQA/QCplots/*.done /nephele_data/outputs/asmbMetaSpades/S28_asmb/MAGs/magsQA/QCplots/*.done /nephele_data/outputs/PWYprofiles/keggPWYs.MP/DivPlots/*.done /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/DivPlots/*.done /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/klogs/
    
        rm -rf /nephele_data/outputs/TED_out/
        cp /nephele_data/outputs/TAXprofiles/readsTAX_RefDB/merged_tables/merged_Counts+Lineage_json.biom /nephele_data/outputs/for_analyze_with_microbiomedb.biom
Cleaning output...
[2023-10-24 18:31:05,606 - INFO] Result 'tax_pcoa_plot' reported
[2023-10-24 18:31:05,649 - INFO] Result 'mags_krona_report' reported
[2023-10-24 18:31:05,680 - INFO] Result 'pwy_table_txt' reported
[2023-10-24 18:31:05,739 - INFO] Result 'tax_table_txt' reported
[2023-10-24 18:31:05,769 - INFO] Result 'pwy_pcoa_plot' reported
[2023-10-24 18:31:05,813 - INFO] Result 'pwy_krona_report' reported
[2023-10-24 18:31:05,870 - INFO] Result 'gene_krona_report' reported
[2023-10-24 18:31:05,918 - INFO] Result 'tax_krona_report' reported
[2023-10-24 18:31:05,963 - INFO] Result 'pwy_merged_gene_table' reported
[2023-10-24 18:31:05,965 - INFO] Results tarball does not exist: /mnt/EFS/user_uploads/f924ba509da1_reported_results.tar.gz. Creating.
[2023-10-24 18:31:06,244 - INFO] Created results tarball: /mnt/EFS/user_uploads/f924ba509da1_reported_results.tar.gz
[2023-10-24 18:31:06,404 - INFO] Uploaded to S3: /mnt/EFS/user_uploads/f924ba509da1_reported_results.tar.gz
[2023-10-24 18:31:06,476 - INFO] Uploaded to S3: /mnt/EFS/user_uploads/f924ba509da1/outputs/f924ba509da1_results_registry.json
[2023-10-24 18:31:06,478 - INFO] WGSA pipeline completed.
[2023-10-24 18:31:06,478 - INFO] 0
